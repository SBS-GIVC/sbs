{"version":3,"mappings":"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","names":["CODE_SYSTEMS","SYSTEM_CATEGORIES","UnifiedTerminologyService","__vite_import_meta_env__","systemId","query","options","systems","category","limit","language","includeInactive","targetSystems","results","searchPromises","system","codes","code","err","allResults","systemResults","a","b","id","cacheKey","params","response","item","error","aiAssistant","token","entity","tokenCacheKey","cached","data","localMapped","concept","searchResponse","searchData","sourceSystem","mappings","localMappings","icdMappings","snomedCode","m","parameters","p","display","bundle","entries","entry","matches","match","parts","equivalence","mockData","q","d","unifiedTerminology","UnifiedCodeBrowser","lang","isRTL","t","i18n","searchQuery","setSearchQuery","useState","selectedSystems","setSelectedSystems","selectedCategory","setSelectedCategory","setResults","isSearching","setIsSearching","selectedCode","setSelectedCode","setMappings","loadingMappings","setLoadingMappings","toast","useToast","allSystems","useMemo","useEffect","timer","res","toggleSystem","prev","s","handleCodeSelect","getRegistryLink","encoded","jsxs","jsx","SectionHeader","e","SystemPill","c","i","UnifiedResultCard","InfoByte","Card","CardHeader","CardBody","Button","payload","url","selected","onClick","label","value","color"],"ignoreList":[],"sources":["../../src/services/unifiedTerminologyService.js","../../src/pages/UnifiedCodeBrowser.jsx"],"sourcesContent":["/**\n * Unified Terminology Service\n * Integrates multiple healthcare coding systems into a single interface\n * Supports: SBS, ICD-10-AM, ICD-11, SNOMED CT, LOINC, DRG, RxNorm\n */\n\n// Code system definitions with FHIR canonical URLs\nexport const CODE_SYSTEMS = {\n  SBS: {\n    id: 'sbs',\n    name: 'Saudi Billing System',\n    uri: 'http://chi.gov.sa/sbs',\n    version: '3.1',\n    publisher: 'Council of Health Insurance (CHI)',\n    count: 10466,\n    color: '#137fec',\n    icon: 'receipt_long',\n    loaded: true\n  },\n  ICD10AM: {\n    id: 'icd10am',\n    name: 'ICD-10-AM',\n    uri: 'http://hl7.org/fhir/sid/icd-10-am',\n    version: '12th Edition',\n    publisher: 'IHPA / WHO',\n    count: 17000,\n    color: '#ef4444',\n    icon: 'diagnosis',\n    loaded: false\n  },\n  ICD11: {\n    id: 'icd11',\n    name: 'ICD-11',\n    uri: 'http://id.who.int/icd/release/11',\n    version: '2025',\n    publisher: 'WHO',\n    count: 17000,\n    color: '#f97316',\n    icon: 'medical_information',\n    loaded: false\n  },\n  SNOMED: {\n    id: 'snomed',\n    name: 'SNOMED CT',\n    uri: 'http://snomed.info/sct',\n    version: 'July 2025',\n    publisher: 'SNOMED International',\n    count: 360000,\n    color: '#8b5cf6',\n    icon: 'psychology',\n    loaded: false\n  },\n  DRG: {\n    id: 'drg',\n    name: 'Diagnosis Related Groups',\n    uri: 'http://chi.gov.sa/drg',\n    version: 'AR-DRG 11.0',\n    publisher: 'IHPA / CHI',\n    count: 800,\n    color: '#22c55e',\n    icon: 'category',\n    loaded: false\n  },\n  LOINC: {\n    id: 'loinc',\n    name: 'LOINC',\n    uri: 'http://loinc.org',\n    version: '2.81',\n    publisher: 'Regenstrief Institute',\n    count: 100000,\n    color: '#06b6d4',\n    icon: 'science',\n    loaded: false\n  },\n  RXNORM: {\n    id: 'rxnorm',\n    name: 'RxNorm',\n    uri: 'http://www.nlm.nih.gov/research/umls/rxnorm',\n    version: 'Weekly',\n    publisher: 'US NLM',\n    count: 120000,\n    color: '#ec4899',\n    icon: 'medication',\n    loaded: false\n  },\n  ACHI: {\n    id: 'achi',\n    name: 'ACHI',\n    uri: 'http://hl7.org/fhir/sid/achi',\n    version: '12th Edition',\n    publisher: 'IHPA',\n    count: 6000,\n    color: '#14b8a6',\n    icon: 'surgical',\n    loaded: false\n  },\n  DENTAL: {\n    id: 'dental',\n    name: 'Dental Pricelist',\n    uri: 'http://chi.gov.sa/sbs/dental',\n    version: 'Gov Sector',\n    publisher: 'CHI',\n    count: 713,\n    color: '#0ea5a4',\n    icon: 'dentistry',\n    loaded: true\n  }\n};\n\n// Code system category mappings\nexport const SYSTEM_CATEGORIES = {\n  diagnosis: ['icd10am', 'icd11', 'snomed'],\n  procedure: ['sbs', 'achi', 'snomed', 'dental'],\n  laboratory: ['loinc'],\n  medication: ['rxnorm'],\n  billing: ['sbs', 'drg', 'dental'],\n  clinical: ['snomed', 'icd10am', 'icd11']\n};\n\n/**\n * Unified Terminology Service Class\n */\nclass UnifiedTerminologyService {\n  constructor() {\n    this.systems = CODE_SYSTEMS;\n    this.cache = new Map();\n    this.mappings = new Map();\n    this.landingApiBase = (typeof window !== 'undefined' && window.SBS_API_URL) ? window.SBS_API_URL : '';\n    \n    // WHO ICD-11 API configuration\n    this.icd11Config = {\n      baseUrl: 'https://id.who.int/icd',\n      apiUrl: 'https://id.who.int/icd/release/11/2025/mms',\n      tokenUrl: 'https://icdaccessmanagement.who.int/connect/token',\n      clientId: import.meta.env?.VITE_ICD11_CLIENT_ID || '',\n      clientSecret: import.meta.env?.VITE_ICD11_CLIENT_SECRET || ''\n    };\n    \n    // SNOMED Snowstorm API\n    this.snomedConfig = {\n      baseUrl: 'https://snowstorm.ihtsdotools.org/snowstorm/snomed-ct',\n      fhirUrl: 'https://snowstorm.ihtsdotools.org/fhir'\n    };\n    \n    // LOINC API\n    this.loincConfig = {\n      baseUrl: 'https://fhir.loinc.org',\n      searchUrl: 'https://loinc.org/api'\n    };\n  }\n\n  /**\n   * Get all available code systems\n   */\n  getSystems() {\n    return Object.values(this.systems);\n  }\n\n  /**\n   * Get system by ID\n   */\n  getSystem(systemId) {\n    return Object.values(this.systems).find(s => s.id === systemId);\n  }\n\n  /**\n   * Unified search across all or selected systems\n   */\n  async search(query, options = {}) {\n    const {\n      systems = null,\n      category = null,\n      limit = 20,\n      language = 'en',\n      includeInactive = false\n    } = options;\n\n    // Determine which systems to search\n    let targetSystems = Object.keys(this.systems);\n    \n    if (systems && systems.length > 0) {\n      targetSystems = systems;\n    } else if (category) {\n      targetSystems = SYSTEM_CATEGORIES[category] || targetSystems;\n    }\n\n    const results = [];\n    const searchPromises = [];\n\n    for (const systemId of targetSystems) {\n      const system = this.getSystem(systemId);\n      if (!system) continue;\n\n      // Search each system\n      searchPromises.push(\n        this.searchSystem(systemId, query, { limit, language })\n          .then(codes => codes.map(code => ({\n            ...code,\n            system: system.id,\n            systemName: system.name,\n            systemUri: system.uri,\n            systemColor: system.color\n          })))\n          .catch(err => {\n            console.warn(`Search failed for ${systemId}:`, err);\n            return [];\n          })\n      );\n    }\n\n    const allResults = await Promise.all(searchPromises);\n    \n    // Merge and sort by relevance\n    for (const systemResults of allResults) {\n      results.push(...systemResults);\n    }\n\n    // Sort by score (higher is better)\n    results.sort((a, b) => (b.score || 0) - (a.score || 0));\n\n    return {\n      total: results.length,\n      results: results.slice(0, limit),\n      systems: targetSystems.map(id => this.getSystem(id)).filter(Boolean)\n    };\n  }\n\n  /**\n   * Search a specific code system\n   */\n  async searchSystem(systemId, query, options = {}) {\n    const { limit = 20, language = 'en' } = options;\n\n    switch (systemId) {\n      case 'sbs':\n        return this.searchSBS(query, limit);\n      case 'achi':\n        return this.searchACHI(query, limit);\n      case 'dental':\n        return this.searchDental(query, limit);\n      case 'icd11':\n        return this.searchICD11(query, limit, language);\n      case 'snomed':\n        return this.searchSNOMED(query, limit);\n      case 'loinc':\n        return this.searchLOINC(query, limit);\n      case 'icd10am':\n        return this.searchICD10AM(query, limit);\n      case 'drg':\n        return this.searchDRG(query, limit);\n      default:\n        return [];\n    }\n  }\n\n  async searchLandingTerminology(systemId, query, limit) {\n    const cacheKey = `landing:${systemId}:${query}:${limit}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    const params = new URLSearchParams({\n      system: systemId,\n      q: query,\n      limit: String(limit),\n      offset: '0'\n    });\n    const response = await fetch(`${this.landingApiBase}/api/terminology/search?${params.toString()}`);\n    if (!response.ok) {\n      throw new Error(`Landing terminology error: ${response.status}`);\n    }\n\n    const data = await response.json();\n    const results = (data.results || []).map(item => ({\n      code: item.code,\n      display: item.display || item.desc || '',\n      category: item.category || item.chapter || null,\n      score: item.score || 0.9,\n      sbsCode: item.sbsCode || null,\n      specialty: item.specialty || null,\n      priceSar: item.priceSar\n    }));\n    this.cache.set(cacheKey, results);\n    return results;\n  }\n\n  /**\n   * Search SBS codes (local)\n   */\n  async searchSBS(query, limit) {\n    try {\n      return await this.searchLandingTerminology('sbs', query, limit);\n    } catch (error) {\n      console.warn('Landing SBS search unavailable, using local index:', error?.message || error);\n    }\n\n    // Use the existing AI assistant service\n    const { aiAssistant } = await import('./aiAssistantService');\n    const fallback = await aiAssistant.smartSearch(query, { limit, includeAI: false });\n    return (fallback.results || []).map(code => ({\n      code: code.code,\n      display: code.desc,\n      displayAr: code.descAr,\n      category: code.category,\n      score: code.score\n    }));\n  }\n\n  async searchACHI(query, limit) {\n    try {\n      return await this.searchLandingTerminology('achi', query, limit);\n    } catch (error) {\n      console.warn('Landing ACHI search unavailable:', error?.message || error);\n      return [];\n    }\n  }\n\n  async searchDental(query, limit) {\n    try {\n      return await this.searchLandingTerminology('dental', query, limit);\n    } catch (error) {\n      console.warn('Landing dental search unavailable:', error?.message || error);\n      return [];\n    }\n  }\n\n  /**\n   * Search WHO ICD-11 API\n   */\n  async searchICD11(query, limit, language = 'en') {\n    const cacheKey = `icd11:${query}:${language}:${limit}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    try {\n      // Get access token\n      const token = await this.getICD11Token();\n      \n      const response = await fetch(\n        `${this.icd11Config.apiUrl}/search?q=${encodeURIComponent(query)}&subtreeFilterUsesFoundationDescendants=false&includeKeywordResult=true&useFlexisearch=true&flatResults=true&highlightingEnabled=false&medicalCodingMode=true`,\n        {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n            'Accept': 'application/json',\n            'Accept-Language': language,\n            'API-Version': 'v2'\n          }\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`ICD-11 API error: ${response.status}`);\n      }\n\n      const data = await response.json();\n      const results = (data.destinationEntities || []).slice(0, limit).map(entity => ({\n        code: entity.theCode,\n        display: entity.title,\n        definition: entity.definition,\n        chapter: entity.chapter,\n        score: entity.score || 0.8\n      }));\n\n      this.cache.set(cacheKey, results);\n      return results;\n    } catch (error) {\n      console.error('ICD-11 search error:', error);\n      return this.mockICD11Search(query, limit);\n    }\n  }\n\n  /**\n   * Get ICD-11 OAuth token\n   */\n  async getICD11Token() {\n    const tokenCacheKey = 'icd11_token';\n    const cached = this.cache.get(tokenCacheKey);\n    \n    if (cached && cached.expiresAt > Date.now()) {\n      return cached.token;\n    }\n\n    const response = await fetch(this.icd11Config.tokenUrl, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n      body: new URLSearchParams({\n        grant_type: 'client_credentials',\n        client_id: this.icd11Config.clientId,\n        client_secret: this.icd11Config.clientSecret,\n        scope: 'icdapi_access'\n      })\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to get ICD-11 token');\n    }\n\n    const data = await response.json();\n    \n    this.cache.set(tokenCacheKey, {\n      token: data.access_token,\n      expiresAt: Date.now() + (data.expires_in * 1000) - 60000\n    });\n\n    return data.access_token;\n  }\n\n  /**\n   * Search SNOMED CT via Snowstorm\n   */\n  async searchSNOMED(query, limit) {\n    try {\n      const localMapped = await this.searchLandingTerminology('snomed', query, limit);\n      if (localMapped.length > 0) {\n        return localMapped;\n      }\n    } catch (error) {\n      console.warn('Landing SNOMED search unavailable, falling back to Snowstorm:', error?.message || error);\n    }\n\n    const cacheKey = `snomed:${query}:${limit}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    try {\n      const response = await fetch(\n        `${this.snomedConfig.baseUrl}/MAIN/concepts?term=${encodeURIComponent(query)}&limit=${limit}&activeFilter=true`,\n        {\n          headers: { 'Accept': 'application/json' }\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`SNOMED API error: ${response.status}`);\n      }\n\n      const data = await response.json();\n      const results = (data.items || []).map(concept => ({\n        code: concept.conceptId,\n        display: concept.fsn?.term || concept.pt?.term,\n        displayShort: concept.pt?.term,\n        moduleId: concept.moduleId,\n        active: concept.active,\n        score: 0.9\n      }));\n\n      this.cache.set(cacheKey, results);\n      return results;\n    } catch (error) {\n      console.error('SNOMED search error:', error);\n      return this.mockSNOMEDSearch(query, limit);\n    }\n  }\n\n  /**\n   * Search LOINC via FHIR API\n   */\n  async searchLOINC(query, limit) {\n    const cacheKey = `loinc:${query}:${limit}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    try {\n      const response = await fetch(\n        `${this.loincConfig.baseUrl}/CodeSystem/$lookup?system=http://loinc.org&code=${encodeURIComponent(query)}`,\n        {\n          headers: { 'Accept': 'application/fhir+json' }\n        }\n      );\n\n      if (!response.ok) {\n        // Fall back to search\n        const searchResponse = await fetch(\n          `${this.loincConfig.baseUrl}/CodeSystem?_content=${encodeURIComponent(query)}&_count=${limit}`,\n          { headers: { 'Accept': 'application/fhir+json' } }\n        );\n        \n        if (!searchResponse.ok) {\n          throw new Error('LOINC search failed');\n        }\n        \n        const searchData = await searchResponse.json();\n        return this.parseFHIRBundle(searchData, 'loinc');\n      }\n\n      const data = await response.json();\n      const results = this.parseLOINCParameters(data);\n      \n      this.cache.set(cacheKey, results);\n      return results;\n    } catch (error) {\n      console.error('LOINC search error:', error);\n      return this.mockLOINCSearch(query, limit);\n    }\n  }\n\n  /**\n   * Search ICD-10-AM codes (local database)\n   */\n  async searchICD10AM(query, limit) {\n    // Will be expanded when ICD-10-AM is imported\n    return this.mockICD10Search(query, limit);\n  }\n\n  /**\n   * Search DRG codes (local database)\n   */\n  async searchDRG(query, limit) {\n    // Will be expanded when DRG is imported\n    return this.mockDRGSearch(query, limit);\n  }\n\n  /**\n   * Get cross-system mappings for a code\n   */\n  async getMappings(code, sourceSystem) {\n    const cacheKey = `mapping:${sourceSystem}:${code}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    const mappings = [];\n\n    // Check local mapping database\n    const localMappings = await this.getLocalMappings(code, sourceSystem);\n    mappings.push(...localMappings);\n\n    // Try external translation services\n    if (sourceSystem === 'snomed') {\n      const icdMappings = await this.translateSNOMEDtoICD(code);\n      mappings.push(...icdMappings);\n    }\n\n    this.cache.set(cacheKey, mappings);\n    return mappings;\n  }\n\n  /**\n   * Translate SNOMED to ICD-10\n   */\n  async translateSNOMEDtoICD(snomedCode) {\n    try {\n      const response = await fetch(\n        `${this.snomedConfig.fhirUrl}/ConceptMap/$translate?code=${snomedCode}&system=http://snomed.info/sct&target=http://hl7.org/fhir/sid/icd-10`,\n        { headers: { 'Accept': 'application/fhir+json' } }\n      );\n\n      if (!response.ok) return [];\n\n      const data = await response.json();\n      return this.parseTranslationResult(data);\n    } catch (error) {\n      console.error('SNOMED to ICD translation error:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get local mappings from database\n   */\n  async getLocalMappings(code, sourceSystem) {\n    try {\n      const params = new URLSearchParams({\n        sourceSystem,\n        code\n      });\n      const response = await fetch(`${this.landingApiBase}/api/terminology/mappings?${params.toString()}`);\n      if (!response.ok) return [];\n      const data = await response.json();\n      return (data.mappings || []).map(m => ({\n        system: m.system,\n        code: m.code,\n        display: m.display,\n        equivalence: m.equivalence || 'related',\n        confidence: m.confidence || 0.8\n      }));\n    } catch (error) {\n      console.warn('Local mapping lookup failed:', error?.message || error);\n      return [];\n    }\n  }\n\n  /**\n   * Parse FHIR Parameters for LOINC\n   */\n  parseLOINCParameters(params) {\n    const results = [];\n    const parameters = params.parameter || [];\n    \n    const code = parameters.find(p => p.name === 'code')?.valueCode;\n    const display = parameters.find(p => p.name === 'display')?.valueString;\n    \n    if (code) {\n      results.push({\n        code,\n        display,\n        score: 1.0\n      });\n    }\n    \n    return results;\n  }\n\n  /**\n   * Parse FHIR Bundle\n   */\n  parseFHIRBundle(bundle, system) {\n    const results = [];\n    const entries = bundle.entry || [];\n    \n    for (const entry of entries) {\n      if (entry.resource) {\n        results.push({\n          code: entry.resource.code || entry.resource.id,\n          display: entry.resource.display || entry.resource.name,\n          score: entry.search?.score || 0.5\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  /**\n   * Parse translation result\n   */\n  parseTranslationResult(params) {\n    const mappings = [];\n    const result = params.parameter?.find(p => p.name === 'result')?.valueBoolean;\n    \n    if (!result) return mappings;\n\n    const matches = params.parameter?.filter(p => p.name === 'match') || [];\n    \n    for (const match of matches) {\n      const parts = match.part || [];\n      const equivalence = parts.find(p => p.name === 'equivalence')?.valueCoding?.code;\n      const concept = parts.find(p => p.name === 'concept')?.valueCoding;\n      \n      if (concept) {\n        mappings.push({\n          system: concept.system,\n          code: concept.code,\n          display: concept.display,\n          equivalence: equivalence || 'related',\n          confidence: equivalence === 'equivalent' ? 1.0 : 0.8\n        });\n      }\n    }\n    \n    return mappings;\n  }\n\n  // ============= MOCK DATA FOR DEVELOPMENT =============\n\n  mockICD11Search(query, limit) {\n    const mockData = [\n      { code: 'BA00', display: 'Essential hypertension', chapter: 'Cardiovascular' },\n      { code: 'BA01', display: 'Hypertensive heart disease', chapter: 'Cardiovascular' },\n      { code: '5A11', display: 'Type 2 diabetes mellitus', chapter: 'Endocrine' },\n      { code: '2A00', display: 'Acute appendicitis', chapter: 'Digestive' },\n      { code: 'CA40', display: 'Acute myocardial infarction', chapter: 'Cardiovascular' },\n      { code: 'KB23', display: 'Femoral neck fracture', chapter: 'Musculoskeletal' },\n      { code: 'DB90', display: 'Pneumonia', chapter: 'Respiratory' },\n      { code: 'FA01', display: 'Acute kidney failure', chapter: 'Genitourinary' }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.toLowerCase().includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.85 }));\n  }\n\n  mockSNOMEDSearch(query, limit) {\n    const mockData = [\n      { code: '38341003', display: 'Hypertensive disorder' },\n      { code: '73211009', display: 'Diabetes mellitus' },\n      { code: '74400008', display: 'Appendicitis' },\n      { code: '22298006', display: 'Myocardial infarction' },\n      { code: '71620000', display: 'Fracture of femoral neck' },\n      { code: '233604007', display: 'Pneumonia' },\n      { code: '14669001', display: 'Acute kidney failure' },\n      { code: '254837009', display: 'Malignant neoplasm of breast' }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.9 }));\n  }\n\n  mockLOINCSearch(query, limit) {\n    const mockData = [\n      { code: '2339-0', display: 'Glucose [Mass/volume] in Blood' },\n      { code: '2345-7', display: 'Glucose [Mass/volume] in Serum or Plasma' },\n      { code: '4548-4', display: 'Hemoglobin A1c/Hemoglobin.total in Blood' },\n      { code: '2093-3', display: 'Cholesterol [Mass/volume] in Serum or Plasma' },\n      { code: '2571-8', display: 'Triglyceride [Mass/volume] in Serum or Plasma' },\n      { code: '26453-1', display: 'Erythrocytes [#/volume] in Blood' },\n      { code: '26464-8', display: 'Leukocytes [#/volume] in Blood' },\n      { code: '38483-4', display: 'Creatinine [Mass/volume] in Blood' }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.85 }));\n  }\n\n  mockICD10Search(query, limit) {\n    const mockData = [\n      { code: 'I10', display: 'Essential (primary) hypertension' },\n      { code: 'E11.9', display: 'Type 2 diabetes mellitus without complications' },\n      { code: 'K35.80', display: 'Unspecified acute appendicitis' },\n      { code: 'I21.9', display: 'Acute myocardial infarction, unspecified' },\n      { code: 'S72.00', display: 'Fracture of unspecified part of neck of femur' },\n      { code: 'J18.9', display: 'Pneumonia, unspecified organism' },\n      { code: 'N17.9', display: 'Acute kidney failure, unspecified' },\n      { code: 'C50.9', display: 'Malignant neoplasm of breast, unspecified' }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.toLowerCase().includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.85 }));\n  }\n\n  mockDRGSearch(query, limit) {\n    const mockData = [\n      { code: 'DRG-194', display: 'Simple Pneumonia & Pleurisy w CC', weight: 0.9, avgLOS: 3.2 },\n      { code: 'DRG-195', display: 'Simple Pneumonia & Pleurisy w/o CC', weight: 0.6, avgLOS: 2.1 },\n      { code: 'DRG-470', display: 'Major Hip and Knee Joint Replacement', weight: 1.9, avgLOS: 2.5 },\n      { code: 'DRG-291', display: 'Heart Failure & Shock w MCC', weight: 1.5, avgLOS: 4.8 },\n      { code: 'DRG-292', display: 'Heart Failure & Shock w CC', weight: 1.0, avgLOS: 3.5 },\n      { code: 'DRG-340', display: 'Appendectomy w Complicated Principal Diag w MCC', weight: 2.8, avgLOS: 6.5 },\n      { code: 'DRG-341', display: 'Appendectomy w Complicated Principal Diag w CC', weight: 1.8, avgLOS: 4.2 },\n      { code: 'DRG-342', display: 'Appendectomy w Complicated Principal Diag w/o CC', weight: 1.2, avgLOS: 2.8 }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.toLowerCase().includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.85 }));\n  }\n}\n\n// Export singleton\nexport const unifiedTerminology = new UnifiedTerminologyService();\n\n// Export class for testing\nexport { UnifiedTerminologyService };\n","import { useState, useMemo, useEffect } from 'react';\nimport { unifiedTerminology, CODE_SYSTEMS } from '../services/unifiedTerminologyService';\nimport { useToast } from '../components/Toast';\nimport { Card, CardBody, CardHeader } from '../components/ui/Card';\nimport { SectionHeader } from '../components/ui/SectionHeader';\nimport { Button } from '../components/ui/Button';\nimport { i18n } from '../utils/i18n';\n\n/**\n * Premium Unified Code Browser\n * Multi-System Clinical Registry Explorer\n */\nexport function UnifiedCodeBrowser({ lang = 'en', isRTL = false }) {\n  const copy = i18n[lang] || i18n.en;\n  const t = copy.pages?.unifiedBrowser || i18n.en.pages.unifiedBrowser;\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedSystems, setSelectedSystems] = useState([]);\n  const [selectedCategory, setSelectedCategory] = useState('all');\n  const [results, setResults] = useState({ total: 0, results: [], systems: [] });\n  const [isSearching, setIsSearching] = useState(false);\n  const [selectedCode, setSelectedCode] = useState(null);\n  const [mappings, setMappings] = useState([]);\n  const [loadingMappings, setLoadingMappings] = useState(false);\n  const toast = useToast();\n\n  const allSystems = useMemo(() => Object.values(CODE_SYSTEMS), []);\n\n  useEffect(() => {\n    if (searchQuery.length < 2) {\n      setResults({ total: 0, results: [], systems: [] });\n      return;\n    }\n    const timer = setTimeout(async () => {\n      setIsSearching(true);\n      try {\n        const res = await unifiedTerminology.search(searchQuery, {\n          systems: selectedSystems.length > 0 ? selectedSystems : null,\n          category: selectedCategory !== 'all' ? selectedCategory : null,\n          limit: 50\n        });\n        setResults(res);\n      } finally {\n        setIsSearching(false);\n      }\n    }, 300);\n    return () => clearTimeout(timer);\n  }, [searchQuery, selectedSystems, selectedCategory]);\n\n  const toggleSystem = (id) => {\n    setSelectedSystems(prev => prev.includes(id) ? prev.filter(s => s !== id) : [...prev, id]);\n  };\n\n  const handleCodeSelect = async (code) => {\n    setSelectedCode(code);\n    setMappings([]);\n    setLoadingMappings(true);\n    try {\n      const m = await unifiedTerminology.getMappings(code.code, code.system);\n      setMappings(m);\n    } finally {\n      setLoadingMappings(false);\n    }\n  };\n\n  const copyCode = (code, system) => {\n    navigator.clipboard\n      .writeText(`${system}|${code}`)\n      .then(() => toast.success(t.toast.codeCopied.replace('{system}', system)))\n      .catch(() => toast.error(t.toast.clipboardDenied));\n  };\n\n  const getRegistryLink = (code) => {\n    const system = String(code?.system || '').toLowerCase();\n    const encoded = encodeURIComponent(code?.code || '');\n    if (system === 'sbs') return 'https://portal.nphies.sa';\n    if (system === 'icd11') return `https://icd.who.int/browse11/l-m/en?q=${encoded}`;\n    if (system === 'icd10am') return `https://www.who.int/standards/classifications/classification-of-diseases?q=${encoded}`;\n    if (system === 'snomed') return `https://browser.ihtsdotools.org/?perspective=full&conceptId1=${encoded}`;\n    if (system === 'loinc') return `https://loinc.org/search/?search=${encoded}`;\n    return `https://www.google.com/search?q=${encodeURIComponent(`${code?.systemName || 'healthcare code'} ${code?.code || ''}`)}`;\n  };\n\n  return (\n    <div className=\"flex-1 overflow-hidden bg-grid flex flex-col\">\n       <header className=\"flex-shrink-0 bg-gradient-to-r from-blue-50 via-white to-cyan-50 px-4 py-8 sm:px-8 sm:py-10 border-b border-slate-200/70 space-y-8 relative overflow-hidden\">\n          <div className=\"absolute top-0 right-0 p-12 opacity-5 pointer-events-none\">\n             <span className=\"material-symbols-outlined text-[200px] font-black\">hub</span>\n          </div>\n\n          <div className=\"relative z-10 flex flex-col md:flex-row md:items-end justify-between gap-8\">\n             <div className=\"space-y-4\">\n                <SectionHeader \n                  title={t.header.title}\n                  subtitle={t.header.subtitleTemplate.replace('{count}', allSystems.length.toLocaleString(lang === 'ar' ? 'ar-SA' : undefined))}\n                  badge={t.header.badge}\n                />\n             </div>\n             <div className=\"flex items-center gap-3\">\n                <div className=\"px-4 py-2 rounded-2xl bg-emerald-500/10 border border-emerald-500/20 text-emerald-600 text-[10px] font-black uppercase tracking-widest\">{t.header.tags.fhir}</div>\n                <div className=\"px-4 py-2 rounded-2xl bg-blue-600/10 border border-blue-600/20 text-blue-600 text-[10px] font-black uppercase tracking-widest\">{t.header.tags.ai}</div>\n             </div>\n          </div>\n\n          <div className=\"relative z-10 space-y-6\">\n             <div className=\"relative group\">\n                <span className={`absolute ${isRTL ? 'right-6' : 'left-6'} top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500`}>search</span>\n                <input\n                  type=\"text\" \n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  placeholder={t.search.placeholder}\n                  aria-label={t.search.label}\n                  data-testid=\"unifiedbrowser-search\"\n                  className={`w-full h-16 sm:h-20 bg-white border border-slate-200 rounded-[24px] sm:rounded-[32px] ${isRTL ? 'pr-14 sm:pr-16 pl-16 sm:pl-20 text-right' : 'pl-14 sm:pl-16 pr-16 sm:pr-20 text-left'} text-base sm:text-lg font-bold text-slate-900 placeholder:text-slate-500 focus:outline-none focus:border-blue-600/30 focus:ring-4 focus:ring-blue-600/10 transition-all shadow-sm`}\n                />\n                {isSearching && <div className={`absolute ${isRTL ? 'left-8' : 'right-8'} top-1/2 -translate-y-1/2 size-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin`}></div>}\n             </div>\n\n             <div className=\"flex flex-wrap gap-2\">\n                {allSystems.map(s => (\n                   <button \n                     key={s.id}\n                     onClick={() => toggleSystem(s.id)}\n                     data-testid={`unifiedbrowser-system-${s.id}`}\n                     className={`px-3 sm:px-5 py-2.5 rounded-2xl text-[10px] font-black uppercase tracking-widest border transition-all flex items-center gap-2 ${\n                       selectedSystems.includes(s.id) \n                         ? 'border-current shadow-lg shadow-current/20' \n                         : 'opacity-80 border-slate-200 text-slate-600 hover:border-slate-300'\n                     }`}\n                     style={{ color: selectedSystems.includes(s.id) ? s.color : undefined, backgroundColor: selectedSystems.includes(s.id) ? `${s.color}15` : 'white' }}\n                   >\n                      <span className=\"size-2 rounded-full\" style={{ backgroundColor: s.color }}></span>\n                      {s.name}\n                   </button>\n                ))}\n             </div>\n          </div>\n       </header>\n\n       <div className=\"flex-1 overflow-hidden flex\">\n          <div className=\"flex-1 overflow-y-auto px-8 sm:px-12 py-10 scrollbar-hide\">\n             <div className=\"max-w-[1200px] mx-auto space-y-6\">\n                {searchQuery.length < 2 ? (\n                   <section className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 animate-premium-in\">\n                      {allSystems.map(s => <SystemPill key={s.id} system={s} t={t} lang={lang} />)}\n                   </section>\n                ) : results.results.length > 0 ? (\n                   <div className=\"space-y-4 stagger-children\">\n                      {results.results.map((c, i) => (\n                         <UnifiedResultCard \n                           key={c.code + i} \n                           code={c} \n                           selected={selectedCode?.code === c.code}\n                           onClick={() => handleCodeSelect(c)}\n                           t={t}\n                         />\n                      ))}\n                   </div>\n                ) : (\n                   <div className=\"flex flex-col items-center justify-center py-40 opacity-40\">\n                      <span className=\"material-symbols-outlined text-[80px] font-black\">manage_search</span>\n                      <p className=\"text-sm font-black uppercase tracking-widest mt-6\">{t.empty}</p>\n                   </div>\n                )}\n             </div>\n          </div>\n\n          {selectedCode && (\n             <aside data-testid=\"unifiedbrowser-detail\" className=\"w-[480px] bg-white dark:bg-slate-950 border-l border-slate-100 dark:border-slate-800 overflow-y-auto animate-premium-in shadow-2xl relative\">\n                <div className=\"p-12 space-y-12\">\n                   <div className=\"flex justify-between items-start\">\n                      <div className=\"space-y-2\">\n                         <div className=\"inline-flex px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest bg-blue-600/10 text-blue-600 border border-blue-600/20\">{selectedCode.systemName}</div>\n                         <h2 className=\"text-4xl font-black tracking-tighter text-slate-900 dark:text-white\">{selectedCode.code}</h2>\n                      </div>\n                      <button\n                        type=\"button\"\n                        onClick={() => setSelectedCode(null)}\n                        aria-label={t.detail.close}\n                        className=\"p-3 rounded-2xl bg-slate-50 dark:bg-slate-900 text-slate-400\"\n                      >\n                         <span className=\"material-symbols-outlined\">close</span>\n                      </button>\n                   </div>\n\n                   <div className=\"space-y-6\">\n                      <div className=\"space-y-2\">\n                         <p className=\"text-[10px] font-black uppercase tracking-widest text-slate-400\">{t.detail.semantics}</p>\n                         <p className=\"text-base font-bold text-slate-800 dark:text-gray-100 leading-relaxed italic\">\"{selectedCode.display}\"</p>\n                      </div>\n                      <div className=\"grid grid-cols-2 gap-4\">\n                         <InfoByte label={t.detail.statusLabel} value={t.detail.statusActive} color=\"emerald\" />\n                         <InfoByte label={t.detail.authReqLabel} value={t.detail.authReqManual} color=\"amber\" />\n                      </div>\n                   </div>\n\n                   <Card>\n                      <CardHeader title={t.detail.bridgingTitle} subtitle={t.detail.bridgingSubtitle} icon=\"lan\" />\n                      <CardBody className=\"p-0\">\n                         {loadingMappings ? (\n                            <div className=\"p-10 text-center\"><div className=\"size-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto\"></div></div>\n                         ) : (\n                            <div className=\"divide-y divide-slate-100 dark:divide-slate-800\">\n                               {mappings.map((m, i) => (\n                                  <div key={i} className=\"p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-colors\">\n                                     <div className=\"space-y-1\">\n                                        <p className=\"text-[9px] font-black uppercase tracking-widest text-slate-400\">{m.system}</p>\n                                        <p className=\"text-sm font-black text-blue-600 font-mono tracking-tight\">{m.code}</p>\n                                     </div>\n                                     <span className=\"text-[10px] font-black px-2 py-0.5 rounded-lg bg-emerald-500/10 text-emerald-500 border border-emerald-500/20\">\n                                       {Math.round(m.confidence * 100)}% {t.detail.match}\n                                     </span>\n                                  </div>\n                               ))}\n                            </div>\n                         )}\n                      </CardBody>\n                   </Card>\n\n                   <div className=\"space-y-4 py-4\">\n                      <Button\n                        className=\"w-full py-6 shadow-2xl shadow-blue-600/20\"\n                        icon=\"add_reaction\"\n                        data-testid=\"unifiedbrowser-add-context\"\n                        onClick={() => {\n                          const payload = {\n                            source: 'unified-browser',\n                            system: selectedCode.system,\n                            systemName: selectedCode.systemName,\n                            code: selectedCode.code,\n                            description: selectedCode.display\n                          };\n                          try { window.sessionStorage.setItem('sbs_claim_context_code', JSON.stringify(payload)); } catch {}\n                          try { window.dispatchEvent(new CustomEvent('sbs:claim-context', { detail: payload })); } catch {}\n                          toast.success(t.toast.contextAdded);\n                          window.dispatchEvent(new CustomEvent('sbs:navigate', { detail: { view: 'claim-builder' } }));\n                        }}\n                      >\n                        {t.actions.addContext}\n                      </Button>\n                      <Button\n                        variant=\"secondary\"\n                        className=\"w-full py-6\"\n                        icon=\"share\"\n                        onClick={() => {\n                          const url = getRegistryLink(selectedCode);\n                          window.open(url, '_blank', 'noopener,noreferrer');\n                          toast.info(t.toast.openedReference);\n                        }}\n                      >\n                        {t.actions.deepLink}\n                      </Button>\n                   </div>\n                </div>\n             </aside>\n          )}\n       </div>\n    </div>\n  );\n}\n\nfunction SystemPill({ system, t, lang = 'en' }) {\n  return (\n    <Card className=\"hover:scale-[1.02] transition-transform\">\n       <CardBody className=\"p-8 space-y-4\">\n          <div className=\"size-12 rounded-2xl flex items-center justify-center text-2xl\" style={{ backgroundColor: `${system.color}15`, color: system.color }}>\n             <span className=\"material-symbols-outlined\">{system.icon}</span>\n          </div>\n          <div>\n             <h4 className=\"text-sm font-black text-slate-800 dark:text-white uppercase tracking-tight\">{system.name}</h4>\n             <p className=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest\">\n               {system.count.toLocaleString(lang === 'ar' ? 'ar-SA' : undefined)} {t.systems.codes}\n             </p>\n          </div>\n       </CardBody>\n    </Card>\n  );\n}\n\nfunction UnifiedResultCard({ code, selected, onClick, t }) {\n  return (\n    <button\n      type=\"button\"\n      onClick={onClick}\n      data-testid={`unifiedbrowser-result-${code.system}-${code.code}`}\n      className={`p-6 rounded-[28px] border-2 transition-all cursor-pointer flex items-center gap-6 ${\n        selected ? 'border-blue-600 bg-blue-600/5 shadow-2xl shadow-blue-600/10' : 'bg-white dark:bg-slate-950 border-slate-100 dark:border-slate-900 hover:border-slate-300 dark:hover:border-slate-700'\n      }`}\n      aria-label={t.result.ariaLabelTemplate.replace('{system}', code.systemName).replace('{code}', code.code)}\n    >\n       <div className=\"size-14 rounded-2xl flex items-center justify-center text-2xl shrink-0\" style={{ backgroundColor: `${code.systemColor}15`, color: code.systemColor }}>\n          <span className=\"material-symbols-outlined\">api</span>\n       </div>\n       <div className=\"flex-1 space-y-1\">\n          <div className=\"flex items-center gap-3\">\n             <span className=\"text-[10px] font-black uppercase tracking-widest px-2 py-0.5 rounded border border-current\" style={{ color: code.systemColor, backgroundColor: `${code.systemColor}10` }}>{code.systemName}</span>\n             <span className=\"text-lg font-black text-blue-600 font-mono tracking-tighter\">{code.code}</span>\n          </div>\n          <p className=\"text-sm font-bold text-slate-800 dark:text-gray-200 line-clamp-1 italic\">\"{code.display}\"</p>\n       </div>\n       <span className=\"material-symbols-outlined text-slate-300 group-hover:text-blue-600\">chevron_right</span>\n    </button>\n  );\n}\n\nfunction InfoByte({ label, value, color }) {\n  return (\n    <div className=\"p-5 rounded-2xl bg-slate-50 dark:bg-slate-900 border border-slate-100 dark:border-slate-800 space-y-1\">\n       <p className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">{label}</p>\n       <p className={`text-sm font-black ${color === 'emerald' ? 'text-emerald-500' : 'text-amber-500'}`}>{value}</p>\n    </div>\n  );\n}\n"],"file":"UnifiedCodeBrowser-DpFpMtNr.js"}