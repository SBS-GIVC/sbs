{"version":3,"mappings":";82CAWO,SAASA,GAAiB,CAC/B,KAAM,CAACC,EAAaC,CAAc,EAAIC,WAAS,EAAE,EAC3C,CAACC,EAAkBC,CAAmB,EAAIF,WAAS,KAAK,EACxD,CAACG,EAAcC,CAAe,EAAIJ,WAAS,IAAI,EAC/C,CAACK,EAAaC,CAAc,EAAIN,WAAS,EAAK,EAC9C,CAACO,EAAYC,CAAa,EAAIR,WAAS,IAAI,EAC3C,CAACS,EAAcC,CAAe,EAAIV,WAAS,GAAG,EAC9CW,EAAYC,SAAO,IAAI,EACvBC,EAAQC,EAAA,EAERC,EAAWC,UAAQ,IAAMC,EAAY,cAAe,EAAE,EACtDC,EAAaF,UAAQ,IAAM,CAAC,MAAO,GAAGC,EAAY,eAAe,EAAG,EAAE,EAEtE,CAACE,EAAeC,CAAgB,EAAIpB,WAAS,CAAE,QAASe,EAAU,OAAQ,QAAS,EAEzFM,YAAU,IAAM,CACd,MAAMC,EAAQ,WAAW,SAAY,CACnC,GAAIxB,EAAY,QAAU,EAAG,CAC3BQ,EAAe,EAAI,EACnB,GAAI,CACF,MAAMiB,EAAU,MAAMN,EAAY,YAAYnB,EAAa,CACzD,MAAO,IACP,SAAUG,IAAqB,MAAQ,KAAOA,EAC9C,UAAW,GACZ,EACDmB,EAAiBG,CAAO,EACxBf,EAAce,EAAQ,UAAU,CAClC,SACEjB,EAAe,EAAK,CACtB,CACF,KAAO,CACL,MAAMkB,EAAWvB,IAAqB,MAClCc,EACAA,EAAS,OAAOU,GAAKA,EAAE,WAAaxB,CAAgB,EACxDmB,EAAiB,CAAE,QAASI,EAAU,OAAQ,QAAS,EACvDhB,EAAc,IAAI,CACpB,CACF,EAAG,GAAG,EACN,MAAO,IAAM,aAAac,CAAK,CACjC,EAAG,CAACxB,EAAaG,EAAkBc,CAAQ,CAAC,EAE5CM,YAAU,IAAM,CACdX,EAAgB,GAAG,CACrB,EAAG,CAACZ,EAAaG,CAAgB,CAAC,EAElC,MAAMyB,EAAiBV,UAAQ,IAAMG,EAAc,QAAQ,MAAM,EAAGV,CAAY,EAAG,CAACU,EAAeV,CAAY,CAAC,EAE1GkB,EAAgBC,GAAM,CAC1B,KAAM,CAAE,UAAAC,EAAW,aAAAC,EAAc,aAAAC,CAAA,EAAiBH,EAAE,OAChDE,EAAeD,EAAYE,EAAe,KAAOtB,EAAeU,EAAc,QAAQ,QACxFT,EAAgBsB,GAAQA,EAAO,GAAG,CAEtC,EAEMC,EAAYC,GAAS,CACzB,UAAU,UACP,UAAUA,CAAI,EACd,KAAK,IAAMrB,EAAM,QAAQ,QAAQqB,CAAI,4BAA4B,CAAC,EAClE,MAAM,IAAMrB,EAAM,MAAM,oCAAoC,CAAC,CAClE,EAEA,OACEsB,OAAC,OAAI,UAAU,sCAEb,UAAAA,OAAC,OAAI,UAAU,+BACb,UAAAA,OAAC,UAAO,UAAU,mDACf,UAAAA,OAAC,OAAI,UAAU,+DACZ,UAAAC,MAACC,EAAA,CACC,MAAM,uBACN,SAAU,sBAAsBtB,EAAS,OAAO,gBAAgB,oCAChE,MAAM,oBAERoB,OAAC,OAAI,UAAU,yGACZ,UAAAC,MAAC,UAAO,UAAU,6GAA6G,uBAAW,EAC1IA,MAAC,UAAO,UAAU,uFAAuF,qBAAS,GACrH,GACH,EAEAD,OAAC,OAAI,UAAU,kCACZ,UAAAA,OAAC,OAAI,UAAU,wBACZ,UAAAC,MAAC,QAAK,UAAU,uIAAuI,kBAAM,EAC7JA,MAAC,SACE,KAAK,OACL,YAAY,sDACZ,UAAU,8OACV,MAAOtC,EACP,SAAW8B,GAAM7B,EAAe6B,EAAE,OAAO,KAAK,IAEhDvB,GAAe+B,MAAC,OAAI,UAAU,2HAA2H,GAC7J,EACAA,MAAC,UACC,UAAU,sKACV,MAAOnC,EACP,SAAW2B,GAAM1B,EAAoB0B,EAAE,OAAO,KAAK,EAEjD,SAAAV,EAAW,IAAIoB,GAAOF,MAAC,UAAiB,MAAOE,EAAM,SAAAA,EAAI,QAAQ,KAAM,GAAG,GAAvCA,CAAyC,CAAS,GACzF,EACH,EAEC/B,GACE4B,OAAC,OAAI,UAAU,qGACZ,UAAAC,MAAC,QAAK,UAAU,0CAA0C,wBAAY,EACtEA,MAAC,KAAE,UAAU,6DAA8D,SAAA7B,CAAA,CAAW,GACzF,GAEN,EAEA4B,OAAC,OACC,IAAKxB,EACL,SAAUgB,EACV,UAAU,4DAET,UAAAS,MAAC,OAAI,UAAU,uFACX,WAAe,IAAI,CAACX,EAAGc,IACtBH,MAACI,EAAA,CAEC,KAAMf,EACN,SAAUtB,GAAc,OAASsB,EAAE,KACnC,QAAS,IAAMrB,EAAgBqB,CAAC,EAChC,OAAQ,IAAMQ,EAASR,EAAE,IAAI,GAJxBA,EAAE,KAAOc,CAAA,CAMjB,EACJ,EACCpB,EAAc,QAAQ,SAAW,GAChCgB,OAAC,OAAI,UAAU,uEACZ,UAAAC,MAAC,QAAK,UAAU,mDAAmD,sBAAU,EAC7EA,MAAC,KAAE,UAAU,+CAA+C,qCAAyB,GACxF,IAEL,EACF,EAGCjC,SACE,SAAM,UAAU,0IACd,SAAAgC,OAAC,OAAI,UAAU,kBACZ,UAAAA,OAAC,OAAI,UAAU,mCACZ,UAAAA,OAAC,OAAI,UAAU,YACZ,UAAAC,MAAC,KAAE,UAAU,iEAAiE,2BAAe,EAC7FA,MAAC,MAAG,UAAU,sEAAuE,WAAa,KAAK,GAC1G,EACAA,MAAC,UAAO,QAAS,IAAMhC,EAAgB,IAAI,EAAG,UAAU,oGACrD,SAAAgC,MAAC,QAAK,UAAU,4BAA4B,iBAAK,EACpD,GACH,EAEAD,OAAC,OAAI,UAAU,YACZ,UAAAA,OAAC,OAAI,UAAU,YACZ,UAAAC,MAAC,SAAM,UAAU,kEAAkE,iCAAqB,EACxGA,MAAC,KAAE,UAAU,sEAAuE,WAAa,KAAK,GACzG,EACAD,OAAC,OAAI,UAAU,YACZ,UAAAC,MAAC,SAAM,UAAU,kEAAkE,iCAAqB,QACvG,OAAI,UAAU,0IACX,SAAAjC,EAAa,UAAY,mBAC7B,GACH,GACH,EAEAgC,OAAC,OAAI,UAAU,2GACZ,UAAAA,OAAC,MAAG,UAAU,0FACX,UAAAC,MAAC,QAAK,UAAU,kDAAkD,sBAAU,EAAO,0BAEtF,EACAD,OAAC,OAAI,UAAU,YACZ,UAAAA,OAAC,OAAI,UAAU,qEACZ,UAAAC,MAAC,QAAK,+BAAmB,EACzBA,MAAC,QAAK,UAAU,gBAAgB,iBAAK,GACxC,EACAA,MAAC,OAAI,UAAU,oEACZ,eAAC,OAAI,UAAU,6BAA6B,EAC/C,GACH,EACAD,OAAC,KAAE,UAAU,8DAA8D,+DACtBC,MAAC,QAAK,UAAU,2BAA2B,wBAAY,EAAO,yBACnH,GACH,EAEAD,OAAC,OAAI,UAAU,iBACZ,UAAAC,MAACK,EAAA,CACC,UAAU,mDACV,KAAK,UACL,QAAS,IAAM,CACb,MAAMC,EAAU,CACd,KAAMvC,EAAa,KACnB,YAAaA,EAAa,KAC1B,SAAUA,EAAa,UAAY,MAErC,OAAO,aAAa,QAAQ,yBAA0B,KAAK,UAAUuC,CAAO,CAAC,EAC7E7B,EAAM,QAAQ,wCAAwC,EACtD,OAAO,cAAc,IAAI,YAAY,eAAgB,CAAE,OAAQ,CAAE,KAAM,gBAAgB,CAAG,CAAC,CAC7F,EACD,iCAGDuB,MAACK,EAAA,CAAO,QAAQ,YAAY,UAAU,sBAAsB,KAAK,eAAe,QAAS,IAAMR,EAAS9B,EAAa,IAAI,EAAG,0BAAc,GAC7I,GACH,EACH,GAEJ,CAEJ,CAEA,SAASqC,EAAS,CAAE,KAAAN,EAAM,SAAAS,EAAU,QAAAC,EAAS,OAAAC,GAAU,CACrD,OACET,MAACU,EAAA,CACC,QAAAF,EACA,UAAW,mEAAmED,EAAW,gDAAkD,oBAAoB,GAE9J,SAAAR,OAACY,EAAA,CAAS,UAAU,gBACjB,UAAAZ,OAAC,OAAI,UAAU,oCACZ,UAAAC,MAAC,QAAK,UAAU,4DAA6D,SAAAF,EAAK,KAAK,EACvFE,MAAC,UAAO,QAAUR,GAAM,CAAEA,EAAE,kBAAmBiB,EAAA,CAAU,EAAG,UAAU,sIACnE,SAAAT,MAAC,QAAK,UAAU,oCAAoC,wBAAY,EACnE,GACH,EACAA,MAAC,KAAE,UAAU,4HACT,WAAK,KACT,EACAD,OAAC,OAAI,UAAU,yFACZ,UAAAC,MAAC,QAAK,UAAU,iEAAkE,SAAAF,EAAK,UAAU,QAAQ,KAAM,GAAG,GAAK,WAAW,EACjIA,EAAK,SAAW,YAAS,QAAK,UAAU,mDAAmD,wBAAY,GAC3G,GACH,GAGP,0HCvOac,EAAe,CAC1B,IAAK,CACH,GAAI,MACJ,KAAM,uBACN,IAAK,wBACL,QAAS,MACT,UAAW,oCACX,MAAO,MACP,MAAO,UACP,KAAM,eACN,OAAQ,IAEV,QAAS,CACP,GAAI,UACJ,KAAM,YACN,IAAK,oCACL,QAAS,eACT,UAAW,aACX,MAAO,KACP,MAAO,UACP,KAAM,YACN,OAAQ,IAEV,MAAO,CACL,GAAI,QACJ,KAAM,SACN,IAAK,mCACL,QAAS,OACT,UAAW,MACX,MAAO,KACP,MAAO,UACP,KAAM,sBACN,OAAQ,IAEV,OAAQ,CACN,GAAI,SACJ,KAAM,YACN,IAAK,yBACL,QAAS,YACT,UAAW,uBACX,MAAO,KACP,MAAO,UACP,KAAM,aACN,OAAQ,IAEV,IAAK,CACH,GAAI,MACJ,KAAM,2BACN,IAAK,wBACL,QAAS,cACT,UAAW,aACX,MAAO,IACP,MAAO,UACP,KAAM,WACN,OAAQ,IAEV,MAAO,CACL,GAAI,QACJ,KAAM,QACN,IAAK,mBACL,QAAS,OACT,UAAW,wBACX,MAAO,IACP,MAAO,UACP,KAAM,UACN,OAAQ,IAEV,OAAQ,CACN,GAAI,SACJ,KAAM,SACN,IAAK,8CACL,QAAS,SACT,UAAW,SACX,MAAO,KACP,MAAO,UACP,KAAM,aACN,OAAQ,IAEV,KAAM,CACJ,GAAI,OACJ,KAAM,OACN,IAAK,+BACL,QAAS,eACT,UAAW,OACX,MAAO,IACP,MAAO,UACP,KAAM,WACN,OAAQ,IAEV,OAAQ,CACN,GAAI,SACJ,KAAM,mBACN,IAAK,+BACL,QAAS,aACT,UAAW,MACX,MAAO,IACP,MAAO,UACP,KAAM,YACN,OAAQ,GAEZ,EAGaC,EAAoB,CAC/B,UAAW,CAAC,UAAW,QAAS,QAAQ,EACxC,UAAW,CAAC,MAAO,OAAQ,SAAU,QAAQ,EAC7C,WAAY,CAAC,OAAO,EACpB,WAAY,CAAC,QAAQ,EACrB,QAAS,CAAC,MAAO,MAAO,QAAQ,EAChC,SAAU,CAAC,SAAU,UAAW,OAAO,CACzC,EAKA,MAAMC,CAA0B,CAC9B,aAAc,CACZ,KAAK,QAAUF,EACf,KAAK,UAAY,IACjB,KAAK,aAAe,IACpB,KAAK,eAAkB,OAAO,OAAW,KAAe,OAAO,YAAe,OAAO,YAAc,GAGnG,KAAK,YAAc,CACjB,QAAS,yBACT,OAAQ,6CACR,SAAU,oDACV,SAAUG,GAAiB,sBAAwB,GACnD,aAAcA,GAAiB,0BAA4B,IAI7D,KAAK,aAAe,CAClB,QAAS,wDACT,QAAS,0CAIX,KAAK,YAAc,CACjB,QAAS,yBACT,UAAW,wBAEf,CAKA,YAAa,CACX,OAAO,OAAO,OAAO,KAAK,OAAO,CACnC,CAKA,UAAUC,EAAU,CAClB,OAAO,OAAO,OAAO,KAAK,OAAO,EAAE,KAAK,GAAK,EAAE,KAAOA,CAAQ,CAChE,CAKA,MAAM,OAAOC,EAAOC,EAAU,GAAI,CAChC,KAAM,CACJ,QAAAC,EAAU,KACV,SAAAC,EAAW,KACX,MAAAC,EAAQ,GACR,SAAAC,EAAW,KACX,gBAAAC,EAAkB,IAChBL,EAGJ,IAAIM,EAAgB,OAAO,KAAK,KAAK,OAAO,EAExCL,GAAWA,EAAQ,OAAS,EAC9BK,EAAgBL,EACPC,IACTI,EAAgBX,EAAkBO,CAAQ,GAAKI,GAGjD,MAAMrC,EAAU,GACVsC,EAAiB,GAEvB,UAAWT,KAAYQ,EAAe,CACpC,MAAME,EAAS,KAAK,UAAUV,CAAQ,EACjCU,GAGLD,EAAe,KACb,KAAK,aAAaT,EAAUC,EAAO,CAAE,MAAAI,EAAO,SAAAC,CAAA,CAAU,EACnD,KAAKK,GAASA,EAAM,IAAI7B,IAAS,CAChC,GAAGA,EACH,OAAQ4B,EAAO,GACf,WAAYA,EAAO,KACnB,UAAWA,EAAO,IAClB,YAAaA,EAAO,OACpB,CAAC,EACF,MAAME,IACL,QAAQ,KAAK,qBAAqBZ,CAAQ,IAAKY,CAAG,EAC3C,GACR,EAEP,CAEA,MAAMC,EAAa,MAAM,QAAQ,IAAIJ,CAAc,EAGnD,UAAWK,KAAiBD,EAC1B1C,EAAQ,KAAK,GAAG2C,CAAa,EAI/B,OAAA3C,EAAQ,KAAK,CAAC4C,EAAGC,KAAOA,EAAE,OAAS,IAAMD,EAAE,OAAS,EAAE,EAE/C,CACL,MAAO5C,EAAQ,OACf,QAASA,EAAQ,MAAM,EAAGkC,CAAK,EAC/B,QAASG,EAAc,IAAIS,GAAM,KAAK,UAAUA,CAAE,CAAC,EAAE,OAAO,OAAO,EAEvE,CAKA,MAAM,aAAajB,EAAUC,EAAOC,EAAU,GAAI,CAChD,KAAM,CAAE,MAAAG,EAAQ,GAAI,SAAAC,EAAW,MAASJ,EAExC,OAAQF,EAAA,CACN,IAAK,MACH,OAAO,KAAK,UAAUC,EAAOI,CAAK,EACpC,IAAK,OACH,OAAO,KAAK,WAAWJ,EAAOI,CAAK,EACrC,IAAK,SACH,OAAO,KAAK,aAAaJ,EAAOI,CAAK,EACvC,IAAK,QACH,OAAO,KAAK,YAAYJ,EAAOI,EAAOC,CAAQ,EAChD,IAAK,SACH,OAAO,KAAK,aAAaL,EAAOI,CAAK,EACvC,IAAK,QACH,OAAO,KAAK,YAAYJ,EAAOI,CAAK,EACtC,IAAK,UACH,OAAO,KAAK,cAAcJ,EAAOI,CAAK,EACxC,IAAK,MACH,OAAO,KAAK,UAAUJ,EAAOI,CAAK,EACpC,QACE,MAAO,EAAC,CAEd,CAEA,MAAM,yBAAyBL,EAAUC,EAAOI,EAAO,CACrD,MAAMa,EAAW,WAAWlB,CAAQ,IAAIC,CAAK,IAAII,CAAK,GACtD,GAAI,KAAK,MAAM,IAAIa,CAAQ,EACzB,OAAO,KAAK,MAAM,IAAIA,CAAQ,EAGhC,MAAMC,EAAS,IAAI,gBAAgB,CACjC,OAAQnB,EACR,EAAGC,EACH,MAAO,OAAOI,CAAK,EACnB,OAAQ,IACT,EACKe,EAAW,MAAM,MAAM,GAAG,KAAK,cAAc,2BAA2BD,EAAO,UAAU,EAAE,EACjG,GAAI,CAACC,EAAS,GACZ,MAAM,IAAI,MAAM,8BAA8BA,EAAS,MAAM,EAAE,EAIjE,MAAMjD,IADO,MAAMiD,EAAS,QACN,SAAW,IAAI,IAAIC,IAAS,CAChD,KAAMA,EAAK,KACX,QAASA,EAAK,SAAWA,EAAK,MAAQ,GACtC,SAAUA,EAAK,UAAYA,EAAK,SAAW,KAC3C,MAAOA,EAAK,OAAS,GACrB,QAASA,EAAK,SAAW,KACzB,UAAWA,EAAK,WAAa,KAC7B,SAAUA,EAAK,UACf,EACF,YAAK,MAAM,IAAIH,EAAU/C,CAAO,EACzBA,CACT,CAKA,MAAM,UAAU8B,EAAOI,EAAO,CAC5B,GAAI,CACF,OAAO,MAAM,KAAK,yBAAyB,MAAOJ,EAAOI,CAAK,CAChE,OAASiB,EAAO,CACd,QAAQ,KAAK,qDAAsDA,GAAO,SAAWA,CAAK,CAC5F,CAGA,KAAM,CAAE,YAAAzD,CAAA,EAAgB,4CAAM,QAAO,2BAAsB,kCAAAA,CAAA,6CAE3D,OADgBA,EAAY,YAAYoC,EAAO,KAAMI,CAAK,EAC3C,IAAIvB,IAAS,CAC1B,KAAMA,EAAK,KACX,QAASA,EAAK,KACd,UAAWA,EAAK,OAChB,SAAUA,EAAK,SACf,MAAOA,EAAK,OACZ,CACJ,CAEA,MAAM,WAAWmB,EAAOI,EAAO,CAC7B,GAAI,CACF,OAAO,MAAM,KAAK,yBAAyB,OAAQJ,EAAOI,CAAK,CACjE,OAASiB,EAAO,CACd,eAAQ,KAAK,mCAAoCA,GAAO,SAAWA,CAAK,EACjE,EACT,CACF,CAEA,MAAM,aAAarB,EAAOI,EAAO,CAC/B,GAAI,CACF,OAAO,MAAM,KAAK,yBAAyB,SAAUJ,EAAOI,CAAK,CACnE,OAASiB,EAAO,CACd,eAAQ,KAAK,qCAAsCA,GAAO,SAAWA,CAAK,EACnE,EACT,CACF,CAKA,MAAM,YAAYrB,EAAOI,EAAOC,EAAW,KAAM,CAC/C,MAAMY,EAAW,SAASjB,CAAK,IAAIK,CAAQ,IAAID,CAAK,GACpD,GAAI,KAAK,MAAM,IAAIa,CAAQ,EACzB,OAAO,KAAK,MAAM,IAAIA,CAAQ,EAGhC,GAAI,CAEF,MAAMK,EAAQ,MAAM,KAAK,gBAEnBH,EAAW,MAAM,MACrB,GAAG,KAAK,YAAY,MAAM,aAAa,mBAAmBnB,CAAK,CAAC,gKAChE,CACE,QAAS,CACP,cAAiB,UAAUsB,CAAK,GAChC,OAAU,mBACV,kBAAmBjB,EACnB,cAAe,KACjB,CACF,EAGF,GAAI,CAACc,EAAS,GACZ,MAAM,IAAI,MAAM,qBAAqBA,EAAS,MAAM,EAAE,EAIxD,MAAMjD,IADO,MAAMiD,EAAS,QACN,qBAAuB,IAAI,MAAM,EAAGf,CAAK,EAAE,IAAImB,IAAW,CAC9E,KAAMA,EAAO,QACb,QAASA,EAAO,MAChB,WAAYA,EAAO,WACnB,QAASA,EAAO,QAChB,MAAOA,EAAO,OAAS,IACvB,EAEF,YAAK,MAAM,IAAIN,EAAU/C,CAAO,EACzBA,CACT,OAASmD,EAAO,CACd,eAAQ,MAAM,uBAAwBA,CAAK,EACpC,KAAK,gBAAgBrB,EAAOI,CAAK,CAC1C,CACF,CAKA,MAAM,eAAgB,CACpB,MAAMoB,EAAgB,cAChBC,EAAS,KAAK,MAAM,IAAID,CAAa,EAE3C,GAAIC,GAAUA,EAAO,UAAY,KAAK,MACpC,OAAOA,EAAO,MAGhB,MAAMN,EAAW,MAAM,MAAM,KAAK,YAAY,SAAU,CACtD,OAAQ,OACR,QAAS,CAAE,eAAgB,qCAC3B,KAAM,IAAI,gBAAgB,CACxB,WAAY,qBACZ,UAAW,KAAK,YAAY,SAC5B,cAAe,KAAK,YAAY,aAChC,MAAO,gBACR,EACF,EAED,GAAI,CAACA,EAAS,GACZ,MAAM,IAAI,MAAM,4BAA4B,EAG9C,MAAMO,EAAO,MAAMP,EAAS,OAE5B,YAAK,MAAM,IAAIK,EAAe,CAC5B,MAAOE,EAAK,aACZ,UAAW,KAAK,MAASA,EAAK,WAAa,IAAQ,IACpD,EAEMA,EAAK,YACd,CAKA,MAAM,aAAa1B,EAAOI,EAAO,CAC/B,GAAI,CACF,MAAMuB,EAAc,MAAM,KAAK,yBAAyB,SAAU3B,EAAOI,CAAK,EAC9E,GAAIuB,EAAY,OAAS,EACvB,OAAOA,CAEX,OAASN,EAAO,CACd,QAAQ,KAAK,gEAAiEA,GAAO,SAAWA,CAAK,CACvG,CAEA,MAAMJ,EAAW,UAAUjB,CAAK,IAAII,CAAK,GACzC,GAAI,KAAK,MAAM,IAAIa,CAAQ,EACzB,OAAO,KAAK,MAAM,IAAIA,CAAQ,EAGhC,GAAI,CACF,MAAME,EAAW,MAAM,MACrB,GAAG,KAAK,aAAa,OAAO,uBAAuB,mBAAmBnB,CAAK,CAAC,UAAUI,CAAK,qBAC3F,CACE,QAAS,CAAE,OAAU,mBAAmB,CAC1C,EAGF,GAAI,CAACe,EAAS,GACZ,MAAM,IAAI,MAAM,qBAAqBA,EAAS,MAAM,EAAE,EAIxD,MAAMjD,IADO,MAAMiD,EAAS,QACN,OAAS,IAAI,IAAIS,IAAY,CACjD,KAAMA,EAAQ,UACd,QAASA,EAAQ,KAAK,MAAQA,EAAQ,IAAI,KAC1C,aAAcA,EAAQ,IAAI,KAC1B,SAAUA,EAAQ,SAClB,OAAQA,EAAQ,OAChB,MAAO,IACP,EAEF,YAAK,MAAM,IAAIX,EAAU/C,CAAO,EACzBA,CACT,OAASmD,EAAO,CACd,eAAQ,MAAM,uBAAwBA,CAAK,EACpC,KAAK,iBAAiBrB,EAAOI,CAAK,CAC3C,CACF,CAKA,MAAM,YAAYJ,EAAOI,EAAO,CAC9B,MAAMa,EAAW,SAASjB,CAAK,IAAII,CAAK,GACxC,GAAI,KAAK,MAAM,IAAIa,CAAQ,EACzB,OAAO,KAAK,MAAM,IAAIA,CAAQ,EAGhC,GAAI,CACF,MAAME,EAAW,MAAM,MACrB,GAAG,KAAK,YAAY,OAAO,oDAAoD,mBAAmBnB,CAAK,CAAC,GACxG,CACE,QAAS,CAAE,OAAU,wBAAwB,CAC/C,EAGF,GAAI,CAACmB,EAAS,GAAI,CAEhB,MAAMU,EAAiB,MAAM,MAC3B,GAAG,KAAK,YAAY,OAAO,wBAAwB,mBAAmB7B,CAAK,CAAC,WAAWI,CAAK,GAC5F,CAAE,QAAS,CAAE,OAAU,wBAAwB,CAAE,EAGnD,GAAI,CAACyB,EAAe,GAClB,MAAM,IAAI,MAAM,qBAAqB,EAGvC,MAAMC,EAAa,MAAMD,EAAe,OACxC,OAAO,KAAK,gBAAgBC,EAAY,OAAO,CACjD,CAEA,MAAMJ,EAAO,MAAMP,EAAS,OACtBjD,EAAU,KAAK,qBAAqBwD,CAAI,EAE9C,YAAK,MAAM,IAAIT,EAAU/C,CAAO,EACzBA,CACT,OAASmD,EAAO,CACd,eAAQ,MAAM,sBAAuBA,CAAK,EACnC,KAAK,gBAAgBrB,EAAOI,CAAK,CAC1C,CACF,CAKA,MAAM,cAAcJ,EAAOI,EAAO,CAEhC,OAAO,KAAK,gBAAgBJ,EAAOI,CAAK,CAC1C,CAKA,MAAM,UAAUJ,EAAOI,EAAO,CAE5B,OAAO,KAAK,cAAcJ,EAAOI,CAAK,CACxC,CAKA,MAAM,YAAYvB,EAAMkD,EAAc,CACpC,MAAMd,EAAW,WAAWc,CAAY,IAAIlD,CAAI,GAChD,GAAI,KAAK,MAAM,IAAIoC,CAAQ,EACzB,OAAO,KAAK,MAAM,IAAIA,CAAQ,EAGhC,MAAMe,EAAW,GAGXC,EAAgB,MAAM,KAAK,iBAAiBpD,EAAMkD,CAAY,EAIpE,GAHAC,EAAS,KAAK,GAAGC,CAAa,EAG1BF,IAAiB,SAAU,CAC7B,MAAMG,EAAc,MAAM,KAAK,qBAAqBrD,CAAI,EACxDmD,EAAS,KAAK,GAAGE,CAAW,CAC9B,CAEA,YAAK,MAAM,IAAIjB,EAAUe,CAAQ,EAC1BA,CACT,CAKA,MAAM,qBAAqBG,EAAY,CACrC,GAAI,CACF,MAAMhB,EAAW,MAAM,MACrB,GAAG,KAAK,aAAa,OAAO,+BAA+BgB,CAAU,uEACrE,CAAE,QAAS,CAAE,OAAU,wBAAwB,CAAE,EAGnD,GAAI,CAAChB,EAAS,GAAI,MAAO,GAEzB,MAAMO,EAAO,MAAMP,EAAS,OAC5B,OAAO,KAAK,uBAAuBO,CAAI,CACzC,OAASL,EAAO,CACd,eAAQ,MAAM,mCAAoCA,CAAK,EAChD,EACT,CACF,CAKA,MAAM,iBAAiBxC,EAAMkD,EAAc,CACzC,GAAI,CACF,MAAMb,EAAS,IAAI,gBAAgB,CACjC,aAAAa,EACA,KAAAlD,CAAA,CACD,EACKsC,EAAW,MAAM,MAAM,GAAG,KAAK,cAAc,6BAA6BD,EAAO,UAAU,EAAE,EACnG,OAAKC,EAAS,KACD,MAAMA,EAAS,QACf,UAAY,IAAI,IAAIiB,IAAM,CACrC,OAAQA,EAAE,OACV,KAAMA,EAAE,KACR,QAASA,EAAE,QACX,YAAaA,EAAE,aAAe,UAC9B,WAAYA,EAAE,YAAc,IAC5B,EARuB,EAS3B,OAASf,EAAO,CACd,eAAQ,KAAK,+BAAgCA,GAAO,SAAWA,CAAK,EAC7D,EACT,CACF,CAKA,qBAAqBH,EAAQ,CAC3B,MAAMhD,EAAU,GACVmE,EAAanB,EAAO,WAAa,GAEjCrC,EAAOwD,EAAW,QAAUC,EAAE,OAAS,MAAM,GAAG,UAChDC,EAAUF,EAAW,QAAUC,EAAE,OAAS,SAAS,GAAG,YAE5D,OAAIzD,GACFX,EAAQ,KAAK,CACX,KAAAW,EACA,QAAA0D,EACA,MAAO,EACR,EAGIrE,CACT,CAKA,gBAAgBsE,EAAQ/B,EAAQ,CAC9B,MAAMvC,EAAU,GACVuE,EAAUD,EAAO,OAAS,GAEhC,UAAWE,KAASD,EACdC,EAAM,UACRxE,EAAQ,KAAK,CACX,KAAMwE,EAAM,SAAS,MAAQA,EAAM,SAAS,GAC5C,QAASA,EAAM,SAAS,SAAWA,EAAM,SAAS,KAClD,MAAOA,EAAM,QAAQ,OAAS,GAC/B,EAIL,OAAOxE,CACT,CAKA,uBAAuBgD,EAAQ,CAC7B,MAAMc,EAAW,GAGjB,GAAI,CAFWd,EAAO,WAAW,QAAUoB,EAAE,OAAS,QAAQ,GAAG,aAEpD,OAAON,EAEpB,MAAMW,EAAUzB,EAAO,WAAW,UAAYoB,EAAE,OAAS,OAAO,GAAK,GAErE,UAAWM,KAASD,EAAS,CAC3B,MAAME,EAAQD,EAAM,MAAQ,GACtBE,EAAcD,EAAM,KAAKP,GAAKA,EAAE,OAAS,aAAa,GAAG,aAAa,KACtEV,EAAUiB,EAAM,QAAUP,EAAE,OAAS,SAAS,GAAG,YAEnDV,GACFI,EAAS,KAAK,CACZ,OAAQJ,EAAQ,OAChB,KAAMA,EAAQ,KACd,QAASA,EAAQ,QACjB,YAAakB,GAAe,UAC5B,WAAYA,IAAgB,aAAe,EAAM,GAClD,CAEL,CAEA,OAAOd,CACT,CAIA,gBAAgBhC,EAAOI,EAAO,CAC5B,MAAM2C,EAAW,CACf,CAAE,KAAM,OAAQ,QAAS,yBAA0B,QAAS,kBAC5D,CAAE,KAAM,OAAQ,QAAS,6BAA8B,QAAS,kBAChE,CAAE,KAAM,OAAQ,QAAS,2BAA4B,QAAS,aAC9D,CAAE,KAAM,OAAQ,QAAS,qBAAsB,QAAS,aACxD,CAAE,KAAM,OAAQ,QAAS,8BAA+B,QAAS,kBACjE,CAAE,KAAM,OAAQ,QAAS,wBAAyB,QAAS,mBAC3D,CAAE,KAAM,OAAQ,QAAS,YAAa,QAAS,eAC/C,CAAE,KAAM,OAAQ,QAAS,uBAAwB,QAAS,gBAAgB,EAGtEC,EAAIhD,EAAM,cAChB,OAAO+C,EACJ,OAAOE,GAAKA,EAAE,QAAQ,cAAc,SAASD,CAAC,GAAKC,EAAE,KAAK,cAAc,SAASD,CAAC,CAAC,EACnF,MAAM,EAAG5C,CAAK,EACd,IAAI6C,IAAM,CAAE,GAAGA,EAAG,MAAO,KAAO,CACrC,CAEA,iBAAiBjD,EAAOI,EAAO,CAC7B,MAAM2C,EAAW,CACf,CAAE,KAAM,WAAY,QAAS,yBAC7B,CAAE,KAAM,WAAY,QAAS,qBAC7B,CAAE,KAAM,WAAY,QAAS,gBAC7B,CAAE,KAAM,WAAY,QAAS,yBAC7B,CAAE,KAAM,WAAY,QAAS,4BAC7B,CAAE,KAAM,YAAa,QAAS,aAC9B,CAAE,KAAM,WAAY,QAAS,wBAC7B,CAAE,KAAM,YAAa,QAAS,+BAA+B,EAGzDC,EAAIhD,EAAM,cAChB,OAAO+C,EACJ,OAAOE,GAAKA,EAAE,QAAQ,cAAc,SAASD,CAAC,GAAKC,EAAE,KAAK,SAASD,CAAC,CAAC,EACrE,MAAM,EAAG5C,CAAK,EACd,IAAI6C,IAAM,CAAE,GAAGA,EAAG,MAAO,IAAM,CACpC,CAEA,gBAAgBjD,EAAOI,EAAO,CAC5B,MAAM2C,EAAW,CACf,CAAE,KAAM,SAAU,QAAS,kCAC3B,CAAE,KAAM,SAAU,QAAS,4CAC3B,CAAE,KAAM,SAAU,QAAS,4CAC3B,CAAE,KAAM,SAAU,QAAS,gDAC3B,CAAE,KAAM,SAAU,QAAS,iDAC3B,CAAE,KAAM,UAAW,QAAS,oCAC5B,CAAE,KAAM,UAAW,QAAS,kCAC5B,CAAE,KAAM,UAAW,QAAS,oCAAoC,EAG5DC,EAAIhD,EAAM,cAChB,OAAO+C,EACJ,OAAOE,GAAKA,EAAE,QAAQ,cAAc,SAASD,CAAC,GAAKC,EAAE,KAAK,SAASD,CAAC,CAAC,EACrE,MAAM,EAAG5C,CAAK,EACd,IAAI6C,IAAM,CAAE,GAAGA,EAAG,MAAO,KAAO,CACrC,CAEA,gBAAgBjD,EAAOI,EAAO,CAC5B,MAAM2C,EAAW,CACf,CAAE,KAAM,MAAO,QAAS,oCACxB,CAAE,KAAM,QAAS,QAAS,kDAC1B,CAAE,KAAM,SAAU,QAAS,kCAC3B,CAAE,KAAM,QAAS,QAAS,4CAC1B,CAAE,KAAM,SAAU,QAAS,iDAC3B,CAAE,KAAM,QAAS,QAAS,mCAC1B,CAAE,KAAM,QAAS,QAAS,qCAC1B,CAAE,KAAM,QAAS,QAAS,4CAA4C,EAGlEC,EAAIhD,EAAM,cAChB,OAAO+C,EACJ,OAAOE,GAAKA,EAAE,QAAQ,cAAc,SAASD,CAAC,GAAKC,EAAE,KAAK,cAAc,SAASD,CAAC,CAAC,EACnF,MAAM,EAAG5C,CAAK,EACd,IAAI6C,IAAM,CAAE,GAAGA,EAAG,MAAO,KAAO,CACrC,CAEA,cAAcjD,EAAOI,EAAO,CAC1B,MAAM2C,EAAW,CACf,CAAE,KAAM,UAAW,QAAS,mCAAoC,OAAQ,GAAK,OAAQ,KACrF,CAAE,KAAM,UAAW,QAAS,qCAAsC,OAAQ,GAAK,OAAQ,KACvF,CAAE,KAAM,UAAW,QAAS,uCAAwC,OAAQ,IAAK,OAAQ,KACzF,CAAE,KAAM,UAAW,QAAS,8BAA+B,OAAQ,IAAK,OAAQ,KAChF,CAAE,KAAM,UAAW,QAAS,6BAA8B,OAAQ,EAAK,OAAQ,KAC/E,CAAE,KAAM,UAAW,QAAS,kDAAmD,OAAQ,IAAK,OAAQ,KACpG,CAAE,KAAM,UAAW,QAAS,iDAAkD,OAAQ,IAAK,OAAQ,KACnG,CAAE,KAAM,UAAW,QAAS,mDAAoD,OAAQ,IAAK,OAAQ,IAAI,EAGrGC,EAAIhD,EAAM,cAChB,OAAO+C,EACJ,OAAOE,GAAKA,EAAE,QAAQ,cAAc,SAASD,CAAC,GAAKC,EAAE,KAAK,cAAc,SAASD,CAAC,CAAC,EACnF,MAAM,EAAG5C,CAAK,EACd,IAAI6C,IAAM,CAAE,GAAGA,EAAG,MAAO,KAAO,CACrC,CACF,CAGO,MAAMC,EAAqB,IAAIrD,ECxuB/B,SAASsD,GAAqB,CACnC,KAAM,CAAC1G,EAAaC,CAAc,EAAIC,WAAS,EAAE,EAC3C,CAACyG,EAAiBC,CAAkB,EAAI1G,WAAS,EAAE,EACnD,CAACC,EAAkBC,CAAmB,EAAIF,WAAS,KAAK,EACxD,CAACuB,EAASoF,CAAU,EAAI3G,WAAS,CAAE,MAAO,EAAG,QAAS,GAAI,QAAS,GAAI,EACvE,CAACK,EAAaC,CAAc,EAAIN,WAAS,EAAK,EAC9C,CAACG,EAAcC,CAAe,EAAIJ,WAAS,IAAI,EAC/C,CAACqF,EAAUuB,CAAW,EAAI5G,WAAS,EAAE,EACrC,CAAC6G,EAAiBC,CAAkB,EAAI9G,WAAS,EAAK,EACtDa,EAAQC,EAAA,EAERiG,EAAa/F,UAAQ,IAAM,OAAO,OAAOgC,CAAY,EAAG,EAAE,EAEhE3B,YAAU,IAAM,CACd,GAAIvB,EAAY,OAAS,EAAG,CAC1B6G,EAAW,CAAE,MAAO,EAAG,QAAS,GAAI,QAAS,GAAI,EACjD,MACF,CACA,MAAMrF,EAAQ,WAAW,SAAY,CACnChB,EAAe,EAAI,EACnB,GAAI,CACF,MAAM0G,EAAM,MAAMT,EAAmB,OAAOzG,EAAa,CACvD,QAAS2G,EAAgB,OAAS,EAAIA,EAAkB,KACxD,SAAUxG,IAAqB,MAAQA,EAAmB,KAC1D,MAAO,GACR,EACD0G,EAAWK,CAAG,CAChB,SACE1G,EAAe,EAAK,CACtB,CACF,EAAG,GAAG,EACN,MAAO,IAAM,aAAagB,CAAK,CACjC,EAAG,CAACxB,EAAa2G,EAAiBxG,CAAgB,CAAC,EAEnD,MAAMgH,EAAgB5C,GAAO,CAC3BqC,EAAmB1E,GAAQA,EAAK,SAASqC,CAAE,EAAIrC,EAAK,OAAOkF,GAAKA,IAAM7C,CAAE,EAAI,CAAC,GAAGrC,EAAMqC,CAAE,CAAC,CAC3F,EAEM8C,EAAmB,MAAOjF,GAAS,CACvC9B,EAAgB8B,CAAI,EACpB0E,EAAY,EAAE,EACdE,EAAmB,EAAI,EACvB,GAAI,CACF,MAAMrB,EAAI,MAAMc,EAAmB,YAAYrE,EAAK,KAAMA,EAAK,MAAM,EACrE0E,EAAYnB,CAAC,CACf,SACEqB,EAAmB,EAAK,CAC1B,CACF,EASMM,EAAmBlF,GAAS,CAChC,MAAM4B,EAAS,OAAO5B,GAAM,QAAU,EAAE,EAAE,cACpCmF,EAAU,mBAAmBnF,GAAM,MAAQ,EAAE,EACnD,OAAI4B,IAAW,MAAc,2BACzBA,IAAW,QAAgB,yCAAyCuD,CAAO,GAC3EvD,IAAW,UAAkB,8EAA8EuD,CAAO,GAClHvD,IAAW,SAAiB,gEAAgEuD,CAAO,GACnGvD,IAAW,QAAgB,oCAAoCuD,CAAO,GACnE,mCAAmC,mBAAmB,GAAGnF,GAAM,YAAc,iBAAiB,IAAIA,GAAM,MAAQ,EAAE,EAAE,CAAC,EAC9H,EAEA,OACEC,OAAC,OAAI,UAAU,+CACZ,UAAAA,OAAC,UAAO,UAAU,8JACf,UAAAC,MAAC,OAAI,UAAU,4DACZ,SAAAA,MAAC,QAAK,UAAU,oDAAoD,eAAG,EAC1E,EAEAD,OAAC,OAAI,UAAU,6EACZ,UAAAC,MAAC,OAAI,UAAU,YACZ,SAAAA,MAACC,EAAA,CACC,MAAM,mBACN,SAAU,4BAA4B0E,EAAW,MAAM,8BACvD,MAAM,iBAEX,EACA5E,OAAC,OAAI,UAAU,0BACZ,UAAAC,MAAC,OAAI,UAAU,yIAAyI,0BAAc,EACtKA,MAAC,OAAI,UAAU,gIAAgI,uBAAW,GAC7J,GACH,EAEAD,OAAC,OAAI,UAAU,0BACZ,UAAAA,OAAC,OAAI,UAAU,iBACZ,UAAAC,MAAC,QAAK,UAAU,oFAAoF,kBAAM,EAC1GA,MAAC,SACC,KAAK,OACL,MAAOtC,EACP,SAAW8B,GAAM7B,EAAe6B,EAAE,OAAO,KAAK,EAC9C,YAAY,4EACZ,UAAU,0SAEXvB,GAAe+B,MAAC,OAAI,UAAU,2HAA2H,GAC7J,QAEC,OAAI,UAAU,uBACX,SAAA2E,EAAW,IAAIG,GACb/E,OAAC,UAEC,QAAS,IAAM8E,EAAaC,EAAE,EAAE,EAChC,UAAW,kIACTT,EAAgB,SAASS,EAAE,EAAE,EACzB,6CACA,mEACN,GACA,MAAO,CAAE,MAAOT,EAAgB,SAASS,EAAE,EAAE,EAAIA,EAAE,MAAQ,OAAW,gBAAiBT,EAAgB,SAASS,EAAE,EAAE,EAAI,GAAGA,EAAE,KAAK,KAAO,SAExI,UAAA9E,MAAC,QAAK,UAAU,sBAAsB,MAAO,CAAE,gBAAiB8E,EAAE,OAAS,EAC1EA,EAAE,OAVCA,EAAE,GAYX,EACJ,GACH,GACH,EAEA/E,OAAC,OAAI,UAAU,8BACZ,UAAAC,MAAC,OAAI,UAAU,4DACZ,SAAAA,MAAC,OAAI,UAAU,mCACX,SAAAtC,EAAY,OAAS,QAClB,WAAQ,UAAU,0EACf,SAAAiH,EAAW,OAAS3E,MAACkF,EAAA,CAAsB,OAAQJ,CAAA,EAAdA,EAAE,EAAe,CAAE,EAC5D,EACC3F,EAAQ,QAAQ,OAAS,EAC1Ba,MAAC,OAAI,UAAU,6BACX,SAAAb,EAAQ,QAAQ,IAAI,CAACE,EAAGc,IACtBH,MAACmF,EAAA,CAEC,KAAM9F,EACN,SAAUtB,GAAc,OAASsB,EAAE,KACnC,QAAS,IAAM0F,EAAiB1F,CAAC,GAH5BA,EAAE,KAAOc,CAAA,CAKlB,EACJ,EAEAJ,OAAC,OAAI,UAAU,6DACZ,UAAAC,MAAC,QAAK,UAAU,mDAAmD,yBAAa,EAChFA,MAAC,KAAE,UAAU,oDAAoD,+BAAmB,GACvF,EAEN,EACH,EAECjC,SACG,SAAM,UAAU,8IACd,SAAAgC,OAAC,OAAI,UAAU,kBACZ,UAAAA,OAAC,OAAI,UAAU,mCACZ,UAAAA,OAAC,OAAI,UAAU,YACZ,UAAAC,MAAC,OAAI,UAAU,0IAA2I,SAAAjC,EAAa,WAAW,EAClLiC,MAAC,MAAG,UAAU,sEAAuE,WAAa,KAAK,GAC1G,EACAA,MAAC,UAAO,QAAS,IAAMhC,EAAgB,IAAI,EAAG,UAAU,+DACrD,SAAAgC,MAAC,QAAK,UAAU,4BAA4B,iBAAK,EACpD,GACH,EAEAD,OAAC,OAAI,UAAU,YACZ,UAAAA,OAAC,OAAI,UAAU,YACZ,UAAAC,MAAC,KAAE,UAAU,kEAAkE,qBAAS,EACxFD,OAAC,KAAE,UAAU,+EAA+E,cAAEhC,EAAa,QAAQ,KAAC,GACvH,EACAgC,OAAC,OAAI,UAAU,yBACZ,UAAAC,MAACoF,GAAS,MAAM,SAAS,MAAM,SAAS,MAAM,UAAU,QACvDA,EAAA,CAAS,MAAM,WAAW,MAAM,SAAS,MAAM,QAAQ,GAC3D,GACH,SAEC1E,EAAA,CACE,UAAAV,MAACqF,GAAW,MAAM,kBAAkB,SAAS,gCAAgC,KAAK,MAAM,EACxFrF,MAACW,EAAA,CAAS,UAAU,MAChB,SAAA8D,EACEzE,MAAC,OAAI,UAAU,mBAAmB,SAAAA,MAAC,OAAI,UAAU,yFAAyF,EAAM,EAEhJA,MAAC,OAAI,UAAU,kDACX,SAAAiD,EAAS,IAAI,CAACI,EAAGlD,IACfJ,OAAC,OAAY,UAAU,uGACpB,UAAAA,OAAC,OAAI,UAAU,YACZ,UAAAC,MAAC,KAAE,UAAU,iEAAkE,SAAAqD,EAAE,OAAO,EACxFrD,MAAC,KAAE,UAAU,4DAA6D,WAAE,KAAK,GACpF,EACAD,OAAC,QAAK,UAAU,gHAAiH,eAAK,MAAMsD,EAAE,WAAa,GAAG,EAAE,WAAO,IALhKlD,CAMV,CACF,EACJ,EAEN,GACH,EAEAJ,OAAC,OAAI,UAAU,iBACZ,UAAAC,MAACK,EAAA,CACC,UAAU,4CACV,KAAK,eACL,QAAS,IAAM,CACb,MAAMiF,EAAU,CACd,OAAQ,kBACR,OAAQvH,EAAa,OACrB,WAAYA,EAAa,WACzB,KAAMA,EAAa,KACnB,YAAaA,EAAa,SAE5B,OAAO,aAAa,QAAQ,yBAA0B,KAAK,UAAUuH,CAAO,CAAC,EAC7E7G,EAAM,QAAQ,6CAA6C,EAC3D,OAAO,cAAc,IAAI,YAAY,eAAgB,CAAE,OAAQ,CAAE,KAAM,gBAAgB,CAAG,CAAC,CAC7F,EACD,kCAGDuB,MAACK,EAAA,CACC,QAAQ,YACR,UAAU,cACV,KAAK,QACL,QAAS,IAAM,CACb,MAAMkF,EAAMP,EAAgBjH,CAAY,EACxC,OAAO,KAAKwH,EAAK,SAAU,qBAAqB,EAChD9G,EAAM,KAAK,wCAAwC,CACrD,EACD,+BAED,EACH,GACH,EACH,GAEN,GACH,CAEJ,CAEA,SAASyG,EAAW,CAAE,OAAAxD,GAAU,CAC9B,aACGhB,EAAA,CAAK,UAAU,0CACb,SAAAX,OAACY,EAAA,CAAS,UAAU,gBACjB,UAAAX,MAAC,OAAI,UAAU,gEAAgE,MAAO,CAAE,gBAAiB,GAAG0B,EAAO,KAAK,KAAM,MAAOA,EAAO,OACzI,SAAA1B,MAAC,QAAK,UAAU,4BAA6B,SAAA0B,EAAO,KAAK,EAC5D,SACC,OACE,UAAA1B,MAAC,MAAG,UAAU,6EAA8E,SAAA0B,EAAO,KAAK,EACxG3B,OAAC,KAAE,UAAU,iEAAkE,UAAA2B,EAAO,MAAM,iBAAiB,UAAM,GACtH,GACH,EACH,CAEJ,CAEA,SAASyD,EAAkB,CAAE,KAAArF,EAAM,SAAAS,EAAU,QAAAC,GAAW,CACtD,OACET,OAAC,OACC,QAAAS,EACA,UAAW,qFACTD,EAAW,8DAAgE,sHAC7E,GAEC,UAAAP,MAAC,OAAI,UAAU,yEAAyE,MAAO,CAAE,gBAAiB,GAAGF,EAAK,WAAW,KAAM,MAAOA,EAAK,aACpJ,SAAAE,MAAC,QAAK,UAAU,4BAA4B,eAAG,EAClD,EACAD,OAAC,OAAI,UAAU,mBACZ,UAAAA,OAAC,OAAI,UAAU,0BACZ,UAAAC,MAAC,QAAK,UAAU,6FAA6F,MAAO,CAAE,MAAOF,EAAK,YAAa,gBAAiB,GAAGA,EAAK,WAAW,MAAS,WAAK,WAAW,EAC5ME,MAAC,QAAK,UAAU,8DAA+D,WAAK,KAAK,GAC5F,EACAD,OAAC,KAAE,UAAU,0EAA0E,cAAED,EAAK,QAAQ,KAAC,GAC1G,EACAE,MAAC,QAAK,UAAU,qEAAqE,yBAAa,IAGzG,CAEA,SAASoF,EAAS,CAAE,MAAAI,EAAO,MAAAC,EAAO,MAAAC,GAAS,CACzC,OACE3F,OAAC,OAAI,UAAU,wGACZ,UAAAC,MAAC,KAAE,UAAU,iEAAkE,SAAAwF,EAAM,EACrFxF,MAAC,KAAE,UAAW,sBAAsB0F,IAAU,UAAY,mBAAqB,gBAAgB,GAAK,SAAAD,CAAA,CAAM,GAC7G,CAEJ","names":["SBSCodeBrowser","searchQuery","setSearchQuery","useState","selectedCategory","setSelectedCategory","selectedCode","setSelectedCode","isSearching","setIsSearching","aiInsights","setAiInsights","displayLimit","setDisplayLimit","scrollRef","useRef","toast","useToast","allCodes","useMemo","aiAssistant","categories","searchResults","setSearchResults","useEffect","timer","results","filtered","c","displayedCodes","handleScroll","e","scrollTop","scrollHeight","clientHeight","prev","copyCode","code","jsxs","jsx","SectionHeader","cat","i","CodeCell","Button","context","selected","onClick","onCopy","Card","CardBody","CODE_SYSTEMS","SYSTEM_CATEGORIES","UnifiedTerminologyService","__vite_import_meta_env__","systemId","query","options","systems","category","limit","language","includeInactive","targetSystems","searchPromises","system","codes","err","allResults","systemResults","a","b","id","cacheKey","params","response","item","error","token","entity","tokenCacheKey","cached","data","localMapped","concept","searchResponse","searchData","sourceSystem","mappings","localMappings","icdMappings","snomedCode","m","parameters","p","display","bundle","entries","entry","matches","match","parts","equivalence","mockData","q","d","unifiedTerminology","UnifiedCodeBrowser","selectedSystems","setSelectedSystems","setResults","setMappings","loadingMappings","setLoadingMappings","allSystems","res","toggleSystem","s","handleCodeSelect","getRegistryLink","encoded","SystemPill","UnifiedResultCard","InfoByte","CardHeader","payload","url","label","value","color"],"ignoreList":[],"sources":["../../src/pages/SBSCodeBrowser.jsx","../../src/services/unifiedTerminologyService.js","../../src/pages/UnifiedCodeBrowser.jsx"],"sourcesContent":["import { useState, useMemo, useCallback, useRef, useEffect } from 'react';\nimport { aiAssistant } from '../services/aiAssistantService';\nimport { useToast } from '../components/Toast';\nimport { Card, CardBody, CardHeader } from '../components/ui/Card';\nimport { SectionHeader } from '../components/ui/SectionHeader';\nimport { Button } from '../components/ui/Button';\n\n/**\n * Premium SBS Code Browser\n * Unified Terminology Explorer for GIVC-SBS\n */\nexport function SBSCodeBrowser() {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedCategory, setSelectedCategory] = useState('all');\n  const [selectedCode, setSelectedCode] = useState(null);\n  const [isSearching, setIsSearching] = useState(false);\n  const [aiInsights, setAiInsights] = useState(null);\n  const [displayLimit, setDisplayLimit] = useState(100);\n  const scrollRef = useRef(null);\n  const toast = useToast();\n  \n  const allCodes = useMemo(() => aiAssistant.getAllCodes(), []);\n  const categories = useMemo(() => ['all', ...aiAssistant.getCategories()], []);\n\n  const [searchResults, setSearchResults] = useState({ results: allCodes, source: 'local' });\n\n  useEffect(() => {\n    const timer = setTimeout(async () => {\n      if (searchQuery.length >= 2) {\n        setIsSearching(true);\n        try {\n          const results = await aiAssistant.smartSearch(searchQuery, {\n            limit: 200,\n            category: selectedCategory === 'all' ? null : selectedCategory,\n            includeAI: true\n          });\n          setSearchResults(results);\n          setAiInsights(results.aiInsights);\n        } finally {\n          setIsSearching(false);\n        }\n      } else {\n        const filtered = selectedCategory === 'all' \n          ? allCodes \n          : allCodes.filter(c => c.category === selectedCategory);\n        setSearchResults({ results: filtered, source: 'local' });\n        setAiInsights(null);\n      }\n    }, 300);\n    return () => clearTimeout(timer);\n  }, [searchQuery, selectedCategory, allCodes]);\n\n  useEffect(() => {\n    setDisplayLimit(100);\n  }, [searchQuery, selectedCategory]);\n\n  const displayedCodes = useMemo(() => searchResults.results.slice(0, displayLimit), [searchResults, displayLimit]);\n\n  const handleScroll = (e) => {\n    const { scrollTop, scrollHeight, clientHeight } = e.target;\n    if (scrollHeight - scrollTop - clientHeight < 400 && displayLimit < searchResults.results.length) {\n      setDisplayLimit(prev => prev + 100);\n    }\n  };\n\n  const copyCode = (code) => {\n    navigator.clipboard\n      .writeText(code)\n      .then(() => toast.success(`Code ${code} synchronized to clipboard`))\n      .catch(() => toast.error('Clipboard access denied by browser'));\n  };\n\n  return (\n    <div className=\"flex-1 overflow-hidden bg-grid flex\">\n      {/* Main Search Area */}\n      <div className=\"flex-1 flex flex-col min-w-0\">\n        <header className=\"px-8 py-10 sm:px-12 space-y-8 animate-premium-in\">\n           <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6\">\n              <SectionHeader \n                title=\"Terminology Explorer\" \n                subtitle={`Global registry of ${allCodes.length.toLocaleString()} individual SBS clinical markers.`}\n                badge=\"Knowledge Graph\"\n              />\n              <div className=\"flex bg-slate-100 dark:bg-slate-900/50 p-1.5 rounded-2xl border border-slate-200 dark:border-slate-800\">\n                 <button className=\"px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest bg-white dark:bg-slate-800 shadow-sm\">Grid Matrix</button>\n                 <button className=\"px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-400\">Condensed</button>\n              </div>\n           </div>\n\n           <div className=\"flex flex-col sm:flex-row gap-4\">\n              <div className=\"flex-1 relative group\">\n                 <span className=\"absolute left-5 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-400 group-focus-within:text-blue-600 transition-colors\">search</span>\n                 <input \n                    type=\"text\" \n                    placeholder=\"Search by ID, semantics, or clinical description...\" \n                    className=\"w-full h-16 bg-white dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 rounded-[28px] pl-14 pr-20 text-sm font-bold focus:outline-none focus:border-blue-600/30 focus:ring-4 focus:ring-blue-600/5 transition-all shadow-sm\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                 />\n                 {isSearching && <div className=\"absolute right-6 top-1/2 -translate-y-1/2 size-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>}\n              </div>\n              <select \n                className=\"h-16 px-6 bg-white dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 rounded-[28px] text-xs font-black uppercase tracking-widest focus:outline-none\"\n                value={selectedCategory}\n                onChange={(e) => setSelectedCategory(e.target.value)}\n              >\n                 {categories.map(cat => <option key={cat} value={cat}>{cat.replace(/_/g, ' ')}</option>)}\n              </select>\n           </div>\n           \n           {aiInsights && (\n              <div className=\"p-4 rounded-2xl bg-blue-600/5 border border-blue-600/10 flex items-center gap-3 animate-premium-in\">\n                 <span className=\"material-symbols-outlined text-blue-600\">auto_awesome</span>\n                 <p className=\"text-xs font-bold text-slate-600 dark:text-gray-300 italic\">{aiInsights}</p>\n              </div>\n           )}\n        </header>\n\n        <div \n          ref={scrollRef}\n          onScroll={handleScroll}\n          className=\"flex-1 overflow-y-auto px-8 sm:px-12 pb-12 scrollbar-hide\"\n        >\n           <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 stagger-children\">\n              {displayedCodes.map((c, i) => (\n                <CodeCell \n                  key={c.code + i} \n                  code={c} \n                  selected={selectedCode?.code === c.code}\n                  onClick={() => setSelectedCode(c)}\n                  onCopy={() => copyCode(c.code)}\n                />\n              ))}\n           </div>\n           {searchResults.results.length === 0 && (\n             <div className=\"flex flex-col items-center justify-center py-32 space-y-6 opacity-40\">\n                <span className=\"material-symbols-outlined text-[80px] font-black\">search_off</span>\n                <p className=\"font-black uppercase tracking-widest text-sm\">No clinical markers found</p>\n             </div>\n           )}\n        </div>\n      </div>\n\n      {/* Dynamic Detail Panel */}\n      {selectedCode && (\n        <aside className=\"w-[450px] bg-white dark:bg-slate-950 border-l border-slate-100 dark:border-slate-800 overflow-y-auto animate-premium-in shadow-2xl z-20\">\n           <div className=\"p-10 space-y-10\">\n              <div className=\"flex justify-between items-start\">\n                 <div className=\"space-y-1\">\n                    <p className=\"text-[10px] font-black uppercase tracking-widest text-blue-600\">Registry Detail</p>\n                    <h2 className=\"text-3xl font-black text-slate-900 dark:text-white tracking-tighter\">{selectedCode.code}</h2>\n                 </div>\n                 <button onClick={() => setSelectedCode(null)} className=\"p-2 rounded-xl bg-slate-50 dark:bg-slate-900 text-slate-400 hover:text-rose-500 transition-colors\">\n                    <span className=\"material-symbols-outlined\">close</span>\n                 </button>\n              </div>\n\n              <div className=\"space-y-6\">\n                 <div className=\"space-y-2\">\n                    <label className=\"text-[10px] font-black uppercase tracking-widest text-slate-400\">Technical Designation</label>\n                    <p className=\"text-sm font-bold leading-relaxed text-slate-800 dark:text-gray-100\">{selectedCode.desc}</p>\n                 </div>\n                 <div className=\"space-y-2\">\n                    <label className=\"text-[10px] font-black uppercase tracking-widest text-slate-400\">Domain Classification</label>\n                    <div className=\"inline-flex px-4 py-1.5 rounded-xl bg-blue-600 text-white text-[10px] font-black uppercase tracking-widest shadow-lg shadow-blue-600/20\">\n                       {selectedCode.category || 'Clinical General'}\n                    </div>\n                 </div>\n              </div>\n\n              <div className=\"p-8 rounded-[40px] bg-slate-50 dark:bg-slate-900 border border-slate-100 dark:border-slate-800 space-y-6\">\n                 <h4 className=\"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-slate-500\">\n                    <span className=\"material-symbols-outlined text-blue-600 text-lg\">psychology</span>\n                    Neural Cross-Reference\n                 </h4>\n                 <div className=\"space-y-4\">\n                    <div className=\"flex justify-between items-center text-xs font-bold text-slate-400\">\n                       <span>Approval Confidence</span>\n                       <span className=\"text-blue-600\">98.2%</span>\n                    </div>\n                    <div className=\"h-1.5 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden\">\n                       <div className=\"h-full bg-blue-600 w-[98%]\"></div>\n                    </div>\n                 </div>\n                 <p className=\"text-[11px] font-bold text-slate-500 leading-relaxed italic\">\n                    DeepSeek inference suggests high correlation with <span className=\"text-blue-600 font-black\">ICD-10 M17.0</span> diagnostic pathways.\n                 </p>\n              </div>\n\n              <div className=\"space-y-4 pt-4\">\n                 <Button\n                   className=\"w-full py-6 text-sm shadow-xl shadow-blue-600/20\"\n                   icon=\"add_box\"\n                   onClick={() => {\n                     const context = {\n                       code: selectedCode.code,\n                       description: selectedCode.desc,\n                       category: selectedCode.category || null\n                     };\n                     window.localStorage.setItem('sbs_claim_context_code', JSON.stringify(context));\n                     toast.success('Code context assigned to claim builder');\n                     window.dispatchEvent(new CustomEvent('sbs:navigate', { detail: { view: 'claim-builder' } }));\n                   }}\n                 >\n                   Enroll in Workspace\n                 </Button>\n                 <Button variant=\"secondary\" className=\"w-full py-6 text-sm\" icon=\"content_copy\" onClick={() => copyCode(selectedCode.code)}>Copy Entity ID</Button>\n              </div>\n           </div>\n        </aside>\n      )}\n    </div>\n  );\n}\n\nfunction CodeCell({ code, selected, onClick, onCopy }) {\n  return (\n    <Card \n      onClick={onClick}\n      className={`group cursor-pointer transition-all hover:scale-[1.02] border-2 ${selected ? 'border-blue-600 shadow-2xl shadow-blue-600/10' : 'border-transparent'}`}\n    >\n       <CardBody className=\"p-8 space-y-6\">\n          <div className=\"flex justify-between items-center\">\n             <span className=\"text-lg font-black tracking-tight text-blue-600 font-mono\">{code.code}</span>\n             <button onClick={(e) => { e.stopPropagation(); onCopy(); }} className=\"size-8 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-400 opacity-0 group-hover:opacity-100 hover:text-blue-600 transition-all\">\n                <span className=\"material-symbols-outlined text-sm\">content_copy</span>\n             </button>\n          </div>\n          <p className=\"text-sm font-bold text-slate-800 dark:text-gray-100 line-clamp-2 leading-snug group-hover:text-blue-600 transition-colors\">\n             {code.desc}\n          </p>\n          <div className=\"pt-2 border-t border-slate-100 dark:border-slate-800 flex justify-between items-center\">\n             <span className=\"text-[9px] font-black uppercase tracking-widest text-slate-400\">{code.category?.replace(/_/g, ' ') || 'Clinical'}</span>\n             {code.source === 'ai' && <span className=\"material-symbols-outlined text-amber-500 text-lg\">auto_awesome</span>}\n          </div>\n       </CardBody>\n    </Card>\n  );\n}\n","/**\n * Unified Terminology Service\n * Integrates multiple healthcare coding systems into a single interface\n * Supports: SBS, ICD-10-AM, ICD-11, SNOMED CT, LOINC, DRG, RxNorm\n */\n\n// Code system definitions with FHIR canonical URLs\nexport const CODE_SYSTEMS = {\n  SBS: {\n    id: 'sbs',\n    name: 'Saudi Billing System',\n    uri: 'http://chi.gov.sa/sbs',\n    version: '3.1',\n    publisher: 'Council of Health Insurance (CHI)',\n    count: 10466,\n    color: '#137fec',\n    icon: 'receipt_long',\n    loaded: true\n  },\n  ICD10AM: {\n    id: 'icd10am',\n    name: 'ICD-10-AM',\n    uri: 'http://hl7.org/fhir/sid/icd-10-am',\n    version: '12th Edition',\n    publisher: 'IHPA / WHO',\n    count: 17000,\n    color: '#ef4444',\n    icon: 'diagnosis',\n    loaded: false\n  },\n  ICD11: {\n    id: 'icd11',\n    name: 'ICD-11',\n    uri: 'http://id.who.int/icd/release/11',\n    version: '2025',\n    publisher: 'WHO',\n    count: 17000,\n    color: '#f97316',\n    icon: 'medical_information',\n    loaded: false\n  },\n  SNOMED: {\n    id: 'snomed',\n    name: 'SNOMED CT',\n    uri: 'http://snomed.info/sct',\n    version: 'July 2025',\n    publisher: 'SNOMED International',\n    count: 360000,\n    color: '#8b5cf6',\n    icon: 'psychology',\n    loaded: false\n  },\n  DRG: {\n    id: 'drg',\n    name: 'Diagnosis Related Groups',\n    uri: 'http://chi.gov.sa/drg',\n    version: 'AR-DRG 11.0',\n    publisher: 'IHPA / CHI',\n    count: 800,\n    color: '#22c55e',\n    icon: 'category',\n    loaded: false\n  },\n  LOINC: {\n    id: 'loinc',\n    name: 'LOINC',\n    uri: 'http://loinc.org',\n    version: '2.81',\n    publisher: 'Regenstrief Institute',\n    count: 100000,\n    color: '#06b6d4',\n    icon: 'science',\n    loaded: false\n  },\n  RXNORM: {\n    id: 'rxnorm',\n    name: 'RxNorm',\n    uri: 'http://www.nlm.nih.gov/research/umls/rxnorm',\n    version: 'Weekly',\n    publisher: 'US NLM',\n    count: 120000,\n    color: '#ec4899',\n    icon: 'medication',\n    loaded: false\n  },\n  ACHI: {\n    id: 'achi',\n    name: 'ACHI',\n    uri: 'http://hl7.org/fhir/sid/achi',\n    version: '12th Edition',\n    publisher: 'IHPA',\n    count: 6000,\n    color: '#14b8a6',\n    icon: 'surgical',\n    loaded: false\n  },\n  DENTAL: {\n    id: 'dental',\n    name: 'Dental Pricelist',\n    uri: 'http://chi.gov.sa/sbs/dental',\n    version: 'Gov Sector',\n    publisher: 'CHI',\n    count: 713,\n    color: '#0ea5a4',\n    icon: 'dentistry',\n    loaded: true\n  }\n};\n\n// Code system category mappings\nexport const SYSTEM_CATEGORIES = {\n  diagnosis: ['icd10am', 'icd11', 'snomed'],\n  procedure: ['sbs', 'achi', 'snomed', 'dental'],\n  laboratory: ['loinc'],\n  medication: ['rxnorm'],\n  billing: ['sbs', 'drg', 'dental'],\n  clinical: ['snomed', 'icd10am', 'icd11']\n};\n\n/**\n * Unified Terminology Service Class\n */\nclass UnifiedTerminologyService {\n  constructor() {\n    this.systems = CODE_SYSTEMS;\n    this.cache = new Map();\n    this.mappings = new Map();\n    this.landingApiBase = (typeof window !== 'undefined' && window.SBS_API_URL) ? window.SBS_API_URL : '';\n    \n    // WHO ICD-11 API configuration\n    this.icd11Config = {\n      baseUrl: 'https://id.who.int/icd',\n      apiUrl: 'https://id.who.int/icd/release/11/2025/mms',\n      tokenUrl: 'https://icdaccessmanagement.who.int/connect/token',\n      clientId: import.meta.env?.VITE_ICD11_CLIENT_ID || '',\n      clientSecret: import.meta.env?.VITE_ICD11_CLIENT_SECRET || ''\n    };\n    \n    // SNOMED Snowstorm API\n    this.snomedConfig = {\n      baseUrl: 'https://snowstorm.ihtsdotools.org/snowstorm/snomed-ct',\n      fhirUrl: 'https://snowstorm.ihtsdotools.org/fhir'\n    };\n    \n    // LOINC API\n    this.loincConfig = {\n      baseUrl: 'https://fhir.loinc.org',\n      searchUrl: 'https://loinc.org/api'\n    };\n  }\n\n  /**\n   * Get all available code systems\n   */\n  getSystems() {\n    return Object.values(this.systems);\n  }\n\n  /**\n   * Get system by ID\n   */\n  getSystem(systemId) {\n    return Object.values(this.systems).find(s => s.id === systemId);\n  }\n\n  /**\n   * Unified search across all or selected systems\n   */\n  async search(query, options = {}) {\n    const {\n      systems = null,\n      category = null,\n      limit = 20,\n      language = 'en',\n      includeInactive = false\n    } = options;\n\n    // Determine which systems to search\n    let targetSystems = Object.keys(this.systems);\n    \n    if (systems && systems.length > 0) {\n      targetSystems = systems;\n    } else if (category) {\n      targetSystems = SYSTEM_CATEGORIES[category] || targetSystems;\n    }\n\n    const results = [];\n    const searchPromises = [];\n\n    for (const systemId of targetSystems) {\n      const system = this.getSystem(systemId);\n      if (!system) continue;\n\n      // Search each system\n      searchPromises.push(\n        this.searchSystem(systemId, query, { limit, language })\n          .then(codes => codes.map(code => ({\n            ...code,\n            system: system.id,\n            systemName: system.name,\n            systemUri: system.uri,\n            systemColor: system.color\n          })))\n          .catch(err => {\n            console.warn(`Search failed for ${systemId}:`, err);\n            return [];\n          })\n      );\n    }\n\n    const allResults = await Promise.all(searchPromises);\n    \n    // Merge and sort by relevance\n    for (const systemResults of allResults) {\n      results.push(...systemResults);\n    }\n\n    // Sort by score (higher is better)\n    results.sort((a, b) => (b.score || 0) - (a.score || 0));\n\n    return {\n      total: results.length,\n      results: results.slice(0, limit),\n      systems: targetSystems.map(id => this.getSystem(id)).filter(Boolean)\n    };\n  }\n\n  /**\n   * Search a specific code system\n   */\n  async searchSystem(systemId, query, options = {}) {\n    const { limit = 20, language = 'en' } = options;\n\n    switch (systemId) {\n      case 'sbs':\n        return this.searchSBS(query, limit);\n      case 'achi':\n        return this.searchACHI(query, limit);\n      case 'dental':\n        return this.searchDental(query, limit);\n      case 'icd11':\n        return this.searchICD11(query, limit, language);\n      case 'snomed':\n        return this.searchSNOMED(query, limit);\n      case 'loinc':\n        return this.searchLOINC(query, limit);\n      case 'icd10am':\n        return this.searchICD10AM(query, limit);\n      case 'drg':\n        return this.searchDRG(query, limit);\n      default:\n        return [];\n    }\n  }\n\n  async searchLandingTerminology(systemId, query, limit) {\n    const cacheKey = `landing:${systemId}:${query}:${limit}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    const params = new URLSearchParams({\n      system: systemId,\n      q: query,\n      limit: String(limit),\n      offset: '0'\n    });\n    const response = await fetch(`${this.landingApiBase}/api/terminology/search?${params.toString()}`);\n    if (!response.ok) {\n      throw new Error(`Landing terminology error: ${response.status}`);\n    }\n\n    const data = await response.json();\n    const results = (data.results || []).map(item => ({\n      code: item.code,\n      display: item.display || item.desc || '',\n      category: item.category || item.chapter || null,\n      score: item.score || 0.9,\n      sbsCode: item.sbsCode || null,\n      specialty: item.specialty || null,\n      priceSar: item.priceSar\n    }));\n    this.cache.set(cacheKey, results);\n    return results;\n  }\n\n  /**\n   * Search SBS codes (local)\n   */\n  async searchSBS(query, limit) {\n    try {\n      return await this.searchLandingTerminology('sbs', query, limit);\n    } catch (error) {\n      console.warn('Landing SBS search unavailable, using local index:', error?.message || error);\n    }\n\n    // Use the existing AI assistant service\n    const { aiAssistant } = await import('./aiAssistantService');\n    const results = aiAssistant.localSearch(query, null, limit);\n    return results.map(code => ({\n      code: code.code,\n      display: code.desc,\n      displayAr: code.descAr,\n      category: code.category,\n      score: code.score\n    }));\n  }\n\n  async searchACHI(query, limit) {\n    try {\n      return await this.searchLandingTerminology('achi', query, limit);\n    } catch (error) {\n      console.warn('Landing ACHI search unavailable:', error?.message || error);\n      return [];\n    }\n  }\n\n  async searchDental(query, limit) {\n    try {\n      return await this.searchLandingTerminology('dental', query, limit);\n    } catch (error) {\n      console.warn('Landing dental search unavailable:', error?.message || error);\n      return [];\n    }\n  }\n\n  /**\n   * Search WHO ICD-11 API\n   */\n  async searchICD11(query, limit, language = 'en') {\n    const cacheKey = `icd11:${query}:${language}:${limit}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    try {\n      // Get access token\n      const token = await this.getICD11Token();\n      \n      const response = await fetch(\n        `${this.icd11Config.apiUrl}/search?q=${encodeURIComponent(query)}&subtreeFilterUsesFoundationDescendants=false&includeKeywordResult=true&useFlexisearch=true&flatResults=true&highlightingEnabled=false&medicalCodingMode=true`,\n        {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n            'Accept': 'application/json',\n            'Accept-Language': language,\n            'API-Version': 'v2'\n          }\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`ICD-11 API error: ${response.status}`);\n      }\n\n      const data = await response.json();\n      const results = (data.destinationEntities || []).slice(0, limit).map(entity => ({\n        code: entity.theCode,\n        display: entity.title,\n        definition: entity.definition,\n        chapter: entity.chapter,\n        score: entity.score || 0.8\n      }));\n\n      this.cache.set(cacheKey, results);\n      return results;\n    } catch (error) {\n      console.error('ICD-11 search error:', error);\n      return this.mockICD11Search(query, limit);\n    }\n  }\n\n  /**\n   * Get ICD-11 OAuth token\n   */\n  async getICD11Token() {\n    const tokenCacheKey = 'icd11_token';\n    const cached = this.cache.get(tokenCacheKey);\n    \n    if (cached && cached.expiresAt > Date.now()) {\n      return cached.token;\n    }\n\n    const response = await fetch(this.icd11Config.tokenUrl, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n      body: new URLSearchParams({\n        grant_type: 'client_credentials',\n        client_id: this.icd11Config.clientId,\n        client_secret: this.icd11Config.clientSecret,\n        scope: 'icdapi_access'\n      })\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to get ICD-11 token');\n    }\n\n    const data = await response.json();\n    \n    this.cache.set(tokenCacheKey, {\n      token: data.access_token,\n      expiresAt: Date.now() + (data.expires_in * 1000) - 60000\n    });\n\n    return data.access_token;\n  }\n\n  /**\n   * Search SNOMED CT via Snowstorm\n   */\n  async searchSNOMED(query, limit) {\n    try {\n      const localMapped = await this.searchLandingTerminology('snomed', query, limit);\n      if (localMapped.length > 0) {\n        return localMapped;\n      }\n    } catch (error) {\n      console.warn('Landing SNOMED search unavailable, falling back to Snowstorm:', error?.message || error);\n    }\n\n    const cacheKey = `snomed:${query}:${limit}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    try {\n      const response = await fetch(\n        `${this.snomedConfig.baseUrl}/MAIN/concepts?term=${encodeURIComponent(query)}&limit=${limit}&activeFilter=true`,\n        {\n          headers: { 'Accept': 'application/json' }\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`SNOMED API error: ${response.status}`);\n      }\n\n      const data = await response.json();\n      const results = (data.items || []).map(concept => ({\n        code: concept.conceptId,\n        display: concept.fsn?.term || concept.pt?.term,\n        displayShort: concept.pt?.term,\n        moduleId: concept.moduleId,\n        active: concept.active,\n        score: 0.9\n      }));\n\n      this.cache.set(cacheKey, results);\n      return results;\n    } catch (error) {\n      console.error('SNOMED search error:', error);\n      return this.mockSNOMEDSearch(query, limit);\n    }\n  }\n\n  /**\n   * Search LOINC via FHIR API\n   */\n  async searchLOINC(query, limit) {\n    const cacheKey = `loinc:${query}:${limit}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    try {\n      const response = await fetch(\n        `${this.loincConfig.baseUrl}/CodeSystem/$lookup?system=http://loinc.org&code=${encodeURIComponent(query)}`,\n        {\n          headers: { 'Accept': 'application/fhir+json' }\n        }\n      );\n\n      if (!response.ok) {\n        // Fall back to search\n        const searchResponse = await fetch(\n          `${this.loincConfig.baseUrl}/CodeSystem?_content=${encodeURIComponent(query)}&_count=${limit}`,\n          { headers: { 'Accept': 'application/fhir+json' } }\n        );\n        \n        if (!searchResponse.ok) {\n          throw new Error('LOINC search failed');\n        }\n        \n        const searchData = await searchResponse.json();\n        return this.parseFHIRBundle(searchData, 'loinc');\n      }\n\n      const data = await response.json();\n      const results = this.parseLOINCParameters(data);\n      \n      this.cache.set(cacheKey, results);\n      return results;\n    } catch (error) {\n      console.error('LOINC search error:', error);\n      return this.mockLOINCSearch(query, limit);\n    }\n  }\n\n  /**\n   * Search ICD-10-AM codes (local database)\n   */\n  async searchICD10AM(query, limit) {\n    // Will be expanded when ICD-10-AM is imported\n    return this.mockICD10Search(query, limit);\n  }\n\n  /**\n   * Search DRG codes (local database)\n   */\n  async searchDRG(query, limit) {\n    // Will be expanded when DRG is imported\n    return this.mockDRGSearch(query, limit);\n  }\n\n  /**\n   * Get cross-system mappings for a code\n   */\n  async getMappings(code, sourceSystem) {\n    const cacheKey = `mapping:${sourceSystem}:${code}`;\n    if (this.cache.has(cacheKey)) {\n      return this.cache.get(cacheKey);\n    }\n\n    const mappings = [];\n\n    // Check local mapping database\n    const localMappings = await this.getLocalMappings(code, sourceSystem);\n    mappings.push(...localMappings);\n\n    // Try external translation services\n    if (sourceSystem === 'snomed') {\n      const icdMappings = await this.translateSNOMEDtoICD(code);\n      mappings.push(...icdMappings);\n    }\n\n    this.cache.set(cacheKey, mappings);\n    return mappings;\n  }\n\n  /**\n   * Translate SNOMED to ICD-10\n   */\n  async translateSNOMEDtoICD(snomedCode) {\n    try {\n      const response = await fetch(\n        `${this.snomedConfig.fhirUrl}/ConceptMap/$translate?code=${snomedCode}&system=http://snomed.info/sct&target=http://hl7.org/fhir/sid/icd-10`,\n        { headers: { 'Accept': 'application/fhir+json' } }\n      );\n\n      if (!response.ok) return [];\n\n      const data = await response.json();\n      return this.parseTranslationResult(data);\n    } catch (error) {\n      console.error('SNOMED to ICD translation error:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get local mappings from database\n   */\n  async getLocalMappings(code, sourceSystem) {\n    try {\n      const params = new URLSearchParams({\n        sourceSystem,\n        code\n      });\n      const response = await fetch(`${this.landingApiBase}/api/terminology/mappings?${params.toString()}`);\n      if (!response.ok) return [];\n      const data = await response.json();\n      return (data.mappings || []).map(m => ({\n        system: m.system,\n        code: m.code,\n        display: m.display,\n        equivalence: m.equivalence || 'related',\n        confidence: m.confidence || 0.8\n      }));\n    } catch (error) {\n      console.warn('Local mapping lookup failed:', error?.message || error);\n      return [];\n    }\n  }\n\n  /**\n   * Parse FHIR Parameters for LOINC\n   */\n  parseLOINCParameters(params) {\n    const results = [];\n    const parameters = params.parameter || [];\n    \n    const code = parameters.find(p => p.name === 'code')?.valueCode;\n    const display = parameters.find(p => p.name === 'display')?.valueString;\n    \n    if (code) {\n      results.push({\n        code,\n        display,\n        score: 1.0\n      });\n    }\n    \n    return results;\n  }\n\n  /**\n   * Parse FHIR Bundle\n   */\n  parseFHIRBundle(bundle, system) {\n    const results = [];\n    const entries = bundle.entry || [];\n    \n    for (const entry of entries) {\n      if (entry.resource) {\n        results.push({\n          code: entry.resource.code || entry.resource.id,\n          display: entry.resource.display || entry.resource.name,\n          score: entry.search?.score || 0.5\n        });\n      }\n    }\n    \n    return results;\n  }\n\n  /**\n   * Parse translation result\n   */\n  parseTranslationResult(params) {\n    const mappings = [];\n    const result = params.parameter?.find(p => p.name === 'result')?.valueBoolean;\n    \n    if (!result) return mappings;\n\n    const matches = params.parameter?.filter(p => p.name === 'match') || [];\n    \n    for (const match of matches) {\n      const parts = match.part || [];\n      const equivalence = parts.find(p => p.name === 'equivalence')?.valueCoding?.code;\n      const concept = parts.find(p => p.name === 'concept')?.valueCoding;\n      \n      if (concept) {\n        mappings.push({\n          system: concept.system,\n          code: concept.code,\n          display: concept.display,\n          equivalence: equivalence || 'related',\n          confidence: equivalence === 'equivalent' ? 1.0 : 0.8\n        });\n      }\n    }\n    \n    return mappings;\n  }\n\n  // ============= MOCK DATA FOR DEVELOPMENT =============\n\n  mockICD11Search(query, limit) {\n    const mockData = [\n      { code: 'BA00', display: 'Essential hypertension', chapter: 'Cardiovascular' },\n      { code: 'BA01', display: 'Hypertensive heart disease', chapter: 'Cardiovascular' },\n      { code: '5A11', display: 'Type 2 diabetes mellitus', chapter: 'Endocrine' },\n      { code: '2A00', display: 'Acute appendicitis', chapter: 'Digestive' },\n      { code: 'CA40', display: 'Acute myocardial infarction', chapter: 'Cardiovascular' },\n      { code: 'KB23', display: 'Femoral neck fracture', chapter: 'Musculoskeletal' },\n      { code: 'DB90', display: 'Pneumonia', chapter: 'Respiratory' },\n      { code: 'FA01', display: 'Acute kidney failure', chapter: 'Genitourinary' }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.toLowerCase().includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.85 }));\n  }\n\n  mockSNOMEDSearch(query, limit) {\n    const mockData = [\n      { code: '38341003', display: 'Hypertensive disorder' },\n      { code: '73211009', display: 'Diabetes mellitus' },\n      { code: '74400008', display: 'Appendicitis' },\n      { code: '22298006', display: 'Myocardial infarction' },\n      { code: '71620000', display: 'Fracture of femoral neck' },\n      { code: '233604007', display: 'Pneumonia' },\n      { code: '14669001', display: 'Acute kidney failure' },\n      { code: '254837009', display: 'Malignant neoplasm of breast' }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.9 }));\n  }\n\n  mockLOINCSearch(query, limit) {\n    const mockData = [\n      { code: '2339-0', display: 'Glucose [Mass/volume] in Blood' },\n      { code: '2345-7', display: 'Glucose [Mass/volume] in Serum or Plasma' },\n      { code: '4548-4', display: 'Hemoglobin A1c/Hemoglobin.total in Blood' },\n      { code: '2093-3', display: 'Cholesterol [Mass/volume] in Serum or Plasma' },\n      { code: '2571-8', display: 'Triglyceride [Mass/volume] in Serum or Plasma' },\n      { code: '26453-1', display: 'Erythrocytes [#/volume] in Blood' },\n      { code: '26464-8', display: 'Leukocytes [#/volume] in Blood' },\n      { code: '38483-4', display: 'Creatinine [Mass/volume] in Blood' }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.85 }));\n  }\n\n  mockICD10Search(query, limit) {\n    const mockData = [\n      { code: 'I10', display: 'Essential (primary) hypertension' },\n      { code: 'E11.9', display: 'Type 2 diabetes mellitus without complications' },\n      { code: 'K35.80', display: 'Unspecified acute appendicitis' },\n      { code: 'I21.9', display: 'Acute myocardial infarction, unspecified' },\n      { code: 'S72.00', display: 'Fracture of unspecified part of neck of femur' },\n      { code: 'J18.9', display: 'Pneumonia, unspecified organism' },\n      { code: 'N17.9', display: 'Acute kidney failure, unspecified' },\n      { code: 'C50.9', display: 'Malignant neoplasm of breast, unspecified' }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.toLowerCase().includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.85 }));\n  }\n\n  mockDRGSearch(query, limit) {\n    const mockData = [\n      { code: 'DRG-194', display: 'Simple Pneumonia & Pleurisy w CC', weight: 0.9, avgLOS: 3.2 },\n      { code: 'DRG-195', display: 'Simple Pneumonia & Pleurisy w/o CC', weight: 0.6, avgLOS: 2.1 },\n      { code: 'DRG-470', display: 'Major Hip and Knee Joint Replacement', weight: 1.9, avgLOS: 2.5 },\n      { code: 'DRG-291', display: 'Heart Failure & Shock w MCC', weight: 1.5, avgLOS: 4.8 },\n      { code: 'DRG-292', display: 'Heart Failure & Shock w CC', weight: 1.0, avgLOS: 3.5 },\n      { code: 'DRG-340', display: 'Appendectomy w Complicated Principal Diag w MCC', weight: 2.8, avgLOS: 6.5 },\n      { code: 'DRG-341', display: 'Appendectomy w Complicated Principal Diag w CC', weight: 1.8, avgLOS: 4.2 },\n      { code: 'DRG-342', display: 'Appendectomy w Complicated Principal Diag w/o CC', weight: 1.2, avgLOS: 2.8 }\n    ];\n\n    const q = query.toLowerCase();\n    return mockData\n      .filter(d => d.display.toLowerCase().includes(q) || d.code.toLowerCase().includes(q))\n      .slice(0, limit)\n      .map(d => ({ ...d, score: 0.85 }));\n  }\n}\n\n// Export singleton\nexport const unifiedTerminology = new UnifiedTerminologyService();\n\n// Export class for testing\nexport { UnifiedTerminologyService };\n","import { useState, useMemo, useEffect } from 'react';\nimport { unifiedTerminology, CODE_SYSTEMS } from '../services/unifiedTerminologyService';\nimport { useToast } from '../components/Toast';\nimport { Card, CardBody, CardHeader } from '../components/ui/Card';\nimport { SectionHeader } from '../components/ui/SectionHeader';\nimport { Button } from '../components/ui/Button';\n\n/**\n * Premium Unified Code Browser\n * Multi-System Clinical Registry Explorer\n */\nexport function UnifiedCodeBrowser() {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedSystems, setSelectedSystems] = useState([]);\n  const [selectedCategory, setSelectedCategory] = useState('all');\n  const [results, setResults] = useState({ total: 0, results: [], systems: [] });\n  const [isSearching, setIsSearching] = useState(false);\n  const [selectedCode, setSelectedCode] = useState(null);\n  const [mappings, setMappings] = useState([]);\n  const [loadingMappings, setLoadingMappings] = useState(false);\n  const toast = useToast();\n\n  const allSystems = useMemo(() => Object.values(CODE_SYSTEMS), []);\n\n  useEffect(() => {\n    if (searchQuery.length < 2) {\n      setResults({ total: 0, results: [], systems: [] });\n      return;\n    }\n    const timer = setTimeout(async () => {\n      setIsSearching(true);\n      try {\n        const res = await unifiedTerminology.search(searchQuery, {\n          systems: selectedSystems.length > 0 ? selectedSystems : null,\n          category: selectedCategory !== 'all' ? selectedCategory : null,\n          limit: 50\n        });\n        setResults(res);\n      } finally {\n        setIsSearching(false);\n      }\n    }, 300);\n    return () => clearTimeout(timer);\n  }, [searchQuery, selectedSystems, selectedCategory]);\n\n  const toggleSystem = (id) => {\n    setSelectedSystems(prev => prev.includes(id) ? prev.filter(s => s !== id) : [...prev, id]);\n  };\n\n  const handleCodeSelect = async (code) => {\n    setSelectedCode(code);\n    setMappings([]);\n    setLoadingMappings(true);\n    try {\n      const m = await unifiedTerminology.getMappings(code.code, code.system);\n      setMappings(m);\n    } finally {\n      setLoadingMappings(false);\n    }\n  };\n\n  const copyCode = (code, system) => {\n    navigator.clipboard\n      .writeText(`${system}|${code}`)\n      .then(() => toast.success(`${system} code synchronized`))\n      .catch(() => toast.error('Clipboard access denied by browser'));\n  };\n\n  const getRegistryLink = (code) => {\n    const system = String(code?.system || '').toLowerCase();\n    const encoded = encodeURIComponent(code?.code || '');\n    if (system === 'sbs') return 'https://portal.nphies.sa';\n    if (system === 'icd11') return `https://icd.who.int/browse11/l-m/en?q=${encoded}`;\n    if (system === 'icd10am') return `https://www.who.int/standards/classifications/classification-of-diseases?q=${encoded}`;\n    if (system === 'snomed') return `https://browser.ihtsdotools.org/?perspective=full&conceptId1=${encoded}`;\n    if (system === 'loinc') return `https://loinc.org/search/?search=${encoded}`;\n    return `https://www.google.com/search?q=${encodeURIComponent(`${code?.systemName || 'healthcare code'} ${code?.code || ''}`)}`;\n  };\n\n  return (\n    <div className=\"flex-1 overflow-hidden bg-grid flex flex-col\">\n       <header className=\"flex-shrink-0 bg-gradient-to-r from-blue-50 via-white to-cyan-50 px-4 py-8 sm:px-8 sm:py-10 border-b border-slate-200/70 space-y-8 relative overflow-hidden\">\n          <div className=\"absolute top-0 right-0 p-12 opacity-5 pointer-events-none\">\n             <span className=\"material-symbols-outlined text-[200px] font-black\">hub</span>\n          </div>\n\n          <div className=\"relative z-10 flex flex-col md:flex-row md:items-end justify-between gap-8\">\n             <div className=\"space-y-4\">\n                <SectionHeader \n                  title=\"Unified Registry\" \n                  subtitle={`Autonomous search across ${allSystems.length} global healthcare systems.`}\n                  badge=\"Network Node\"\n                />\n             </div>\n             <div className=\"flex items-center gap-3\">\n                <div className=\"px-4 py-2 rounded-2xl bg-emerald-500/10 border border-emerald-500/20 text-emerald-600 text-[10px] font-black uppercase tracking-widest\">FHIR R4 Native</div>\n                <div className=\"px-4 py-2 rounded-2xl bg-blue-600/10 border border-blue-600/20 text-blue-600 text-[10px] font-black uppercase tracking-widest\">AI Enhanced</div>\n             </div>\n          </div>\n\n          <div className=\"relative z-10 space-y-6\">\n             <div className=\"relative group\">\n                <span className=\"absolute left-6 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500\">search</span>\n                <input\n                  type=\"text\" \n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  placeholder=\"Query across clinical ontologies (e.g. 'cardiology', 'glucose', 'I10')...\"\n                  className=\"w-full h-16 sm:h-20 bg-white border border-slate-200 rounded-[24px] sm:rounded-[32px] pl-14 sm:pl-16 pr-16 sm:pr-20 text-base sm:text-lg font-bold text-slate-900 placeholder:text-slate-500 focus:outline-none focus:border-blue-600/30 focus:ring-4 focus:ring-blue-600/10 transition-all shadow-sm\"\n                />\n                {isSearching && <div className=\"absolute right-8 top-1/2 -translate-y-1/2 size-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>}\n             </div>\n\n             <div className=\"flex flex-wrap gap-2\">\n                {allSystems.map(s => (\n                   <button \n                     key={s.id}\n                     onClick={() => toggleSystem(s.id)}\n                     className={`px-3 sm:px-5 py-2.5 rounded-2xl text-[10px] font-black uppercase tracking-widest border transition-all flex items-center gap-2 ${\n                       selectedSystems.includes(s.id) \n                         ? 'border-current shadow-lg shadow-current/20' \n                         : 'opacity-80 border-slate-200 text-slate-600 hover:border-slate-300'\n                     }`}\n                     style={{ color: selectedSystems.includes(s.id) ? s.color : undefined, backgroundColor: selectedSystems.includes(s.id) ? `${s.color}15` : 'white' }}\n                   >\n                      <span className=\"size-2 rounded-full\" style={{ backgroundColor: s.color }}></span>\n                      {s.name}\n                   </button>\n                ))}\n             </div>\n          </div>\n       </header>\n\n       <div className=\"flex-1 overflow-hidden flex\">\n          <div className=\"flex-1 overflow-y-auto px-8 sm:px-12 py-10 scrollbar-hide\">\n             <div className=\"max-w-[1200px] mx-auto space-y-6\">\n                {searchQuery.length < 2 ? (\n                   <section className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 animate-premium-in\">\n                      {allSystems.map(s => <SystemPill key={s.id} system={s} />)}\n                   </section>\n                ) : results.results.length > 0 ? (\n                   <div className=\"space-y-4 stagger-children\">\n                      {results.results.map((c, i) => (\n                         <UnifiedResultCard \n                           key={c.code + i} \n                           code={c} \n                           selected={selectedCode?.code === c.code}\n                           onClick={() => handleCodeSelect(c)}\n                         />\n                      ))}\n                   </div>\n                ) : (\n                   <div className=\"flex flex-col items-center justify-center py-40 opacity-40\">\n                      <span className=\"material-symbols-outlined text-[80px] font-black\">manage_search</span>\n                      <p className=\"text-sm font-black uppercase tracking-widest mt-6\">Registry Query Null</p>\n                   </div>\n                )}\n             </div>\n          </div>\n\n          {selectedCode && (\n             <aside className=\"w-[480px] bg-white dark:bg-slate-950 border-l border-slate-100 dark:border-slate-800 overflow-y-auto animate-premium-in shadow-2xl relative\">\n                <div className=\"p-12 space-y-12\">\n                   <div className=\"flex justify-between items-start\">\n                      <div className=\"space-y-2\">\n                         <div className=\"inline-flex px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest bg-blue-600/10 text-blue-600 border border-blue-600/20\">{selectedCode.systemName}</div>\n                         <h2 className=\"text-4xl font-black tracking-tighter text-slate-900 dark:text-white\">{selectedCode.code}</h2>\n                      </div>\n                      <button onClick={() => setSelectedCode(null)} className=\"p-3 rounded-2xl bg-slate-50 dark:bg-slate-900 text-slate-400\">\n                         <span className=\"material-symbols-outlined\">close</span>\n                      </button>\n                   </div>\n\n                   <div className=\"space-y-6\">\n                      <div className=\"space-y-2\">\n                         <p className=\"text-[10px] font-black uppercase tracking-widest text-slate-400\">Semantics</p>\n                         <p className=\"text-base font-bold text-slate-800 dark:text-gray-100 leading-relaxed italic\">\"{selectedCode.display}\"</p>\n                      </div>\n                      <div className=\"grid grid-cols-2 gap-4\">\n                         <InfoByte label=\"Status\" value=\"Active\" color=\"emerald\" />\n                         <InfoByte label=\"Auth Req\" value=\"Manual\" color=\"amber\" />\n                      </div>\n                   </div>\n\n                   <Card>\n                      <CardHeader title=\"System Bridging\" subtitle=\"Cross-system neural mappings.\" icon=\"lan\" />\n                      <CardBody className=\"p-0\">\n                         {loadingMappings ? (\n                            <div className=\"p-10 text-center\"><div className=\"size-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto\"></div></div>\n                         ) : (\n                            <div className=\"divide-y divide-slate-100 dark:divide-slate-800\">\n                               {mappings.map((m, i) => (\n                                  <div key={i} className=\"p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-colors\">\n                                     <div className=\"space-y-1\">\n                                        <p className=\"text-[9px] font-black uppercase tracking-widest text-slate-400\">{m.system}</p>\n                                        <p className=\"text-sm font-black text-blue-600 font-mono tracking-tight\">{m.code}</p>\n                                     </div>\n                                     <span className=\"text-[10px] font-black px-2 py-0.5 rounded-lg bg-emerald-500/10 text-emerald-500 border border-emerald-500/20\">{Math.round(m.confidence * 100)}% Match</span>\n                                  </div>\n                               ))}\n                            </div>\n                         )}\n                      </CardBody>\n                   </Card>\n\n                   <div className=\"space-y-4 py-4\">\n                      <Button\n                        className=\"w-full py-6 shadow-2xl shadow-blue-600/20\"\n                        icon=\"add_reaction\"\n                        onClick={() => {\n                          const payload = {\n                            source: 'unified-browser',\n                            system: selectedCode.system,\n                            systemName: selectedCode.systemName,\n                            code: selectedCode.code,\n                            description: selectedCode.display\n                          };\n                          window.localStorage.setItem('sbs_claim_context_code', JSON.stringify(payload));\n                          toast.success('Code context added and claim builder opened');\n                          window.dispatchEvent(new CustomEvent('sbs:navigate', { detail: { view: 'claim-builder' } }));\n                        }}\n                      >\n                        Add to Claim Context\n                      </Button>\n                      <Button\n                        variant=\"secondary\"\n                        className=\"w-full py-6\"\n                        icon=\"share\"\n                        onClick={() => {\n                          const url = getRegistryLink(selectedCode);\n                          window.open(url, '_blank', 'noopener,noreferrer');\n                          toast.info('Opened registry reference in a new tab');\n                        }}\n                      >\n                        Registry Deep-Link\n                      </Button>\n                   </div>\n                </div>\n             </aside>\n          )}\n       </div>\n    </div>\n  );\n}\n\nfunction SystemPill({ system }) {\n  return (\n    <Card className=\"hover:scale-[1.02] transition-transform\">\n       <CardBody className=\"p-8 space-y-4\">\n          <div className=\"size-12 rounded-2xl flex items-center justify-center text-2xl\" style={{ backgroundColor: `${system.color}15`, color: system.color }}>\n             <span className=\"material-symbols-outlined\">{system.icon}</span>\n          </div>\n          <div>\n             <h4 className=\"text-sm font-black text-slate-800 dark:text-white uppercase tracking-tight\">{system.name}</h4>\n             <p className=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest\">{system.count.toLocaleString()} Codes</p>\n          </div>\n       </CardBody>\n    </Card>\n  );\n}\n\nfunction UnifiedResultCard({ code, selected, onClick }) {\n  return (\n    <div \n      onClick={onClick}\n      className={`p-6 rounded-[28px] border-2 transition-all cursor-pointer flex items-center gap-6 ${\n        selected ? 'border-blue-600 bg-blue-600/5 shadow-2xl shadow-blue-600/10' : 'bg-white dark:bg-slate-950 border-slate-100 dark:border-slate-900 hover:border-slate-300 dark:hover:border-slate-700'\n      }`}\n    >\n       <div className=\"size-14 rounded-2xl flex items-center justify-center text-2xl shrink-0\" style={{ backgroundColor: `${code.systemColor}15`, color: code.systemColor }}>\n          <span className=\"material-symbols-outlined\">api</span>\n       </div>\n       <div className=\"flex-1 space-y-1\">\n          <div className=\"flex items-center gap-3\">\n             <span className=\"text-[10px] font-black uppercase tracking-widest px-2 py-0.5 rounded border border-current\" style={{ color: code.systemColor, backgroundColor: `${code.systemColor}10` }}>{code.systemName}</span>\n             <span className=\"text-lg font-black text-blue-600 font-mono tracking-tighter\">{code.code}</span>\n          </div>\n          <p className=\"text-sm font-bold text-slate-800 dark:text-gray-200 line-clamp-1 italic\">\"{code.display}\"</p>\n       </div>\n       <span className=\"material-symbols-outlined text-slate-300 group-hover:text-blue-600\">chevron_right</span>\n    </div>\n  );\n}\n\nfunction InfoByte({ label, value, color }) {\n  return (\n    <div className=\"p-5 rounded-2xl bg-slate-50 dark:bg-slate-900 border border-slate-100 dark:border-slate-800 space-y-1\">\n       <p className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">{label}</p>\n       <p className={`text-sm font-black ${color === 'emerald' ? 'text-emerald-500' : 'text-amber-500'}`}>{value}</p>\n    </div>\n  );\n}\n"],"file":"code-management-CsUnugPS.js"}