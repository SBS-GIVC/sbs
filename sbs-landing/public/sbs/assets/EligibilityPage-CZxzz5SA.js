import{r as n,j as e}from"./vendor-react-MVSD7VGK.js";import{n as $}from"./nphiesService-CN9naE0r.js";import{i as y,u as H}from"./main-DTZYqsTu.js";import{B as u}from"./Button-BDY0gMZ-.js";import{C as m,b as p,a as B}from"./Card-CNl4AdZD.js";import{S as M}from"./SectionHeader-BFZqpzku.js";import"./vendor-BW1Bdpst.js";function K({lang:t="en"}){const i=(y[t]||y.en).pages?.eligibility||y.en.pages.eligibility,[r,c]=n.useState(""),[N,w]=n.useState(""),[k,S]=n.useState(()=>new Date().toISOString().split("T")[0]),[h,I]=n.useState(!1),[a,C]=n.useState(null),[E,f]=n.useState(null),[F,A]=n.useState(!1),[T,g]=n.useState({patientId:!1}),[j,v]=n.useState(!1),d=H(),P=n.useRef(null),D=s=>{const l=String(s||"").trim();return l?/^[0-9]{10}$/.test(l)?null:i.validation.patientIdInvalid:i.validation.patientIdRequired},x=F||T.patientId?D(r):null,q=async()=>{A(!0);const s=D(r);if(s){g(l=>({...l,patientId:!0})),d.warning(s),P.current?.focus?.();return}I(!0),f(null);try{const l=await $.checkEligibility({patientId:r,insurerId:N||"",policyNumber:`POL-${r}`,serviceDate:k});C(l),v(!1),l.eligible?d.success(i.toast.eligible):d.error(i.toast.ineligible)}catch(l){const R=l?.message||i.toast.failed;f(R),d.error(R)}finally{I(!1)}},z=()=>{c(""),w(""),S(new Date().toISOString().split("T")[0]),C(null),f(null),v(!1),A(!1),g({patientId:!1})},O=s=>s==null?"N/A":new Intl.NumberFormat(t==="ar"?"ar-SA":"en-SA",{style:"currency",currency:"SAR",minimumFractionDigits:0}).format(s),U=s=>!s.allowed||s.allowed===0?0:Math.round(s.used/s.allowed*100);return e.jsx("div",{className:"flex-1",children:e.jsxs("main",{className:"max-w-[1200px] mx-auto p-6 sm:p-8 space-y-8 stagger-children",children:[e.jsxs("section",{className:"animate-premium-in",children:[e.jsx(M,{title:i.header.title,subtitle:i.header.subtitle,badge:i.header.badge}),e.jsx(m,{className:"mt-8 border-l-4 border-l-emerald-500",children:e.jsxs(p,{className:"p-8",children:[e.jsxs("form",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 items-end",onSubmit:s=>{s.preventDefault(),q()},children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"eligibility-patient-id",className:"text-xs font-bold text-slate-600 uppercase tracking-widest px-1",children:[i.fields.patientId," ",e.jsx("span",{"aria-hidden":"true",className:"text-rose-500",children:"*"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-600 transition-colors",children:"fingerprint"}),e.jsx("input",{ref:P,type:"text",id:"eligibility-patient-id",value:r,onChange:s=>c(s.target.value),onBlur:()=>g(s=>({...s,patientId:!0})),placeholder:i.placeholders.patientId,"data-testid":"eligibility-patient-id",inputMode:"numeric",pattern:"[0-9]{10}",required:!0,"aria-invalid":!!x,"aria-describedby":x?"eligibility-patient-id-error":void 0,className:`w-full pl-12 pr-4 py-3.5 bg-slate-50 dark:bg-slate-800/50 border rounded-2xl text-slate-900 dark:text-white font-bold focus:outline-none focus:ring-2 transition-all ${x?"border-rose-500/60 dark:border-rose-500/50 focus:ring-rose-500/20":"border-slate-200 dark:border-slate-700 focus:ring-blue-600/20"}`})]}),x&&e.jsx("p",{id:"eligibility-patient-id-error",role:"alert",className:"text-xs font-bold text-rose-600 px-1",children:x})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"eligibility-insurer",className:"text-xs font-bold text-slate-600 uppercase tracking-widest px-1",children:i.fields.insurer}),e.jsxs("div",{className:"relative group",children:[e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-600 transition-colors",children:"business"}),e.jsxs("select",{id:"eligibility-insurer",value:N,onChange:s=>w(s.target.value),"data-testid":"eligibility-insurer",className:"w-full pl-12 pr-4 py-3.5 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-2xl text-slate-900 dark:text-white font-bold focus:outline-none focus:ring-2 focus:ring-blue-600/20 appearance-none transition-all",children:[e.jsx("option",{value:"",children:i.insurerOptions.auto}),e.jsx("option",{value:"INS-BUPA",children:"Bupa Arabia"}),e.jsx("option",{value:"INS-TAWUNIYA",children:"Tawuniya"}),e.jsx("option",{value:"INS-MEDGULF",children:"MedGulf"}),e.jsx("option",{value:"INS-AXA",children:"GIG (Formerly AXA)"})]}),e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",children:"expand_more"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"eligibility-service-date",className:"text-xs font-bold text-slate-600 uppercase tracking-widest px-1",children:i.fields.serviceDate}),e.jsxs("div",{className:"relative group",children:[e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-600 transition-colors",children:"event"}),e.jsx("input",{type:"date",id:"eligibility-service-date",value:k,onChange:s=>S(s.target.value),"data-testid":"eligibility-service-date",className:"w-full pl-12 pr-4 py-3.5 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-2xl text-slate-900 dark:text-white font-bold focus:outline-none focus:ring-2 focus:ring-blue-600/20 transition-all"})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(u,{type:"submit",loading:h,icon:"verified","data-testid":"eligibility-verify",className:"w-full py-4 rounded-2xl",variant:"success",children:i.actions.verify}),e.jsx(u,{icon:"refresh",onClick:z,"data-testid":"eligibility-clear",className:"w-full py-3 rounded-2xl",variant:"secondary",disabled:h,children:i.actions.clear})]})]}),e.jsxs("p",{className:"mt-5 text-[11px] font-semibold text-slate-500 px-1",children:[i.consent," ",e.jsx("button",{type:"button",onClick:()=>window.dispatchEvent(new CustomEvent("sbs:navigate",{detail:{view:"privacy"}})),className:"underline underline-offset-4 hover:text-blue-600 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600/30 focus-visible:ring-offset-2 focus-visible:ring-offset-white",children:t==="ar"?"عرض الخصوصية":"View privacy"})]})]})})]}),e.jsxs("div",{className:"min-h-[400px]",children:[E&&e.jsxs("div",{className:"animate-premium-in p-6 rounded-3xl bg-rose-500/10 border border-rose-500/20 flex items-center gap-4",children:[e.jsx("div",{className:"size-12 rounded-2xl bg-rose-500 flex items-center justify-center text-white shadow-lg shadow-rose-500/20",children:e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined",children:"report"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-rose-600 dark:text-rose-400",children:t==="ar"?"فشل التحقق":"Verification Failed"}),e.jsx("p",{className:"text-sm text-rose-500/80 font-medium",children:E})]})]}),a?e.jsxs("div",{className:"space-y-8 animate-premium-in",children:[e.jsxs(m,{className:"overflow-hidden border-none shadow-2xl",children:[e.jsxs("div",{className:`p-8 flex flex-col sm:flex-row items-center justify-between gap-6 bg-gradient-to-r text-white ${a.eligible?"from-emerald-500 to-teal-600 shadow-emerald-500/20":"from-rose-500 to-orange-600 shadow-rose-500/20"}`,children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"size-20 rounded-[24px] bg-white/20 backdrop-blur-md flex items-center justify-center border border-white/20 shadow-xl",children:e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined text-5xl",children:a.eligible?"check_circle":"cancel"})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h2",{className:"text-3xl font-extrabold tracking-tighter leading-tight",children:a.eligible?t==="ar"?"المريض مؤهل":"Patient is Eligible":t==="ar"?"التغطية غير نشطة":"Coverage Inactive"}),e.jsxs("p",{className:"text-white/80 font-bold tracking-tight mt-1 flex items-center gap-2 justify-center sm:justify-start",children:[e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined text-sm",children:"policy"}),t==="ar"?"الوثيقة":"Policy",": ",a.policyNumber,e.jsx("span",{className:"mx-2 opacity-50",children:"|"}),t==="ar"?"الفئة":"Class",": ",a.className||(t==="ar"?"قياسي":"Standard")]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 justify-center sm:justify-start","data-testid":"eligibility-meta",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full bg-white/15 border border-white/15",children:["source: ",a.source||"—"]}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full bg-white/15 border border-white/15",children:typeof a.responseTimeMs=="number"?`${a.responseTimeMs}ms`:"—"}),a.requestId&&e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full bg-white/15 border border-white/15",children:["req: ",String(a.requestId).slice(-8)]})]})]})]}),e.jsxs("div",{className:"text-center sm:text-right bg-white/10 backdrop-blur-md p-4 rounded-2xl border border-white/10",children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-white/70",children:t==="ar"?"سارية حتى":"Coverage Valid Until"}),e.jsx("p",{className:"text-2xl font-black",children:a.coverageEnd||"—"})]})]}),e.jsxs(p,{className:"grid sm:grid-cols-3 gap-0 divide-y sm:divide-y-0 sm:divide-x divide-slate-200/50 dark:divide-slate-800/50 p-0",children:[e.jsxs("div",{className:"p-6 space-y-1",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:t==="ar"?"الجهة الدافعة":"Insurance Payer"}),e.jsx("p",{className:"text-lg font-extrabold text-slate-900 dark:text-white capitalize",children:a.payerName||"Detecting..."}),e.jsx("p",{className:"text-xs font-mono text-slate-400",children:a.payerId})]}),e.jsxs("div",{className:"p-6 space-y-1",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:t==="ar"?"المشاركة / التحمل":"Co-Payment / Deductible"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-extrabold text-slate-900 dark:text-white",children:[a.coPayPercentage||0,"%"]}),e.jsx("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full bg-blue-600/10 text-blue-600 border border-blue-600/20",children:t==="ar"?"حصة المريض":"Patient Share"})]}),e.jsxs("p",{className:"text-xs font-bold text-slate-400",children:[O(a.deductible)," ",t==="ar"?"إجمالي التحمل":"total deductible"]})]}),e.jsxs("div",{className:"p-6 space-y-1",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:t==="ar"?"نمط التحكيم":"Adjudication Mode"}),e.jsx("p",{className:"text-lg font-extrabold text-slate-900 dark:text-white",children:t==="ar"?"فوري (نفيس)":"Real-time (NPHIES)"}),e.jsxs("p",{className:"text-xs font-bold text-emerald-500 flex items-center gap-1",children:[e.jsx("span",{className:"size-1.5 rounded-full bg-emerald-500"}),t==="ar"?"الجسر الآمن نشط":"Secure Bridge Active"]})]})]})]}),e.jsxs(m,{children:[e.jsx(B,{title:t==="ar"?"تفاصيل مزايا التغطية":"Coverage Benefits Detail",subtitle:t==="ar"?"تفصيل الفئات النشطة والحدود المتبقية.":"Detailed breakdown of active benefit categories and remaining limits."}),e.jsx(p,{className:"space-y-6",children:Object.values(a.benefits||{}).length?Object.values(a.benefits||{}).map((s,l)=>e.jsx(V,{benefit:s,lang:t,formatCurrency:O,percentage:U(s)},l)):e.jsx("div",{className:"p-6 rounded-3xl bg-slate-50 dark:bg-slate-800/40 border border-slate-200/60 dark:border-slate-700/60",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-12 rounded-2xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-400",children:e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined",children:"info"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-extrabold text-slate-900 dark:text-white",children:t==="ar"?"لا توجد حدود منافع في الرد":"No benefit limits returned"}),e.jsx("div",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 mt-0.5",children:t==="ar"?"قد تتطلب هذه الجهة الدافعة استعلاماً إضافياً عن المنافع أو أن الاستجابة محدودة في هذه البيئة.":"This payer may require benefit inquiry, or the response is limited in this environment."})]})]})})})]}),e.jsxs(m,{children:[e.jsx(B,{title:t==="ar"?"أدلة التحقق":"Verification Evidence",subtitle:t==="ar"?"مخرجات للتدقيق والتتبع واستكشاف الأخطاء.":"Operator-grade output for audits, debugging, and downstream automation."}),e.jsxs(p,{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(u,{variant:"secondary",icon:"content_copy",onClick:async()=>{try{await navigator.clipboard.writeText(JSON.stringify(a,null,2)),d.success(t==="ar"?"تم نسخ JSON":"Eligibility JSON copied")}catch{d.error(t==="ar"?"فشل النسخ (الحافظة غير متاحة)":"Copy failed (clipboard not available)")}},"data-testid":"eligibility-copy-json",children:t==="ar"?"نسخ JSON":"Copy JSON"}),e.jsx(u,{variant:"secondary",icon:j?"visibility_off":"visibility",onClick:()=>v(s=>!s),"data-testid":"eligibility-toggle-raw",children:j?t==="ar"?"إخفاء الخام":"Hide Raw":t==="ar"?"عرض الخام":"Show Raw"})]}),j&&e.jsx("pre",{"data-testid":"eligibility-raw",className:"text-xs font-mono p-4 rounded-3xl bg-slate-950 text-slate-100 overflow-auto border border-slate-800/70",style:{maxHeight:380},children:JSON.stringify(a,null,2)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(b,{icon:"add_box",label:t==="ar"?"إنشاء مطالبة":"Create Claim",sub:t==="ar"?"استخدم نتيجة الاستحقاق الحالية":"Use current eligibility",onClick:()=>window.dispatchEvent(new CustomEvent("sbs:navigate",{detail:{view:"claim-builder"}}))}),e.jsx(b,{icon:"approval",label:t==="ar"?"طلب موافقة":"Request Auth",sub:t==="ar"?"بوابة الموافقة المسبقة":"Pre-approval portal",onClick:()=>window.dispatchEvent(new CustomEvent("sbs:navigate",{detail:{view:"prior-auth"}}))}),e.jsx(b,{icon:"print",label:t==="ar"?"طباعة الملخص":"Print Summary",sub:t==="ar"?"تصدير PDF":"Generate PDF export",onClick:()=>window.print()}),e.jsx(b,{icon:"history",label:t==="ar"?"سجل التحقق":"Verify History",sub:t==="ar"?"مراجعة الجلسات السابقة":"Audit older sessions",onClick:()=>{d.info(t==="ar"?"فتح سجلات الاستحقاق السابقة":"Opening historical eligibility sessions"),window.dispatchEvent(new CustomEvent("sbs:navigate",{detail:{view:"claims"}}))}})]})]}):!h&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 animate-premium-in",children:[e.jsx("div",{className:"size-24 rounded-[32px] bg-slate-50 dark:bg-slate-800/50 flex items-center justify-center text-slate-300 dark:text-slate-600 mb-6",children:e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined text-6xl",children:"person_search"})}),e.jsx("h3",{className:"text-xl font-extrabold text-slate-900 dark:text-white tracking-tight",children:t==="ar"?"جاهز للتحقق":"Ready for Verification"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium mt-1 max-w-xs text-center",children:t==="ar"?"أدخل رقم الهوية الوطنية أو الإقامة لبدء التحقق الفوري من الاستحقاق.":"Enter a Patient National ID or Iqama number to begin the real-time eligibility check."})]})]})]})})}function V({benefit:t,lang:o,formatCurrency:i,percentage:r}){const c=r>85;return e.jsxs("div",{className:"space-y-2 group",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${c?"bg-rose-500/10 text-rose-600":"bg-blue-600/10 text-blue-600"}`,children:e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined text-[20px]",children:"medical_services"})}),e.jsx("span",{className:"text-sm font-extrabold text-slate-700 dark:text-slate-200 capitalize group-hover:text-blue-600 transition-colors",children:t.name||t.category})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-black text-slate-900 dark:text-white",children:i(t.remaining)}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest",children:o==="ar"?"الحد المتبقي":"Remaining Limit"})]})]}),e.jsx("div",{className:"relative h-2.5 bg-slate-100 dark:bg-slate-800/50 rounded-full overflow-hidden shadow-inner font-bold",children:e.jsx("div",{className:`absolute inset-y-0 left-0 rounded-full transition-all duration-1000 cubic-bezier(0.16, 1, 0.3, 1) ${c?"bg-gradient-to-r from-rose-500 to-orange-500":"bg-gradient-to-r from-blue-600 to-indigo-600"}`,style:{width:`${r}%`},children:e.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})})}),e.jsxs("div",{className:"flex justify-between items-center text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest",children:[e.jsxs("span",{children:[o==="ar"?"المستخدم":"Used",": ",i(t.used)," (",r,"%)"]}),e.jsxs("span",{children:[o==="ar"?"الحد السنوي":"Annual Limit",": ",i(t.allowed)]})]})]})}function b({icon:t,label:o,sub:i,onClick:r}){return e.jsxs("button",{onClick:r,className:"glass-card p-5 rounded-3xl border border-slate-200/50 dark:border-slate-800/50 hover:border-blue-600/50 transition-all duration-300 flex flex-col items-center gap-3 group text-center",children:[e.jsx("div",{className:"size-12 rounded-2xl bg-slate-50 dark:bg-slate-800 text-slate-400 group-hover:bg-blue-600 group-hover:text-white group-hover:scale-110 transition-all duration-300 flex items-center justify-center",children:e.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined text-2xl",children:t})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-extrabold text-slate-900 dark:text-white tracking-tight",children:o}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest mt-0.5",children:i})]})]})}export{K as EligibilityPage};
//# sourceMappingURL=EligibilityPage-CZxzz5SA.js.map
