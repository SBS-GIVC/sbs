{"version":3,"file":"MappingRulesConfig-BCUgpC-P.js","sources":["../../src/pages/MappingRulesConfig.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { Card, CardBody, CardHeader } from '../components/ui/Card';\nimport { SectionHeader } from '../components/ui/SectionHeader';\nimport { Button } from '../components/ui/Button';\nimport { APIService } from '../services/apiService';\nimport { useToast } from '../components/Toast';\nimport { i18n } from '../utils/i18n';\n\nconst DEFAULT_CONFIG = {\n  autoAcceptMarker: 0.85,\n  reviewTrigger: 0.5,\n  fuzzyNormalization: true,\n  universalSbsPriority: true,\n  strictIcd10Enforcement: false\n};\n\n/**\n * Premium Mapping Rules Configuration\n * Live governance editor backed by `/api/mappings/config` + `/api/mappings/overrides`.\n */\nexport function MappingRulesConfig({ lang = 'en' }) {\n  const toast = useToast();\n  const copy = i18n[lang] || i18n.en;\n  const t = copy.pages?.mappingRules || i18n.en.pages.mappingRules;\n\n  const [config, setConfig] = useState(DEFAULT_CONFIG);\n  const [loadingConfig, setLoadingConfig] = useState(true);\n  const [savingConfig, setSavingConfig] = useState(false);\n\n  const [overrides, setOverrides] = useState([]);\n  const [loadingOverrides, setLoadingOverrides] = useState(true);\n  const [overrideEditorOpen, setOverrideEditorOpen] = useState(false);\n  const [overrideDraft, setOverrideDraft] = useState({\n    facility_id: '1',\n    internal_code: '',\n    sbs_code: '',\n    description: '',\n    confidence: '1',\n    notes: ''\n  });\n  const [savingOverride, setSavingOverride] = useState(false);\n\n  const [sim, setSim] = useState({\n    facility_id: '1',\n    internal_code: 'TEST_CODE',\n    description: 'Appendectomy removal with complications',\n    loading: false,\n    result: null\n  });\n\n  const autoPct = Math.round((Number(config.autoAcceptMarker || 0) || 0) * 100);\n  const reviewPct = Math.round((Number(config.reviewTrigger || 0) || 0) * 100);\n  const autoWindowPct = Math.max(reviewPct, autoPct - 1);\n\n  const decisionKey = useMemo(() => {\n    const conf = Number(sim?.result?.confidenceRatio || 0);\n    if (conf >= Number(config.autoAcceptMarker || 0.85)) return 'autoAccepted';\n    if (conf >= Number(config.reviewTrigger || 0.5)) return 'reviewRequired';\n    return 'rejected';\n  }, [sim?.result, config]);\n\n  const decisionLabel = t.simulator.decisions[decisionKey] || decisionKey;\n\n  const refreshConfig = async () => {\n    setLoadingConfig(true);\n    try {\n      const data = await APIService.getMappingConfig();\n      if (!data?.success) throw new Error(data?.error || 'Failed to load config');\n      setConfig({ ...DEFAULT_CONFIG, ...(data.config || {}) });\n    } catch (e) {\n      toast.warning(e?.message || t.toast.loadConfigFailed);\n    } finally {\n      setLoadingConfig(false);\n    }\n  };\n\n  const refreshOverrides = async () => {\n    setLoadingOverrides(true);\n    try {\n      const data = await APIService.listMappingOverrides();\n      if (!data?.success) throw new Error(data?.error || 'Failed to load overrides');\n      setOverrides(Array.isArray(data.overrides) ? data.overrides : []);\n    } catch (e) {\n      toast.warning(e?.message || t.toast.loadOverridesFailed);\n      setOverrides([]);\n    } finally {\n      setLoadingOverrides(false);\n    }\n  };\n\n  useEffect(() => {\n    refreshConfig();\n    refreshOverrides();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleSaveConfig = async () => {\n    setSavingConfig(true);\n    try {\n      const payload = {\n        autoAcceptMarker: config.autoAcceptMarker,\n        reviewTrigger: config.reviewTrigger,\n        fuzzyNormalization: !!config.fuzzyNormalization,\n        universalSbsPriority: !!config.universalSbsPriority,\n        strictIcd10Enforcement: !!config.strictIcd10Enforcement\n      };\n      const result = await APIService.updateMappingConfig(payload);\n      if (!result?.success) throw new Error(result?.error || 'Save failed');\n      setConfig({ ...DEFAULT_CONFIG, ...(result.config || payload) });\n      toast.success(t.toast.profileSaved);\n    } catch (e) {\n      toast.error(e?.message || t.toast.saveConfigFailed);\n    } finally {\n      setSavingConfig(false);\n    }\n  };\n\n  const handleReset = async () => {\n    setConfig(DEFAULT_CONFIG);\n    toast.info(t.toast.defaultStaged);\n  };\n\n  const handleAddOverride = async () => {\n    const internal_code = String(overrideDraft.internal_code || '').trim();\n    const sbs_code = String(overrideDraft.sbs_code || '').trim();\n    const facility_id = Number(overrideDraft.facility_id || 1);\n    const confidence = Number(overrideDraft.confidence || 1);\n\n    if (!internal_code || !sbs_code) {\n      toast.error(t.toast.overrideRequired);\n      return;\n    }\n\n    setSavingOverride(true);\n    try {\n      const payload = {\n        facility_id: Number.isFinite(facility_id) && facility_id > 0 ? facility_id : 1,\n        internal_code,\n        sbs_code,\n        description: String(overrideDraft.description || '').trim() || null,\n        confidence: Number.isFinite(confidence) ? confidence : 1,\n        notes: String(overrideDraft.notes || '').trim() || null\n      };\n      const result = await APIService.createMappingOverride(payload);\n      if (!result?.success) throw new Error(result?.error || 'Failed to save override');\n      toast.success(t.toast.overrideSaved);\n      setOverrideDraft({ facility_id: '1', internal_code: '', sbs_code: '', description: '', confidence: '1', notes: '' });\n      setOverrideEditorOpen(false);\n      await refreshOverrides();\n    } catch (e) {\n      toast.error(e?.message || t.toast.overrideSaveFailed);\n    } finally {\n      setSavingOverride(false);\n    }\n  };\n\n  const handleDeleteOverride = async (row) => {\n    try {\n      await APIService.deleteMappingOverride(String(row.internal_code || ''), Number(row.facility_id || 1));\n      toast.success(t.toast.overrideDeleted);\n      await refreshOverrides();\n    } catch (e) {\n      toast.error(e?.message || t.toast.deleteFailed);\n    }\n  };\n\n  const handleSimulate = async () => {\n    const internal_code = String(sim.internal_code || '').trim();\n    if (!internal_code) {\n      toast.error(t.toast.internalCodeRequired);\n      return;\n    }\n\n    setSim((prev) => ({ ...prev, loading: true }));\n    try {\n      const facility_id = Number(sim.facility_id || 1);\n      const data = await APIService.normalizeCode(internal_code, String(sim.description || '').trim(), Number.isFinite(facility_id) ? facility_id : 1);\n      const mappedCode = String(data?.sbs_mapped_code || data?.sbs_code || internal_code).trim();\n      const mappedDesc = String(data?.official_description || data?.description || '').trim();\n      const confidenceRatio = Math.max(0, Math.min(1, Number(data?.confidence || 0) || 0));\n      const mappingSource = String(data?.mapping_source || 'normalizer');\n      setSim((prev) => ({\n        ...prev,\n        loading: false,\n        result: {\n          mappedCode,\n          mappedDesc,\n          confidenceRatio,\n          confidencePct: Math.round(confidenceRatio * 100),\n          mappingSource\n        }\n      }));\n    } catch (e) {\n      setSim((prev) => ({\n        ...prev,\n        loading: false,\n        result: {\n          mappedCode: t.simulator.resolutionError,\n          mappedDesc: '',\n          confidenceRatio: 0,\n          confidencePct: 0,\n          mappingSource: 'error'\n        }\n      }));\n    }\n  };\n\n  return (\n    <div className=\"flex-1\">\n      <main className=\"max-w-[1400px] mx-auto p-6 sm:p-8 space-y-8 stagger-children\">\n        <section className=\"animate-premium-in\">\n          <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6\">\n            <SectionHeader\n              title={t.header.title}\n              subtitle={t.header.subtitle}\n              badge={loadingConfig ? t.header.badgeLoading : t.header.badgeLive}\n            />\n            <div className=\"flex gap-3\">\n              <Button\n                variant=\"secondary\"\n                icon=\"history\"\n                onClick={() => toast.info(t.toast.versionHistoryUnavailable)}\n              >\n                {t.actions.versionHistory}\n              </Button>\n              <Button variant=\"secondary\" icon=\"restore\" onClick={handleReset} data-testid=\"mappingrules-reset\">\n                {t.actions.reset}\n              </Button>\n              <Button icon=\"save\" loading={savingConfig} onClick={handleSaveConfig} data-testid=\"mappingrules-save\">\n                {t.actions.save}\n              </Button>\n            </div>\n          </div>\n        </section>\n\n        <div className=\"grid lg:grid-cols-12 gap-8\">\n          <div className=\"lg:col-span-5 space-y-8 animate-premium-in\" style={{ animationDelay: '100ms' }}>\n            <Card>\n              <CardHeader title={t.thresholds.title} subtitle={t.thresholds.subtitle} />\n              <CardBody className=\"space-y-10 py-6\">\n                <ConfigSlider\n                  testId=\"mappingrules-autoaccept\"\n                  unit=\"%\"\n                  label={t.thresholds.autoAccept.label}\n                  val={autoPct}\n                  min={60}\n                  max={99}\n                  color=\"emerald\"\n                  hint={t.thresholds.autoAccept.hint}\n                  onChange={(pct) => setConfig((prev) => ({ ...prev, autoAcceptMarker: clamp01(pct / 100) }))}\n                />\n                <ConfigSlider\n                  testId=\"mappingrules-reviewtrigger\"\n                  unit=\"%\"\n                  label={t.thresholds.reviewTrigger.label}\n                  val={reviewPct}\n                  min={0}\n                  max={95}\n                  color=\"amber\"\n                  hint={t.thresholds.reviewTrigger.hint}\n                  onChange={(pct) => setConfig((prev) => ({ ...prev, reviewTrigger: clamp01(pct / 100) }))}\n                />\n\n                <div className=\"p-6 bg-blue-600/5 rounded-[28px] border border-blue-600/10 flex gap-4\">\n                  <span className=\"material-symbols-outlined text-blue-600 font-black\">info</span>\n                  <p className=\"text-xs font-bold text-slate-500 leading-relaxed\">\n                    {t.thresholds.infoTemplate\n                      .replace('{review}', String(reviewPct))\n                      .replace('{auto}', String(autoWindowPct))}\n                  </p>\n                </div>\n              </CardBody>\n            </Card>\n\n            <Card>\n              <CardHeader title={t.heuristics.title} subtitle={t.heuristics.subtitle} />\n              <CardBody className=\"p-0\">\n                <ToggleRule\n                  testId=\"mappingrules-toggle-fuzzy\"\n                  label={t.heuristics.toggles.fuzzy.label}\n                  sub={t.heuristics.toggles.fuzzy.desc}\n                  active={!!config.fuzzyNormalization}\n                  onToggle={() => setConfig((prev) => ({ ...prev, fuzzyNormalization: !prev.fuzzyNormalization }))}\n                  lang={lang}\n                />\n                <ToggleRule\n                  testId=\"mappingrules-toggle-universal\"\n                  label={t.heuristics.toggles.universal.label}\n                  sub={t.heuristics.toggles.universal.desc}\n                  active={!!config.universalSbsPriority}\n                  onToggle={() => setConfig((prev) => ({ ...prev, universalSbsPriority: !prev.universalSbsPriority }))}\n                  lang={lang}\n                />\n                <ToggleRule\n                  testId=\"mappingrules-toggle-icd10\"\n                  label={t.heuristics.toggles.icd10.label}\n                  sub={t.heuristics.toggles.icd10.desc}\n                  active={!!config.strictIcd10Enforcement}\n                  onToggle={() => setConfig((prev) => ({ ...prev, strictIcd10Enforcement: !prev.strictIcd10Enforcement }))}\n                  lang={lang}\n                />\n              </CardBody>\n            </Card>\n          </div>\n\n          <div className=\"lg:col-span-7 space-y-8 animate-premium-in\" style={{ animationDelay: '200ms' }}>\n            <Card className=\"flex flex-col\">\n              <CardHeader\n                title={t.overrides.title}\n                subtitle={t.overrides.subtitle}\n                action={\n                  <Button\n                    variant=\"secondary\"\n                    size=\"sm\"\n                    icon=\"add\"\n                    data-testid=\"mappingrules-open-override-editor\"\n                    onClick={() => setOverrideEditorOpen((v) => !v)}\n                  >\n                    {t.overrides.add}\n                  </Button>\n                }\n              />\n              <CardBody className=\"p-0\">\n                {overrideEditorOpen && (\n                  <div className=\"p-6 border-b border-slate-100 dark:border-slate-800 bg-slate-50/40 dark:bg-slate-900/20\">\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                      <Field label={t.overrides.editor.facilityId}>\n                        <input\n                          className=\"w-full bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-2xl px-4 py-3 text-sm font-bold\"\n                          data-testid=\"mappingrules-override-facility\"\n                          value={overrideDraft.facility_id}\n                          onChange={(e) => setOverrideDraft((p) => ({ ...p, facility_id: e.target.value }))}\n                        />\n                      </Field>\n                      <Field label={t.overrides.editor.confidence}>\n                        <input\n                          className=\"w-full bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-2xl px-4 py-3 text-sm font-bold\"\n                          data-testid=\"mappingrules-override-confidence\"\n                          value={overrideDraft.confidence}\n                          onChange={(e) => setOverrideDraft((p) => ({ ...p, confidence: e.target.value }))}\n                        />\n                      </Field>\n                      <Field label={t.overrides.editor.internalCode}>\n                        <input\n                          className=\"w-full bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-2xl px-4 py-3 text-sm font-black font-mono text-blue-600\"\n                          data-testid=\"mappingrules-override-internal\"\n                          value={overrideDraft.internal_code}\n                          onChange={(e) => setOverrideDraft((p) => ({ ...p, internal_code: e.target.value }))}\n                        />\n                      </Field>\n                      <Field label={t.overrides.editor.mappedSbsCode}>\n                        <input\n                          className=\"w-full bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-2xl px-4 py-3 text-sm font-black font-mono text-blue-600\"\n                          data-testid=\"mappingrules-override-sbs\"\n                          value={overrideDraft.sbs_code}\n                          onChange={(e) => setOverrideDraft((p) => ({ ...p, sbs_code: e.target.value }))}\n                        />\n                      </Field>\n                      <Field label={t.overrides.editor.description}>\n                        <input\n                          className=\"w-full bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-2xl px-4 py-3 text-sm font-bold\"\n                          data-testid=\"mappingrules-override-description\"\n                          value={overrideDraft.description}\n                          onChange={(e) => setOverrideDraft((p) => ({ ...p, description: e.target.value }))}\n                        />\n                      </Field>\n                      <Field label={t.overrides.editor.notes}>\n                        <input\n                          className=\"w-full bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-2xl px-4 py-3 text-sm font-bold\"\n                          data-testid=\"mappingrules-override-notes\"\n                          value={overrideDraft.notes}\n                          onChange={(e) => setOverrideDraft((p) => ({ ...p, notes: e.target.value }))}\n                        />\n                      </Field>\n                    </div>\n                    <div className=\"mt-4 flex justify-end gap-3\">\n                      <Button\n                        variant=\"secondary\"\n                        icon=\"close\"\n                        onClick={() => setOverrideEditorOpen(false)}\n                      >\n                        {t.overrides.editor.cancel}\n                      </Button>\n                      <Button\n                        icon=\"verified\"\n                        loading={savingOverride}\n                        data-testid=\"mappingrules-override-save\"\n                        onClick={handleAddOverride}\n                      >\n                        {t.overrides.editor.save}\n                      </Button>\n                    </div>\n                  </div>\n                )}\n\n                <div className=\"overflow-x-auto\">\n                  <table data-testid=\"mappingrules-overrides-table\" className=\"w-full text-left\">\n                    <thead className=\"bg-slate-50 dark:bg-slate-900/40\">\n                      <tr>\n                        <th className=\"px-6 py-4 text-[10px] font-black uppercase text-slate-500\">{t.overrides.table.facility}</th>\n                        <th className=\"px-6 py-4 text-[10px] font-black uppercase text-slate-500\">{t.overrides.table.internal}</th>\n                        <th className=\"px-6 py-4 text-[10px] font-black uppercase text-slate-500\">{t.overrides.table.sbs}</th>\n                        <th className=\"px-6 py-4 text-[10px] font-black uppercase text-slate-500 text-right\">{t.overrides.table.conf}</th>\n                        <th className=\"px-6 py-4\"></th>\n                      </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-slate-100 dark:divide-slate-800\">\n                      {loadingOverrides ? (\n                        <tr>\n                          <td className=\"px-6 py-10 text-center text-xs font-bold text-slate-400\" colSpan={5}>\n                            {t.overrides.table.loading}\n                          </td>\n                        </tr>\n                      ) : overrides.length === 0 ? (\n                        <tr>\n                          <td className=\"px-6 py-10 text-center text-xs font-bold text-slate-400\" colSpan={5}>\n                            {t.overrides.table.empty}\n                          </td>\n                        </tr>\n                      ) : (\n                        overrides.map((o) => (\n                          <OverrideRow\n                            key={`${o.facility_id}|${o.internal_code}`}\n                            row={o}\n                            onDelete={() => handleDeleteOverride(o)}\n                            t={t}\n                          />\n                        ))\n                      )}\n                    </tbody>\n                  </table>\n                </div>\n              </CardBody>\n            </Card>\n\n            <Card className=\"bg-slate-900 text-white overflow-hidden relative\">\n              <div className=\"absolute top-0 right-0 p-8 opacity-10 pointer-events-none\">\n                <span className=\"material-symbols-outlined text-[100px] font-black\">biotech</span>\n              </div>\n              <CardHeader title={t.simulator.title} subtitle={t.simulator.subtitle} />\n              <CardBody className=\"space-y-8\">\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\n                  <Field label={t.simulator.fields.facilityId}>\n                    <input\n                      className=\"w-full bg-slate-950/50 border border-white/10 rounded-2xl px-4 py-3 text-sm font-bold text-white focus:outline-none\"\n                      data-testid=\"mappingrules-sim-facility\"\n                      value={sim.facility_id}\n                      onChange={(e) => setSim((p) => ({ ...p, facility_id: e.target.value }))}\n                    />\n                  </Field>\n                  <Field label={t.simulator.fields.internalCode}>\n                    <input\n                      className=\"w-full bg-slate-950/50 border border-white/10 rounded-2xl px-4 py-3 text-sm font-black font-mono text-white focus:outline-none\"\n                      data-testid=\"mappingrules-sim-internal\"\n                      value={sim.internal_code}\n                      onChange={(e) => setSim((p) => ({ ...p, internal_code: e.target.value }))}\n                    />\n                  </Field>\n                  <Field label={t.simulator.fields.description}>\n                    <input\n                      className=\"w-full bg-slate-950/50 border border-white/10 rounded-2xl px-4 py-3 text-sm font-bold text-white focus:outline-none\"\n                      data-testid=\"mappingrules-sim-description\"\n                      value={sim.description}\n                      onChange={(e) => setSim((p) => ({ ...p, description: e.target.value }))}\n                      placeholder={t.simulator.fields.descriptionPlaceholder}\n                    />\n                  </Field>\n                </div>\n\n                <div className=\"flex justify-end\">\n                  <Button\n                    loading={sim.loading}\n                    icon=\"play_arrow\"\n                    className=\"py-3.5 px-8\"\n                    data-testid=\"mappingrules-simulate\"\n                    onClick={handleSimulate}\n                  >\n                    {t.simulator.actions.simulate}\n                  </Button>\n                </div>\n\n                <div className=\"glass-panel p-8 rounded-[32px] border border-white/5 relative overflow-hidden flex flex-col sm:flex-row gap-8\">\n                  <div className={`absolute left-0 top-0 bottom-0 w-2 ${decisionKey === 'autoAccepted' ? 'bg-emerald-500' : decisionKey === 'reviewRequired' ? 'bg-amber-500' : 'bg-rose-500'}`}></div>\n                  <div className=\"flex-1 space-y-2\">\n                    <p className=\"text-[10px] font-black uppercase tracking-widest text-slate-500\">{t.simulator.output.predicted}</p>\n                    <h4 className={`text-2xl font-black tracking-tight ${sim.loading ? 'animate-pulse opacity-50' : ''}`} data-testid=\"mappingrules-sim-mapped\">\n                      {sim.result?.mappedCode || '—'}\n                    </h4>\n                    <p className=\"text-[11px] font-bold text-slate-300/80\" data-testid=\"mappingrules-sim-source\">\n                      {t.simulator.output.sourceLabel}: {sim.result?.mappingSource || '—'}\n                    </p>\n                  </div>\n                  <div className=\"text-center sm:text-right space-y-2\">\n                    <p className=\"text-[10px] font-black uppercase tracking-widest text-slate-500\">{t.simulator.output.confidenceLabel}</p>\n                    <h4 className={`text-3xl font-black tracking-tighter ${decisionKey === 'autoAccepted' ? 'text-emerald-500' : decisionKey === 'reviewRequired' ? 'text-amber-500' : 'text-rose-500'}`} data-testid=\"mappingrules-sim-confidence\">\n                      {sim.result ? `${sim.result.confidencePct}%` : '—'}\n                    </h4>\n                  </div>\n                </div>\n\n                <div className=\"flex justify-center\">\n                  <span className={`text-[10px] font-black uppercase tracking-widest px-4 py-2 rounded-full border border-white/10 ${decisionKey === 'autoAccepted' ? 'text-emerald-500 bg-emerald-500/5' : decisionKey === 'reviewRequired' ? 'text-amber-500 bg-amber-500/5' : 'text-rose-500 bg-rose-500/5'}`} data-testid=\"mappingrules-sim-decision\">\n                    {t.simulator.output.resultLabel}: {decisionLabel}\n                  </span>\n                </div>\n              </CardBody>\n            </Card>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n\nfunction clamp01(n) {\n  const x = Number(n);\n  if (!Number.isFinite(x)) return 0;\n  return Math.max(0, Math.min(1, x));\n}\n\nfunction Field({ label, children }) {\n  return (\n    <div className=\"space-y-1\">\n      <label className=\"text-[10px] font-black uppercase tracking-widest text-slate-500\" style={{ marginInlineStart: '0.25rem' }}>\n        {label}\n      </label>\n      {children}\n    </div>\n  );\n}\n\nfunction ConfigSlider({ testId, label, val, min, max, color, unit, hint, onChange }) {\n  const themes = {\n    emerald: 'accent-emerald-500 text-emerald-600',\n    amber: 'accent-amber-500 text-amber-600'\n  };\n  const theme = themes[color] || themes.emerald;\n  const pct = Number.isFinite(Number(val)) ? Number(val) : 0;\n  return (\n    <div className=\"space-y-4\" data-testid={testId}>\n      <div className=\"flex justify-between items-end\">\n        <div className=\"space-y-1\">\n          <label className=\"text-sm font-black text-slate-800 dark:text-gray-100 leading-none\">{label}</label>\n          <p className=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest\">{hint}</p>\n        </div>\n        <span className={`text-xl font-black ${theme.split(' ')[1]}`}>{pct}{unit}</span>\n      </div>\n      <input\n        type=\"range\"\n        className={`w-full h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full appearance-none transition-all ${theme.split(' ')[0]}`}\n        min={min}\n        max={max}\n        value={pct}\n        onChange={(e) => onChange?.(Number(e.target.value))}\n      />\n    </div>\n  );\n}\n\nfunction ToggleRule({ testId, label, sub, active, onToggle, lang = 'en' }) {\n  const copy = i18n[lang] || i18n.en;\n  return (\n    <button\n      type=\"button\"\n      data-testid={testId}\n      onClick={onToggle}\n      role=\"switch\"\n      aria-checked={!!active}\n      aria-label={`${label}: ${active ? copy.common.on : copy.common.off}`}\n      className=\"w-full text-left flex items-center justify-between px-8 py-5 border-b border-slate-100 dark:border-slate-800 last:border-0 hover:bg-slate-50/50 dark:hover:bg-slate-800/20 transition-colors\"\n    >\n      <div className=\"space-y-1\">\n        <h4 className=\"text-sm font-bold text-slate-800 dark:text-gray-100\">{label}</h4>\n        <p className=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest\">{sub}</p>\n      </div>\n      <div className={`w-10 h-5 rounded-full transition-colors relative ${active ? 'bg-blue-600' : 'bg-slate-200 dark:bg-slate-700'}`}>\n        <div\n          className=\"absolute top-1 size-3 bg-white rounded-full transition-all\"\n          style={active ? { insetInlineEnd: '0.25rem' } : { insetInlineStart: '0.25rem' }}\n        ></div>\n      </div>\n    </button>\n  );\n}\n\nfunction OverrideRow({ row, onDelete, t }) {\n  const conf = Math.round((Number(row.confidence || 0) || 0) * 100);\n  return (\n    <tr className=\"group hover:bg-slate-50/50 dark:hover:bg-slate-800/20 transition-all duration-300\">\n      <td className=\"px-6 py-5\">\n        <p className=\"text-sm font-bold text-slate-800 dark:text-white leading-none\">{row.facility_id}</p>\n      </td>\n      <td className=\"px-6 py-5\">\n        <p className=\"text-xs font-black font-mono text-blue-600\">{row.internal_code}</p>\n      </td>\n      <td className=\"px-6 py-5\">\n        <p className=\"text-xs font-black font-mono text-slate-700 dark:text-slate-200\">{row.sbs_code}</p>\n      </td>\n      <td className=\"px-6 py-5 text-right\">\n        <span className=\"text-xs font-black text-slate-400\">{conf}%</span>\n      </td>\n      <td className=\"px-6 py-5 text-right\">\n        <button\n          type=\"button\"\n          className=\"text-slate-300 hover:text-rose-500 transition-colors\"\n          onClick={onDelete}\n          title={t.overrides.row.delete}\n          aria-label={t.overrides.row.delete}\n        >\n          <span className=\"material-symbols-outlined text-lg\">delete</span>\n        </button>\n      </td>\n    </tr>\n  );\n}\n"],"names":["DEFAULT_CONFIG","MappingRulesConfig","lang","toast","useToast","i18n","config","setConfig","useState","loadingConfig","setLoadingConfig","savingConfig","setSavingConfig","overrides","setOverrides","loadingOverrides","setLoadingOverrides","overrideEditorOpen","setOverrideEditorOpen","overrideDraft","setOverrideDraft","savingOverride","setSavingOverride","sim","setSim","autoPct","reviewPct","autoWindowPct","decisionKey","useMemo","conf","decisionLabel","refreshConfig","data","APIService","e","refreshOverrides","useEffect","handleSaveConfig","payload","result","handleReset","handleAddOverride","internal_code","sbs_code","facility_id","confidence","handleDeleteOverride","row","handleSimulate","prev","mappedCode","mappedDesc","confidenceRatio","mappingSource","jsxs","jsx","SectionHeader","Button","Card","CardHeader","CardBody","ConfigSlider","pct","clamp01","ToggleRule","v","Field","p","o","OverrideRow","n","x","label","children","testId","val","min","max","color","unit","hint","onChange","themes","theme","sub","active","onToggle","copy","onDelete","t"],"mappings":"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"}