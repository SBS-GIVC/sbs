import{r as l,j as e}from"./vendor-react-MVSD7VGK.js";import{i as o,u as w}from"./main-DTZYqsTu.js";import{C as b,a as j,b as N}from"./Card-CNl4AdZD.js";import{S as k}from"./SectionHeader-BFZqpzku.js";import{B as v}from"./Button-BDY0gMZ-.js";import{I as S}from"./Input-OxrVsoY9.js";import"./vendor-BW1Bdpst.js";const A=typeof window<"u"&&typeof window.SBS_API_URL=="string"&&window.SBS_API_URL.trim()?window.SBS_API_URL.replace(/\/+$/,""):"";function R({lang:g="en"}){const c=o[g]||o.en,s=c.pages?.adminAudit||o.en.pages.adminAudit,d=w(),[r,y]=l.useState(()=>{if(typeof window>"u")return"";try{return window.sessionStorage.getItem("sbs_admin_token")||""}catch{return""}}),[x,p]=l.useState(!1),[n,m]=l.useState([]),[u,h]=l.useState(null),f=l.useMemo(()=>{const t={},a=String(r||"").trim();return a&&(t.Authorization=a.startsWith("Bearer ")?a:`Bearer ${a}`),t},[r]),i=l.useCallback(async()=>{p(!0),h(null);try{if(typeof window<"u")try{window.sessionStorage.setItem("sbs_admin_token",r||"")}catch{}const t=await fetch(`${A}/api/admin/audit?limit=200`,{headers:{...f}}),a=await t.json().catch(()=>({}));if(!t.ok||a.success===!1)throw new Error(a.error||a.message||`HTTP ${t.status}`);m(Array.isArray(a.events)?a.events:[])}catch(t){m([]),h(t?.message||"Failed to load audit events"),d.error(t?.message||"Failed to load audit events")}finally{p(!1)}},[f,r,d]);return l.useEffect(()=>{i()},[i]),e.jsx("div",{className:"flex-1",children:e.jsxs("main",{className:"max-w-[1400px] mx-auto p-6 sm:p-8 space-y-8 stagger-children",children:[e.jsx("section",{className:"animate-premium-in",children:e.jsx(k,{title:s.title,subtitle:s.subtitle,badge:s.badge})}),e.jsxs(b,{children:[e.jsx(j,{title:s.tokenLabel,subtitle:null}),e.jsxs(N,{className:"flex flex-col sm:flex-row gap-3 items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx(S,{label:s.tokenLabel,placeholder:s.tokenPlaceholder,value:r,onChange:t=>y(t.target.value)})}),e.jsx(v,{icon:"refresh",loading:x,onClick:i,"data-testid":"auditlog-load",children:s.load})]})]}),e.jsxs(b,{children:[e.jsx(j,{title:s.title,subtitle:u?String(u):null,action:e.jsx("span",{className:"text-[10px] font-black uppercase text-slate-400",children:n.length})}),e.jsx("div",{className:"overflow-x-auto",children:x?e.jsxs("div",{className:"py-24 flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"size-12 rounded-full border-4 border-blue-600/10 border-t-blue-600 animate-spin"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:c.common.loading})]}):n.length===0?e.jsx("div",{className:"py-24 text-center",children:e.jsx("p",{className:"text-slate-500 font-semibold",children:s.empty})}):e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500",children:s.columns.time}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500",children:s.columns.type}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500",children:s.columns.actor}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500",children:s.columns.detail})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:n.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50/50 dark:hover:bg-slate-800/20 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-[11px] font-bold text-slate-600 dark:text-slate-300 whitespace-nowrap",children:t.timestamp}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest bg-blue-600/10 text-blue-600 border border-blue-600/20",children:t.eventType})}),e.jsx("td",{className:"px-6 py-4 text-[11px] font-semibold text-slate-600 dark:text-slate-300",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-mono text-[10px] text-slate-400",children:t.actor?.ip||"—"}),e.jsx("div",{className:"truncate max-w-[240px]",children:t.actor?.user||"—"})]})}),e.jsx("td",{className:"px-6 py-4 text-[11px] font-semibold text-slate-700 dark:text-slate-200",children:e.jsx("pre",{className:"whitespace-pre-wrap text-[10px] font-mono text-slate-500 dark:text-slate-400 max-h-40 overflow-auto",children:JSON.stringify(t.detail||{},null,2)})})]},t.id))})]})})]})]})})}export{R as AdminAuditPage};
//# sourceMappingURL=AdminAuditPage-9vBUp6nd.js.map
