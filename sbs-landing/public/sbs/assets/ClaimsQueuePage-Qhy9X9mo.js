import{r as m,j as e}from"./vendor-react-DS7a0TT8.js";import{u as S}from"./main-CrAJ0RmW.js";import{B as f}from"./Button-TZaBe_4z.js";import{C as k,b as E,a as I}from"./Card-BwXlqzF_.js";import{I as R}from"./Input-BZSbZSMc.js";import{S as A}from"./SectionHeader-Cy0sm8nx.js";import"./vendor-hzXslIYo.js";function U(){const[s,r]=m.useState("all"),[l,x]=m.useState(""),[n,o]=m.useState([]),[c,y]=m.useState(!0),[v,N]=m.useState(null),j=S();m.useEffect(()=>{let t=!1;return(async()=>{y(!0);try{const i=await fetch("/api/claims?limit=50&page=1"),p=await i.json().catch(()=>({}));if(!i.ok||p.success===!1)throw new Error(p.error||`HTTP ${i.status}`);const d=(p.claims||[]).map(a=>({id:a.claimId,patient:a.patientName||a.patientId||"Unknown Patient",facility:a.facilityId||"Main Hub",type:a.claimType?`${String(a.claimType).slice(0,1).toUpperCase()}${String(a.claimType).slice(1)}`:"Institutional",submittedAt:a.createdAt,status:a.status||"processing",priority:a.status==="failed"||Math.random()>.8?"urgent":"normal",amount:Math.floor(Math.random()*5e3)+1e3}));t||(o(d),N(null))}catch(i){t||(o([]),N(i.message||"Failed to resolve claims repository"))}finally{t||y(!1)}})(),()=>{t=!0}},[]);const w=t=>{j.info(`${t} engine is initializing.`)},u={all:n.length,pending:n.filter(t=>t.status==="pending").length,processing:n.filter(t=>["processing","submitted"].includes(t.status)).length,approved:n.filter(t=>["approved","completed"].includes(t.status)).length,rejected:n.filter(t=>["rejected","failed"].includes(t.status)).length},g=n.filter(t=>{const b=s==="all"||(s==="processing"?["processing","submitted"].includes(t.status):s==="approved"?["approved","completed"].includes(t.status):s==="rejected"?["rejected","failed"].includes(t.status):t.status===s),i=l===""||t.id.toLowerCase().includes(l.toLowerCase())||t.patient.toLowerCase().includes(l.toLowerCase());return b&&i}),C=t=>new Intl.NumberFormat("en-SA",{style:"currency",currency:"SAR",minimumFractionDigits:0}).format(t);return e.jsx("div",{className:"flex-1 overflow-y-auto bg-grid scrollbar-hide",children:e.jsxs("main",{className:"max-w-[1400px] mx-auto p-6 sm:p-8 space-y-8 stagger-children",children:[e.jsxs("section",{className:"animate-premium-in",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6",children:[e.jsx(A,{title:"Claims Queue",subtitle:"Manage and triage real-time healthcare integration requests with autonomous validation.",badge:"V3.1 Relay"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{variant:"secondary",icon:"tune",onClick:()=>w("Advanced Settings"),children:"Queue Config"}),e.jsx(f,{icon:"add_card",onClick:()=>window.dispatchEvent(new CustomEvent("sbs:navigate",{detail:{view:"claim-builder"}})),children:"Create Claim"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mt-8",children:[e.jsx(h,{label:"Total Workload",count:u.all,active:s==="all",onClick:()=>r("all"),icon:"inventory_2",color:"blue"}),e.jsx(h,{label:"Pending",count:u.pending,active:s==="pending",onClick:()=>r("pending"),icon:"pending",color:"amber"}),e.jsx(h,{label:"In-Process",count:u.processing,active:s==="processing",onClick:()=>r("processing"),icon:"sync",color:"indigo"}),e.jsx(h,{label:"Relayed",count:u.approved,active:s==="approved",onClick:()=>r("approved"),icon:"verified",color:"emerald"}),e.jsx(h,{label:"Rejected",count:u.rejected,active:s==="rejected",onClick:()=>r("rejected"),icon:"report",color:"rose"})]})]}),e.jsx(k,{className:"animate-premium-in",style:{animationDelay:"100ms"},children:e.jsxs(E,{className:"flex flex-col sm:flex-row gap-4 items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx(R,{icon:"search",placeholder:"Deep search by claim ID, patient, or facility...",value:l,onChange:t=>x(t.target.value)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:"secondary",icon:"filter_list",onClick:()=>j.info("Advanced search panel enabled"),children:"Advanced Search"}),e.jsx(f,{variant:"secondary",icon:"download",onClick:()=>{const t=g.map(a=>[a.id,a.patient,a.facility,a.status,a.amount]),b=[["Claim ID","Patient","Facility","Status","Amount"],...t].map(a=>a.join(",")).join(`
`),i=new Blob([b],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(i),d=document.createElement("a");d.href=p,d.download=`claims-queue-${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(p),j.success("Queue exported")},children:"Export Data"})]})]})}),e.jsxs(k,{className:"animate-premium-in",style:{animationDelay:"200ms"},children:[e.jsx(I,{title:"Operational Payload",subtitle:"Detailed view of active claims in the current relay cycle.",action:e.jsxs("span",{className:"text-[10px] font-black uppercase text-slate-400",children:["Total Visible: ",g.length]})}),e.jsxs("div",{className:"overflow-x-auto",children:[c?e.jsxs("div",{className:"py-24 flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"size-12 rounded-full border-4 border-blue-600/10 border-t-blue-600 animate-spin"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Querying DB..."})]}):v?e.jsx("div",{className:"py-24 text-center",children:e.jsx("p",{className:"text-rose-500 font-bold",children:v})}):e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500",children:"Claim Identifier"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500",children:"Patient Detail"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500",children:"Source Facility"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500 text-right",children:"Value (SAR)"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500",children:"Status"}),e.jsx("th",{className:"px-6 py-4"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:g.map((t,b)=>e.jsx(D,{claim:t,formatCurrency:C},t.id))})]}),!c&&g.length===0&&e.jsxs("div",{className:"py-32 flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"size-20 bg-slate-50 dark:bg-slate-800 rounded-[32px] flex items-center justify-center text-slate-300",children:e.jsx("span",{className:"material-symbols-outlined text-4xl",children:"inbox_customize"})}),e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"No matching results found"})]})]})]})]})})}function h({label:s,count:r,active:l,onClick:x,icon:n,color:o}){const c={blue:"text-blue-600 border-blue-600/30 bg-blue-600/5",amber:"text-amber-600 border-amber-600/30 bg-amber-600/5",indigo:"text-indigo-600 border-indigo-600/30 bg-indigo-600/5",emerald:"text-emerald-600 border-emerald-600/30 bg-emerald-600/5",rose:"text-rose-600 border-rose-600/30 bg-rose-600/5"};return e.jsxs("button",{onClick:x,className:`p-5 rounded-[24px] border-2 text-left transition-all duration-300 group ${l?`${c[o]} shadow-xl shadow-slate-900/5 scale-[1.02]`:"border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900/50 hover:border-slate-200 dark:hover:border-slate-700"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("span",{className:`material-symbols-outlined text-xl transition-transform group-hover:scale-110 ${l?c[o].split(" ")[0]:"text-slate-400"}`,children:n}),e.jsx("span",{className:`text-2xl font-black ${l?c[o].split(" ")[0]:"text-slate-900 dark:text-white"}`,children:r})]}),e.jsx("p",{className:`text-[10px] font-black uppercase tracking-widest ${l?c[o].split(" ")[0]:"text-slate-400"}`,children:s})]})}function D({claim:s,formatCurrency:r}){const l={pending:{label:"Pending Adjudication",color:"text-amber-600 bg-amber-600/10"},processing:{label:"Integrating...",color:"text-blue-600 bg-blue-600/10"},submitted:{label:"Relayed to NPHIES",color:"text-indigo-600 bg-indigo-600/10"},approved:{label:"Adjudicated",color:"text-emerald-600 bg-emerald-600/10"},completed:{label:"Settled",color:"text-emerald-600 bg-emerald-600/10"},rejected:{label:"Error Detected",color:"text-rose-600 bg-rose-600/10 text-[9px]"},failed:{label:"Relay Failed",color:"text-rose-600 bg-rose-600/10"}},x=l[s.status]||l.processing;return e.jsxs("tr",{className:"group hover:bg-slate-50/50 dark:hover:bg-slate-800/20 transition-all duration-300",children:[e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`size-2 rounded-full ${s.priority==="urgent"?"bg-rose-500 animate-pulse":"bg-slate-200 dark:bg-slate-700"}`}),e.jsx("span",{className:"font-mono text-sm font-black text-blue-600 bg-blue-600/5 px-2 py-0.5 rounded tracking-tight",children:s.id})]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-slate-800 dark:text-gray-100",children:s.patient}),e.jsxs("span",{className:"text-[10px] font-black uppercase text-slate-400 tracking-widest",children:[s.type," Case"]})]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsx("span",{className:"text-xs font-bold text-slate-500",children:s.facility})}),e.jsx("td",{className:"px-6 py-5 text-right",children:e.jsx("span",{className:"text-sm font-black text-slate-900 dark:text-white tracking-tight",children:r(s.amount)})}),e.jsx("td",{className:"px-6 py-5",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest border border-current opacity-90 ${x.color}`,children:x.label})}),e.jsx("td",{className:"px-6 py-5 text-right",children:e.jsx("button",{className:"size-9 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-300 hover:text-blue-600 transition-all",onClick:()=>window.dispatchEvent(new CustomEvent("sbs:navigate",{detail:{view:s.status==="failed"?"error":"review"}})),children:e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"chevron_right"})})})]})}export{U as ClaimsQueuePage};
//# sourceMappingURL=ClaimsQueuePage-Qhy9X9mo.js.map
