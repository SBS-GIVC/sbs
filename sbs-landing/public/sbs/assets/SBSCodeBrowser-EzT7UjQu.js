import{r as a,j as e}from"./vendor-react-MVSD7VGK.js";import{aiAssistant as b}from"./aiAssistantService-BWORHkI6.js";import{i as w,u as O}from"./main-DTZYqsTu.js";import{C as Q,b as J}from"./Card-CNl4AdZD.js";import{S as K}from"./SectionHeader-BFZqpzku.js";import{B as A}from"./Button-BDY0gMZ-.js";import"./vendor-BW1Bdpst.js";function X({lang:c="en",isRTL:n=!1}){const t=(w[c]||w.en).pages?.codeBrowser||w.en.pages.codeBrowser,[i,g]=a.useState(""),[l,B]=a.useState("all"),[o,j]=a.useState(null),[T,N]=a.useState(!1),[h,k]=a.useState(!0),[v,C]=a.useState(null),[f,S]=a.useState(100),D=a.useRef(null),d=O(),[x,_]=a.useState([]),[L,E]=a.useState(["all"]),[p,u]=a.useState({results:[],source:"local"});a.useEffect(()=>{let s=!1;return(async()=>{k(!0);try{if(await b.ensureCatalogLoaded(),s)return;const r=b.getAllCodes();_(r),E(["all",...b.getCategories()]),u({results:r,source:"local"})}catch(r){if(s)return;console.warn("SBS catalog failed to load, continuing with empty state:",r),_([]),E(["all"]),u({results:[],source:"unavailable"}),d.warning(t.toast.catalogUnavailable)}finally{s||k(!1)}})(),()=>{s=!0}},[]),a.useEffect(()=>{if(h)return;const s=setTimeout(async()=>{if(i.length>=2){N(!0);try{const r=await b.smartSearch(i,{limit:200,category:l==="all"?null:l,includeAI:!0});u(r),C(r.aiInsights)}finally{N(!1)}}else{const r=l==="all"?x:x.filter(y=>y.category===l);u({results:r,source:"local"}),C(null)}},300);return()=>clearTimeout(s)},[i,l,x,h]),a.useEffect(()=>{S(100)},[i,l]);const $=a.useMemo(()=>p.results.slice(0,f),[p,f]),R=s=>{const{scrollTop:r,scrollHeight:y,clientHeight:z}=s.target;y-r-z<400&&f<p.results.length&&S(H=>H+100)},I=s=>{navigator.clipboard.writeText(s).then(()=>d.success(t.toast.codeCopied.replace("{code}",s))).catch(()=>d.error(t.toast.clipboardDenied))};return e.jsxs("div",{className:"flex-1 overflow-hidden bg-grid flex",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("header",{className:"px-8 py-10 sm:px-12 space-y-8 animate-premium-in",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6",children:[e.jsx(K,{title:t.header.title,subtitle:t.header.subtitleTemplate.replace("{count}",x.length.toLocaleString(c==="ar"?"ar-SA":void 0)),badge:t.header.badge}),e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-900/50 p-1.5 rounded-2xl border border-slate-200 dark:border-slate-800",children:[e.jsx("button",{type:"button",className:"px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest bg-white dark:bg-slate-800 shadow-sm",children:t.view.grid}),e.jsx("button",{type:"button",className:"px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-400",children:t.view.condensed})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative group",children:[e.jsx("span",{className:`absolute ${n?"right-5":"left-5"} top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-400 group-focus-within:text-blue-600 transition-colors`,children:"search"}),e.jsx("input",{type:"text",placeholder:t.search.placeholder,"aria-label":t.search.label,className:`w-full h-16 bg-white dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 rounded-[28px] ${n?"pr-14 pl-20 text-right":"pl-14 pr-20 text-left"} text-sm font-bold focus:outline-none focus:border-blue-600/30 focus:ring-4 focus:ring-blue-600/5 transition-all shadow-sm`,"data-testid":"codebrowser-search",value:i,onChange:s=>g(s.target.value)}),T&&e.jsx("div",{className:`absolute ${n?"left-6":"right-6"} top-1/2 -translate-y-1/2 size-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin`})]}),e.jsx("select",{className:"h-16 px-6 bg-white dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 rounded-[28px] text-xs font-black uppercase tracking-widest focus:outline-none","data-testid":"codebrowser-category",value:l,onChange:s=>B(s.target.value),"aria-label":t.category.label,children:L.map(s=>e.jsx("option",{value:s,children:s.replace(/_/g," ")},s))})]}),v&&e.jsxs("div",{className:"p-4 rounded-2xl bg-blue-600/5 border border-blue-600/10 flex items-center gap-3 animate-premium-in",children:[e.jsx("span",{className:"material-symbols-outlined text-blue-600",children:"auto_awesome"}),e.jsx("p",{className:"text-xs font-bold text-slate-600 dark:text-gray-300 italic",children:v})]}),h&&e.jsxs("div",{className:"p-4 rounded-2xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800 flex items-center gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-blue-600 animate-spin",children:"progress_activity"}),e.jsx("p",{className:"text-xs font-bold text-slate-500",children:t.loading.catalog})]})]}),e.jsxs("div",{ref:D,onScroll:R,"data-testid":"codebrowser-results",className:"flex-1 overflow-y-auto px-8 sm:px-12 pb-12 scrollbar-hide",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 stagger-children",children:$.map((s,r)=>e.jsx(M,{code:s,selected:o?.code===s.code,onClick:()=>j(s),onCopy:()=>I(s.code),copyAriaTemplate:t.cell.copyAriaTemplate,fallbackCategory:t.cell.fallbackCategory},s.code+r))}),p.results.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-32 space-y-6 opacity-40",children:[e.jsx("span",{className:"material-symbols-outlined text-[80px] font-black",children:"search_off"}),e.jsx("p",{className:"font-black uppercase tracking-widest text-sm",children:t.empty})]})]})]}),o&&e.jsx("aside",{"data-testid":"codebrowser-detail",className:"w-[450px] bg-white dark:bg-slate-950 border-l border-slate-100 dark:border-slate-800 overflow-y-auto animate-premium-in shadow-2xl z-20",children:e.jsxs("div",{className:"p-10 space-y-10",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-blue-600",children:t.detail.kicker}),e.jsx("h2",{className:"text-3xl font-black text-slate-900 dark:text-white tracking-tighter",children:o.code})]}),e.jsx("button",{type:"button",onClick:()=>j(null),"aria-label":t.detail.close,className:"p-2 rounded-xl bg-slate-50 dark:bg-slate-900 text-slate-400 hover:text-rose-500 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:t.detail.technical}),e.jsx("p",{className:"text-sm font-bold leading-relaxed text-slate-800 dark:text-gray-100",children:o.desc})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:t.detail.domain}),e.jsx("div",{className:"inline-flex px-4 py-1.5 rounded-xl bg-blue-600 text-white text-[10px] font-black uppercase tracking-widest shadow-lg shadow-blue-600/20",children:o.category||t.detail.fallbackCategory})]})]}),e.jsxs("div",{className:"p-8 rounded-[40px] bg-slate-50 dark:bg-slate-900 border border-slate-100 dark:border-slate-800 space-y-6",children:[e.jsxs("h4",{className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-blue-600 text-lg",children:"psychology"}),t.detail.neuralCrossRef]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs font-bold text-slate-400",children:[e.jsx("span",{children:t.detail.approvalConfidence}),e.jsx("span",{className:"text-blue-600",children:"98.2%"})]}),e.jsx("div",{className:"h-1.5 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 w-[98%]"})})]}),e.jsxs("p",{className:"text-[11px] font-bold text-slate-500 leading-relaxed italic",children:[t.detail.deepSeekLead," ",e.jsx("span",{className:"text-blue-600 font-black",children:t.detail.deepSeekCode})," ",t.detail.deepSeekTail]})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(A,{className:"w-full py-6 text-sm shadow-xl shadow-blue-600/20",icon:"add_box","data-testid":"codebrowser-enroll",onClick:()=>{const s={code:o.code,description:o.desc,category:o.category||null,fee:Number(o.fee||0),source:"code-browser",stagedAt:new Date().toISOString()};try{window.sessionStorage.setItem("sbs_claim_context_code",JSON.stringify(s))}catch{}try{window.dispatchEvent(new CustomEvent("sbs:claim-context",{detail:s}))}catch{}d.success(t.toast.staged),window.dispatchEvent(new CustomEvent("sbs:navigate",{detail:{view:"claim-builder"}}))},children:t.actions.enroll}),e.jsx(A,{variant:"secondary",className:"w-full py-6 text-sm",icon:"content_copy","data-testid":"codebrowser-copy",onClick:()=>I(o.code),children:t.actions.copyId})]})]})})]})}function M({code:c,selected:n,onClick:m,onCopy:t,copyAriaTemplate:i,fallbackCategory:g}){return e.jsx(Q,{onClick:m,"data-testid":`codebrowser-cell-${c.code}`,className:`group cursor-pointer transition-all hover:scale-[1.02] border-2 ${n?"border-blue-600 shadow-2xl shadow-blue-600/10":"border-transparent"}`,role:"button",tabIndex:0,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),m?.())},children:e.jsxs(J,{className:"p-8 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-black tracking-tight text-blue-600 font-mono",children:c.code}),e.jsx("button",{type:"button",onClick:l=>{l.stopPropagation(),t()},"aria-label":String(i||"").replace("{code}",c.code),className:"size-8 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-400 opacity-0 group-hover:opacity-100 hover:text-blue-600 transition-all",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"content_copy"})})]}),e.jsx("p",{className:"text-sm font-bold text-slate-800 dark:text-gray-100 line-clamp-2 leading-snug group-hover:text-blue-600 transition-colors",children:c.desc}),e.jsxs("div",{className:"pt-2 border-t border-slate-100 dark:border-slate-800 flex justify-between items-center",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-400",children:c.category?.replace(/_/g," ")||g}),c.source==="ai"&&e.jsx("span",{className:"material-symbols-outlined text-amber-500 text-lg",children:"auto_awesome"})]})]})})}export{X as SBSCodeBrowser};
//# sourceMappingURL=SBSCodeBrowser-EzT7UjQu.js.map
